ggtitle('Inferred two-epoch demographic model from Dadi simulated SFS')
plot_B = ggplot(dadi_simulation_two_epoch_demography_50, aes(dadi_simulation_two_epoch_Time_50, dadi_simulation_two_epoch_NEffective_50, color='N=50')) + geom_step(linewidth=1, linetype='dashed') +
geom_step(data=dadi_simulation_two_epoch_demography_100, aes(dadi_simulation_two_epoch_Time_100, dadi_simulation_two_epoch_NEffective_100, color='N=100'), linewidth=1, linetype='dashed') +
geom_step(data=dadi_simulation_two_epoch_demography_150, aes(dadi_simulation_two_epoch_Time_150, dadi_simulation_two_epoch_NEffective_150, color='N=150'), linewidth=1, linetype='dashed') +
geom_step(data=dadi_simulation_two_epoch_demography_200, aes(dadi_simulation_two_epoch_Time_200, dadi_simulation_two_epoch_NEffective_200, color='N=200'), linewidth=1, linetype='dashed') +
geom_step(data=ThreeEpochB_true_demography_params, aes(ThreeEpochB_true_Time_params, ThreeEpochB_true_NEffective_params, color='True'), linewidth=1, linetype='solid') +
scale_color_manual(name='Sample Size',
breaks=c('N=50', 'N=100', 'N=150', 'N=200', 'True'),
values=c('N=50'='#bfd3e6',
'N=100'='#8c96c6',
'N=150'='#88419d',
'N=200'='#4d004b',
'True'='#b30000')) +
theme_bw() +
ylab('Effective population size') +
xlab('Approximate time in years relative to current time') +
ggtitle('Inferred two-epoch demographic model from Dadi simulated SFS')
plot_A + plot_B + plot_layout(nrow=2)
dadi_simulation_two_epoch_NAnc = dadi_simulation_two_epoch_theta / (4 * 100000000 * 1.5E-8)
dadi_simulation_two_epoch_NCurr = dadi_simulation_two_epoch_nu * dadi_simulation_two_epoch_NAnc
dadi_simulation_two_epoch_Time = 2 * dadi_simulation_two_epoch_NAnc * dadi_simulation_two_epoch_tau * 25
two_epoch_max_time = max(dadi_simulation_two_epoch_Time)
dadi_simulation_two_epoch_max_time = rep(two_epoch_max_time * 1.1, 4)
dadi_simulation_two_epoch_current_time = rep(0, 4)
dadi_simulation_two_epoch_demography = data.frame(dadi_simulation_two_epoch_NAnc, dadi_simulation_two_epoch_max_time,
dadi_simulation_two_epoch_NCurr, dadi_simulation_two_epoch_Time,
dadi_simulation_two_epoch_NCurr, dadi_simulation_two_epoch_current_time)
dadi_simulation_two_epoch_NEffective_50 = c(dadi_simulation_two_epoch_demography[1, 1], dadi_simulation_two_epoch_demography[1, 3], dadi_simulation_two_epoch_demography[1, 5])
dadi_simulation_two_epoch_Time_50 = c(-dadi_simulation_two_epoch_demography[1, 2], -dadi_simulation_two_epoch_demography[1, 4], dadi_simulation_two_epoch_demography[1, 6])
dadi_simulation_two_epoch_demography_50 = data.frame(dadi_simulation_two_epoch_Time_50, dadi_simulation_two_epoch_NEffective_50)
dadi_simulation_two_epoch_NEffective_100 = c(dadi_simulation_two_epoch_demography[2, 1], dadi_simulation_two_epoch_demography[2, 3], dadi_simulation_two_epoch_demography[2, 5])
dadi_simulation_two_epoch_Time_100 = c(-dadi_simulation_two_epoch_demography[2, 2], -dadi_simulation_two_epoch_demography[2, 4], dadi_simulation_two_epoch_demography[2, 6])
dadi_simulation_two_epoch_demography_100 = data.frame(dadi_simulation_two_epoch_Time_100, dadi_simulation_two_epoch_NEffective_100)
dadi_simulation_two_epoch_NEffective_150 = c(dadi_simulation_two_epoch_demography[3, 1], dadi_simulation_two_epoch_demography[3, 3], dadi_simulation_two_epoch_demography[3, 5])
dadi_simulation_two_epoch_Time_150 = c(-dadi_simulation_two_epoch_demography[3, 2], -dadi_simulation_two_epoch_demography[3, 4], dadi_simulation_two_epoch_demography[3, 6])
dadi_simulation_two_epoch_demography_150 = data.frame(dadi_simulation_two_epoch_Time_150, dadi_simulation_two_epoch_NEffective_150)
dadi_simulation_two_epoch_NEffective_200 = c(dadi_simulation_two_epoch_demography[4, 1], dadi_simulation_two_epoch_demography[4, 3], dadi_simulation_two_epoch_demography[4, 5])
dadi_simulation_two_epoch_Time_200 = c(-dadi_simulation_two_epoch_demography[4, 2], -dadi_simulation_two_epoch_demography[4, 4], dadi_simulation_two_epoch_demography[4, 6])
dadi_simulation_two_epoch_demography_200 = data.frame(dadi_simulation_two_epoch_Time_200, dadi_simulation_two_epoch_NEffective_200)
ThreeEpochB_true_NAnc = 10000
ThreeEpochB_true_NBottle = 1000
ThreeEpochB_true_NCurr = 50000
ThreeEpochB_true_TimeBottleEnd = 200
ThreeEpochB_true_TimeBottleStart = 1800
ThreeEpochB_true_TimeTotal = 2000
ThreeEpochB_true_TimeCurrent = 0
ThreeEpochB_true_demography = data.frame(ThreeEpochB_true_NAnc, two_epoch_max_time * 1.1,
ThreeEpochB_true_NBottle, ThreeEpochB_true_TimeBottleStart,
ThreeEpochB_true_NCurr, ThreeEpochB_true_TimeBottleEnd,
ThreeEpochB_true_NCurr, ThreeEpochB_true_TimeCurrent)
ThreeEpochB_true_NEffective_params = c(ThreeEpochB_true_demography[1, 1], ThreeEpochB_true_demography[1, 3], ThreeEpochB_true_demography[1, 5], ThreeEpochB_true_demography[1, 7])
ThreeEpochB_true_Time_params = c(-ThreeEpochB_true_demography[1, 2], -ThreeEpochB_true_demography[1, 4], -ThreeEpochB_true_demography[1, 6], -ThreeEpochB_true_demography[1, 8])
ThreeEpochB_true_demography_params = data.frame(ThreeEpochB_true_Time_params, ThreeEpochB_true_NEffective_params)
plot_A = compare_50_100_150_200_sfs_cutoff(dadi_sfs_50, dadi_sfs_100, dadi_sfs_150, dadi_sfs_200) +
ggtitle('Proportional Dadi-simulated SFS by sample size')
plot_B = ggplot(dadi_simulation_two_epoch_demography_50, aes(dadi_simulation_two_epoch_Time_50, dadi_simulation_two_epoch_NEffective_50, color='N=50')) + geom_step(linewidth=1, linetype='dashed') +
geom_step(data=dadi_simulation_two_epoch_demography_100, aes(dadi_simulation_two_epoch_Time_100, dadi_simulation_two_epoch_NEffective_100, color='N=100'), linewidth=1, linetype='dashed') +
geom_step(data=dadi_simulation_two_epoch_demography_150, aes(dadi_simulation_two_epoch_Time_150, dadi_simulation_two_epoch_NEffective_150, color='N=150'), linewidth=1, linetype='dashed') +
geom_step(data=dadi_simulation_two_epoch_demography_200, aes(dadi_simulation_two_epoch_Time_200, dadi_simulation_two_epoch_NEffective_200, color='N=200'), linewidth=1, linetype='dashed') +
geom_step(data=ThreeEpochB_true_demography_params, aes(ThreeEpochB_true_Time_params, ThreeEpochB_true_NEffective_params, color='True'), linewidth=1, linetype='solid') +
scale_color_manual(name='Sample Size',
breaks=c('N=50', 'N=100', 'N=150', 'N=200', 'True'),
values=c('N=50'='#bfd3e6',
'N=100'='#8c96c6',
'N=150'='#88419d',
'N=200'='#4d004b',
'True'='#b30000')) +
theme_bw() +
ylab('Effective population size') +
xlab('Approximate time in years relative to current time') +
ggtitle('Inferred two-epoch demographic model from Dadi simulated SFS')
plot_A + plot_B + plot_layout(nrow=2)
dadi_simulation_two_epoch_Time = 2 * dadi_simulation_two_epoch_NAnc * dadi_simulation_two_epoch_tau
two_epoch_max_time = max(dadi_simulation_two_epoch_Time)
dadi_simulation_two_epoch_max_time = rep(two_epoch_max_time * 1.1, 4)
dadi_simulation_two_epoch_current_time = rep(0, 4)
dadi_simulation_two_epoch_demography = data.frame(dadi_simulation_two_epoch_NAnc, dadi_simulation_two_epoch_max_time,
dadi_simulation_two_epoch_NCurr, dadi_simulation_two_epoch_Time,
dadi_simulation_two_epoch_NCurr, dadi_simulation_two_epoch_current_time)
dadi_simulation_two_epoch_NEffective_50 = c(dadi_simulation_two_epoch_demography[1, 1], dadi_simulation_two_epoch_demography[1, 3], dadi_simulation_two_epoch_demography[1, 5])
dadi_simulation_two_epoch_Time_50 = c(-dadi_simulation_two_epoch_demography[1, 2], -dadi_simulation_two_epoch_demography[1, 4], dadi_simulation_two_epoch_demography[1, 6])
dadi_simulation_two_epoch_demography_50 = data.frame(dadi_simulation_two_epoch_Time_50, dadi_simulation_two_epoch_NEffective_50)
dadi_simulation_two_epoch_NEffective_100 = c(dadi_simulation_two_epoch_demography[2, 1], dadi_simulation_two_epoch_demography[2, 3], dadi_simulation_two_epoch_demography[2, 5])
dadi_simulation_two_epoch_Time_100 = c(-dadi_simulation_two_epoch_demography[2, 2], -dadi_simulation_two_epoch_demography[2, 4], dadi_simulation_two_epoch_demography[2, 6])
dadi_simulation_two_epoch_demography_100 = data.frame(dadi_simulation_two_epoch_Time_100, dadi_simulation_two_epoch_NEffective_100)
dadi_simulation_two_epoch_NEffective_150 = c(dadi_simulation_two_epoch_demography[3, 1], dadi_simulation_two_epoch_demography[3, 3], dadi_simulation_two_epoch_demography[3, 5])
dadi_simulation_two_epoch_Time_150 = c(-dadi_simulation_two_epoch_demography[3, 2], -dadi_simulation_two_epoch_demography[3, 4], dadi_simulation_two_epoch_demography[3, 6])
dadi_simulation_two_epoch_demography_150 = data.frame(dadi_simulation_two_epoch_Time_150, dadi_simulation_two_epoch_NEffective_150)
dadi_simulation_two_epoch_NEffective_200 = c(dadi_simulation_two_epoch_demography[4, 1], dadi_simulation_two_epoch_demography[4, 3], dadi_simulation_two_epoch_demography[4, 5])
dadi_simulation_two_epoch_Time_200 = c(-dadi_simulation_two_epoch_demography[4, 2], -dadi_simulation_two_epoch_demography[4, 4], dadi_simulation_two_epoch_demography[4, 6])
dadi_simulation_two_epoch_demography_200 = data.frame(dadi_simulation_two_epoch_Time_200, dadi_simulation_two_epoch_NEffective_200)
ThreeEpochB_true_NAnc = 10000
ThreeEpochB_true_NBottle = 1000
ThreeEpochB_true_NCurr = 50000
ThreeEpochB_true_TimeBottleEnd = 200
ThreeEpochB_true_TimeBottleStart = 1800
ThreeEpochB_true_TimeTotal = 2000
ThreeEpochB_true_TimeCurrent = 0
ThreeEpochB_true_demography = data.frame(ThreeEpochB_true_NAnc, two_epoch_max_time * 1.1,
ThreeEpochB_true_NBottle, ThreeEpochB_true_TimeBottleStart,
ThreeEpochB_true_NCurr, ThreeEpochB_true_TimeBottleEnd,
ThreeEpochB_true_NCurr, ThreeEpochB_true_TimeCurrent)
ThreeEpochB_true_NEffective_params = c(ThreeEpochB_true_demography[1, 1], ThreeEpochB_true_demography[1, 3], ThreeEpochB_true_demography[1, 5], ThreeEpochB_true_demography[1, 7])
ThreeEpochB_true_Time_params = c(-ThreeEpochB_true_demography[1, 2], -ThreeEpochB_true_demography[1, 4], -ThreeEpochB_true_demography[1, 6], -ThreeEpochB_true_demography[1, 8])
ThreeEpochB_true_demography_params = data.frame(ThreeEpochB_true_Time_params, ThreeEpochB_true_NEffective_params)
plot_A = compare_50_100_150_200_sfs_cutoff(dadi_sfs_50, dadi_sfs_100, dadi_sfs_150, dadi_sfs_200) +
ggtitle('Proportional Dadi-simulated SFS by sample size')
plot_B = ggplot(dadi_simulation_two_epoch_demography_50, aes(dadi_simulation_two_epoch_Time_50, dadi_simulation_two_epoch_NEffective_50, color='N=50')) + geom_step(linewidth=1, linetype='dashed') +
geom_step(data=dadi_simulation_two_epoch_demography_100, aes(dadi_simulation_two_epoch_Time_100, dadi_simulation_two_epoch_NEffective_100, color='N=100'), linewidth=1, linetype='dashed') +
geom_step(data=dadi_simulation_two_epoch_demography_150, aes(dadi_simulation_two_epoch_Time_150, dadi_simulation_two_epoch_NEffective_150, color='N=150'), linewidth=1, linetype='dashed') +
geom_step(data=dadi_simulation_two_epoch_demography_200, aes(dadi_simulation_two_epoch_Time_200, dadi_simulation_two_epoch_NEffective_200, color='N=200'), linewidth=1, linetype='dashed') +
geom_step(data=ThreeEpochB_true_demography_params, aes(ThreeEpochB_true_Time_params, ThreeEpochB_true_NEffective_params, color='True'), linewidth=1, linetype='solid') +
scale_color_manual(name='Sample Size',
breaks=c('N=50', 'N=100', 'N=150', 'N=200', 'True'),
values=c('N=50'='#bfd3e6',
'N=100'='#8c96c6',
'N=150'='#88419d',
'N=200'='#4d004b',
'True'='#b30000')) +
theme_bw() +
ylab('Effective population size') +
xlab('Approximate time in years relative to current time') +
ggtitle('Inferred two-epoch demographic model from Dadi simulated SFS')
plot_A + plot_B + plot_layout(nrow=2)
# * 4 sample sizes ranging from small to large (ancient to recent)
# * 4 sample sizes ranging from small to large (ancient to recent)
# * Just Dadi shown in main text, MSPrime for supplement
# * 4 sample sizes ranging from small to large (ancient to recent)
# * Just Dadi shown in main text, MSPrime for supplement
# * SFS on left-hand, demography plot on right hand [two-epoch fit, for now, best-fit later or in supplement]
# * 4 sample sizes ranging from small to large (ancient to recent)
# * Just Dadi shown in main text, MSPrime for supplement
# * SFS on left-hand, demography plot on right hand [two-epoch fit, for now, best-fit later or in supplement]
# * Show true underlying simulated demography
# * 4 sample sizes ranging from small to large (ancient to recent)
# * Just Dadi shown in main text, MSPrime for supplement
# * SFS on left-hand, demography plot on right hand [two-epoch fit, for now, best-fit later or in supplement]
# * Show true underlying simulated demography
# * 4 sample sizes ranging from small to large (ancient to recent)
# * Just Dadi shown in main text, MSPrime for supplement
# * SFS on left-hand, demography plot on right hand [two-epoch fit, for now, best-fit later or in supplement]
# * Show true underlying simulated demography
# * 4 sample sizes ranging from small to large (ancient to recent)
# * Just Dadi shown in main text, MSPrime for supplement
# * SFS on left-hand, demography plot on right hand [two-epoch fit, for now, best-fit later or in supplement]
# * Show true underlying simulated demography
# * 4 sample sizes ranging from small to large (ancient to recent)
# * Just Dadi shown in main text, MSPrime for supplement
# * SFS on left-hand, demography plot on right hand [two-epoch fit, for now, best-fit later or in supplement]
# * Show true underlying simulated demography
# * 4 sample sizes ranging from small to large (ancient to recent)
# * Just Dadi shown in main text, MSPrime for supplement
# * SFS on left-hand, demography plot on right hand [two-epoch fit, for now, best-fit later or in supplement]
# * Show true underlying simulated demography
# * 4 sample sizes ranging from small to large (ancient to recent)
# * Just Dadi shown in main text, MSPrime for supplement
# * SFS on left-hand, demography plot on right hand [two-epoch fit, for now, best-fit later or in supplement]
# * Show true underlying simulated demography
# figure_5.R
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
source('useful_functions.R')
dadi_sfs_80 = read_input_sfs('../Simulations/dadi_simulations/ThreeEpochBottleneck_80.sfs')
dadi_sfs_100 = read_input_sfs('../Simulations/dadi_simulations/ThreeEpochBottleneck_100.sfs')
dadi_sfs_120 = read_input_sfs('../Simulations/dadi_simulations/ThreeEpochBottleneck_120.sfs')
dadi_sfs_140 = read_input_sfs('../Simulations/dadi_simulations/ThreeEpochBottleneck_140.sfs')
dadi_nu_80 = nu_from_demography('../Analysis/dadi_3EpB_80/two_epoch_demography.txt')
dadi_nu_100 = nu_from_demography('../Analysis/dadi_3EpB_100/two_epoch_demography.txt')
dadi_nu_120 = nu_from_demography('../Analysis/dadi_3EpB_120/two_epoch_demography.txt')
dadi_nu_140 = nu_from_demography('../Analysis/dadi_3EpB_140/two_epoch_demography.txt')
dadi_tau_80 = tau_from_demography('../Analysis/dadi_3EpB_80/two_epoch_demography.txt')
dadi_tau_100 = tau_from_demography('../Analysis/dadi_3EpB_100/two_epoch_demography.txt')
dadi_tau_120 = tau_from_demography('../Analysis/dadi_3EpB_120/two_epoch_demography.txt')
dadi_tau_140 = tau_from_demography('../Analysis/dadi_3EpB_140/two_epoch_demography.txt')
dadi_theta_80 = theta_from_demography('../Analysis/dadi_3EpB_80/two_epoch_demography.txt')
dadi_theta_100 = theta_from_demography('../Analysis/dadi_3EpB_100/two_epoch_demography.txt')
dadi_theta_120 = theta_from_demography('../Analysis/dadi_3EpB_120/two_epoch_demography.txt')
dadi_theta_140 = theta_from_demography('../Analysis/dadi_3EpB_140/two_epoch_demography.txt')
dadi_simulation_two_epoch_theta = c(dadi_theta_80, dadi_theta_100, dadi_theta_120, dadi_theta_140)
dadi_simulation_two_epoch_nu = c(dadi_nu_80, dadi_nu_100, dadi_nu_120, dadi_nu_140)
dadi_simulation_two_epoch_tau = c(dadi_nu_80, dadi_nu_100, dadi_nu_120, dadi_nu_140)
dadi_simulation_two_epoch_NAnc = dadi_simulation_two_epoch_theta / (4 * 100000000 * 1.5E-8)
dadi_simulation_two_epoch_NCurr = dadi_simulation_two_epoch_nu * dadi_simulation_two_epoch_NAnc
dadi_simulation_two_epoch_Time = 2 * dadi_simulation_two_epoch_NAnc * dadi_simulation_two_epoch_tau
dadi_simulation_two_epoch_Time = 2 * dadi_simulation_two_epoch_tau * dadi_simulation_two_epoch_theta / (4 * 1.5E-8 * 100000000)
# ThreeEpochB_two_epoch_Time = 2 * ThreeEpochB_two_epoch_tau * ThreeEpochB_two_epoch_theta / (4 * ThreeEpochB_mu * ThreeEpochB_two_epoch_allele_sum)
two_epoch_max_time = max(dadi_simulation_two_epoch_Time)
dadi_simulation_two_epoch_max_time = rep(two_epoch_max_time * 1.1, 4)
dadi_simulation_two_epoch_current_time = rep(0, 4)
dadi_simulation_two_epoch_demography = data.frame(dadi_simulation_two_epoch_NAnc, dadi_simulation_two_epoch_max_time,
dadi_simulation_two_epoch_NCurr, dadi_simulation_two_epoch_Time,
dadi_simulation_two_epoch_NCurr, dadi_simulation_two_epoch_current_time)
dadi_simulation_two_epoch_NEffective_80 = c(dadi_simulation_two_epoch_demography[1, 1], dadi_simulation_two_epoch_demography[1, 3], dadi_simulation_two_epoch_demography[1, 5])
dadi_simulation_two_epoch_Time_80 = c(-dadi_simulation_two_epoch_demography[1, 2], -dadi_simulation_two_epoch_demography[1, 4], dadi_simulation_two_epoch_demography[1, 6])
dadi_simulation_two_epoch_demography_80 = data.frame(dadi_simulation_two_epoch_Time_80, dadi_simulation_two_epoch_NEffective_80)
dadi_simulation_two_epoch_NEffective_100 = c(dadi_simulation_two_epoch_demography[2, 1], dadi_simulation_two_epoch_demography[2, 3], dadi_simulation_two_epoch_demography[2, 5])
dadi_simulation_two_epoch_Time_100 = c(-dadi_simulation_two_epoch_demography[2, 2], -dadi_simulation_two_epoch_demography[2, 4], dadi_simulation_two_epoch_demography[2, 6])
dadi_simulation_two_epoch_demography_100 = data.frame(dadi_simulation_two_epoch_Time_100, dadi_simulation_two_epoch_NEffective_100)
dadi_simulation_two_epoch_NEffective_120 = c(dadi_simulation_two_epoch_demography[3, 1], dadi_simulation_two_epoch_demography[3, 3], dadi_simulation_two_epoch_demography[3, 5])
dadi_simulation_two_epoch_Time_120 = c(-dadi_simulation_two_epoch_demography[3, 2], -dadi_simulation_two_epoch_demography[3, 4], dadi_simulation_two_epoch_demography[3, 6])
dadi_simulation_two_epoch_demography_120 = data.frame(dadi_simulation_two_epoch_Time_120, dadi_simulation_two_epoch_NEffective_120)
dadi_simulation_two_epoch_NEffective_140 = c(dadi_simulation_two_epoch_demography[4, 1], dadi_simulation_two_epoch_demography[4, 3], dadi_simulation_two_epoch_demography[4, 5])
dadi_simulation_two_epoch_Time_140 = c(-dadi_simulation_two_epoch_demography[4, 2], -dadi_simulation_two_epoch_demography[4, 4], dadi_simulation_two_epoch_demography[4, 6])
dadi_simulation_two_epoch_demography_140 = data.frame(dadi_simulation_two_epoch_Time_140, dadi_simulation_two_epoch_NEffective_140)
ThreeEpochB_true_NAnc = 10000
ThreeEpochB_true_NBottle = 1000
ThreeEpochB_true_NCurr = 50000
ThreeEpochB_true_TimeBottleEnd = 200
ThreeEpochB_true_TimeBottleStart = 1800
# ThreeEpochB_three_epoch_TimeBottleEnd = 2 * ThreeEpochB_three_epoch_tauF * ThreeEpochB_three_epoch_theta / (4 * ThreeEpochB_mu * ThreeEpochB_three_epoch_allele_sum)
# ThreeEpochB_three_epoch_TimeBottleStart = 2 * ThreeEpochB_three_epoch_tauB * ThreeEpochB_three_epoch_theta / (4 * ThreeEpochB_mu * ThreeEpochB_three_epoch_allele_sum) + ThreeEpochB_three_epoch_TimeBottleEnd
ThreeEpochB_true_TimeTotal = 2000
ThreeEpochB_true_TimeCurrent = 0
ThreeEpochB_true_demography = data.frame(ThreeEpochB_true_NAnc, two_epoch_max_time * 1.1,
ThreeEpochB_true_NBottle, ThreeEpochB_true_TimeBottleStart,
ThreeEpochB_true_NCurr, ThreeEpochB_true_TimeBottleEnd,
ThreeEpochB_true_NCurr, ThreeEpochB_true_TimeCurrent)
ThreeEpochB_true_NEffective_params = c(ThreeEpochB_true_demography[1, 1], ThreeEpochB_true_demography[1, 3], ThreeEpochB_true_demography[1, 5], ThreeEpochB_true_demography[1, 7])
ThreeEpochB_true_Time_params = c(-ThreeEpochB_true_demography[1, 2], -ThreeEpochB_true_demography[1, 4], -ThreeEpochB_true_demography[1, 6], -ThreeEpochB_true_demography[1, 8])
ThreeEpochB_true_demography_params = data.frame(ThreeEpochB_true_Time_params, ThreeEpochB_true_NEffective_params)
plot_A = compare_80_100_120_140_sfs_cutoff(dadi_sfs_80, dadi_sfs_100, dadi_sfs_120, dadi_sfs_140) +
ggtitle('Proportional Dadi-simulated SFS by sample size')
plot_A = compare_4_sample_size_sfs_cutoff(dadi_sfs_80, dadi_sfs_100, dadi_sfs_120, dadi_sfs_140) +
ggtitle('Proportional Dadi-simulated SFS by sample size')
compare_4_sample_size_sfs_cutoff = function(n_50, n_100, n_150, n_200) {
x_axis = 1:20
n_50 = proportional_sfs(n_50)[1:20]
n_100 = proportional_sfs(n_100)[1:20]
n_150 = proportional_sfs(n_150)[1:20]
n_200 = proportional_sfs(n_200)[1:20]
input_df = data.frame(n_50,
n_100,
n_150,
n_200,
x_axis)
names(input_df) = c('N=50',
'N=100',
'N=150',
'N=200',
'x_axis')
p_input_comparison <- ggplot(data = melt(input_df, id='x_axis'),
aes(x=x_axis,
y=value,
fill=variable)) +
geom_bar(position='dodge2', stat='identity') +
labs(x = "", fill = "") +
scale_fill_manual(name='Sample Size',
breaks=c('N=50', 'N=100', 'N=150', 'N=200'),
values=c('N=50'='#bfd3e6',
'N=100'='#8c96c6',
'N=150'='#88419d',
'N=200'='#4d004b')) +
scale_x_continuous(name='Minor allele frequency in sample (up to 20)', breaks=x_axis, limits=c(0.5, length(x_axis) + 0.5)) +
ylab('Proportion of segregating sites') +
theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
## scale_fill_manual(values=c("darkslateblue", "darkslategrey", "darkturquoise"))
return(p_input_comparison)
}
plot_A = compare_4_sample_size_sfs_cutoff(dadi_sfs_80, dadi_sfs_100, dadi_sfs_120, dadi_sfs_140) +
ggtitle('Proportional Dadi-simulated SFS by sample size')
plot_B = ggplot(dadi_simulation_two_epoch_demography_80, aes(dadi_simulation_two_epoch_Time_80, dadi_simulation_two_epoch_NEffective_80, color='N=50')) + geom_step(linewidth=1, linetype='dashed') +
geom_step(data=dadi_simulation_two_epoch_demography_100, aes(dadi_simulation_two_epoch_Time_100, dadi_simulation_two_epoch_NEffective_100, color='N=100'), linewidth=1, linetype='dashed') +
geom_step(data=dadi_simulation_two_epoch_demography_120, aes(dadi_simulation_two_epoch_Time_120, dadi_simulation_two_epoch_NEffective_120, color='N=150'), linewidth=1, linetype='dashed') +
geom_step(data=dadi_simulation_two_epoch_demography_140, aes(dadi_simulation_two_epoch_Time_140, dadi_simulation_two_epoch_NEffective_140, color='N=200'), linewidth=1, linetype='dashed') +
geom_step(data=ThreeEpochB_true_demography_params, aes(ThreeEpochB_true_Time_params, ThreeEpochB_true_NEffective_params, color='True'), linewidth=1, linetype='solid') +
scale_color_manual(name='Sample Size',
breaks=c('N=80', 'N=100', 'N=120', 'N=140', 'True'),
values=c('N=80'='#bfd3e6',
'N=100'='#8c96c6',
'N=120'='#88419d',
'N=140'='#4d004b',
'True'='#b30000')) +
theme_bw() +
ylab('Effective population size') +
xlab('Approximate time in years relative to current time') +
ggtitle('Inferred two-epoch demographic model from Dadi simulated SFS')
plot_A + plot_B + plot_layout(nrow=2)
plot_B = ggplot(dadi_simulation_two_epoch_demography_80, aes(dadi_simulation_two_epoch_Time_80, dadi_simulation_two_epoch_NEffective_80, color='N=80')) + geom_step(linewidth=1, linetype='dashed') +
geom_step(data=dadi_simulation_two_epoch_demography_100, aes(dadi_simulation_two_epoch_Time_100, dadi_simulation_two_epoch_NEffective_100, color='N=100'), linewidth=1, linetype='dashed') +
geom_step(data=dadi_simulation_two_epoch_demography_120, aes(dadi_simulation_two_epoch_Time_120, dadi_simulation_two_epoch_NEffective_120, color='N=120'), linewidth=1, linetype='dashed') +
geom_step(data=dadi_simulation_two_epoch_demography_140, aes(dadi_simulation_two_epoch_Time_140, dadi_simulation_two_epoch_NEffective_140, color='N=140'), linewidth=1, linetype='dashed') +
geom_step(data=ThreeEpochB_true_demography_params, aes(ThreeEpochB_true_Time_params, ThreeEpochB_true_NEffective_params, color='True'), linewidth=1, linetype='solid') +
scale_color_manual(name='Sample Size',
breaks=c('N=80', 'N=100', 'N=120', 'N=140', 'True'),
values=c('N=80'='#bfd3e6',
'N=100'='#8c96c6',
'N=120'='#88419d',
'N=140'='#4d004b',
'True'='#b30000')) +
theme_bw() +
ylab('Effective population size') +
xlab('Approximate time in years relative to current time') +
ggtitle('Inferred two-epoch demographic model from Dadi simulated SFS')
plot_A + plot_B + plot_layout(nrow=2)
dadi_time_80 = time_from_demography('../Analysis/dadi_3EpB_80/two_epoch_demography.txt')
dadi_time_100 = time_from_demography('../Analysis/dadi_3EpB_100/two_epoch_demography.txt')
dadi_time_120 = time_from_demography('../Analysis/dadi_3EpB_120/two_epoch_demography.txt')
dadi_time_140 = time_from_demography('../Analysis/dadi_3EpB_140/two_epoch_demography.txt')
dadi_sfs_80 = read_input_sfs('../Simulations/dadi_simulations/ThreeEpochBottleneck_80.sfs')
dadi_sfs_100 = read_input_sfs('../Simulations/dadi_simulations/ThreeEpochBottleneck_100.sfs')
dadi_sfs_120 = read_input_sfs('../Simulations/dadi_simulations/ThreeEpochBottleneck_120.sfs')
dadi_sfs_140 = read_input_sfs('../Simulations/dadi_simulations/ThreeEpochBottleneck_140.sfs')
dadi_nu_80 = nu_from_demography('../Analysis/dadi_3EpB_80/two_epoch_demography.txt')
dadi_nu_100 = nu_from_demography('../Analysis/dadi_3EpB_100/two_epoch_demography.txt')
dadi_nu_120 = nu_from_demography('../Analysis/dadi_3EpB_120/two_epoch_demography.txt')
dadi_nu_140 = nu_from_demography('../Analysis/dadi_3EpB_140/two_epoch_demography.txt')
dadi_tau_80 = tau_from_demography('../Analysis/dadi_3EpB_80/two_epoch_demography.txt')
dadi_tau_100 = tau_from_demography('../Analysis/dadi_3EpB_100/two_epoch_demography.txt')
dadi_tau_120 = tau_from_demography('../Analysis/dadi_3EpB_120/two_epoch_demography.txt')
dadi_tau_140 = tau_from_demography('../Analysis/dadi_3EpB_140/two_epoch_demography.txt')
dadi_time_80 = time_from_demography('../Analysis/dadi_3EpB_80/two_epoch_demography.txt')
dadi_time_100 = time_from_demography('../Analysis/dadi_3EpB_100/two_epoch_demography.txt')
dadi_time_120 = time_from_demography('../Analysis/dadi_3EpB_120/two_epoch_demography.txt')
dadi_time_140 = time_from_demography('../Analysis/dadi_3EpB_140/two_epoch_demography.txt')
dadi_theta_80 = theta_from_demography('../Analysis/dadi_3EpB_80/two_epoch_demography.txt')
dadi_theta_100 = theta_from_demography('../Analysis/dadi_3EpB_100/two_epoch_demography.txt')
dadi_theta_120 = theta_from_demography('../Analysis/dadi_3EpB_120/two_epoch_demography.txt')
dadi_theta_140 = theta_from_demography('../Analysis/dadi_3EpB_140/two_epoch_demography.txt')
dadi_simulation_two_epoch_theta = c(dadi_theta_80, dadi_theta_100, dadi_theta_120, dadi_theta_140)
dadi_simulation_two_epoch_nu = c(dadi_nu_80, dadi_nu_100, dadi_nu_120, dadi_nu_140)
dadi_simulation_two_epoch_tau = c(dadi_nu_80, dadi_nu_100, dadi_nu_120, dadi_nu_140)
dadi_simulation_two_epoch_time = c(dadi_time_80, dadi_time_100, dadi_time_120, dadi_time_140)
dadi_simulation_two_epoch_NAnc = dadi_simulation_two_epoch_theta / (4 * 100000000 * 1.5E-8)
dadi_simulation_two_epoch_NCurr = dadi_simulation_two_epoch_nu * dadi_simulation_two_epoch_NAnc
# dadi_simulation_two_epoch_Time = 2 * dadi_simulation_two_epoch_tau * dadi_simulation_two_epoch_theta / (4 * 1.5E-8 * 100000000)
# ThreeEpochB_two_epoch_Time = 2 * ThreeEpochB_two_epoch_tau * ThreeEpochB_two_epoch_theta / (4 * ThreeEpochB_mu * ThreeEpochB_two_epoch_allele_sum)
two_epoch_max_time = max(dadi_simulation_two_epoch_Time)
dadi_simulation_two_epoch_max_time = rep(two_epoch_max_time * 1.1, 4)
dadi_simulation_two_epoch_current_time = rep(0, 4)
dadi_simulation_two_epoch_demography = data.frame(dadi_simulation_two_epoch_NAnc, dadi_simulation_two_epoch_max_time,
dadi_simulation_two_epoch_NCurr, dadi_simulation_two_epoch_Time,
dadi_simulation_two_epoch_NCurr, dadi_simulation_two_epoch_current_time)
dadi_simulation_two_epoch_NEffective_80 = c(dadi_simulation_two_epoch_demography[1, 1], dadi_simulation_two_epoch_demography[1, 3], dadi_simulation_two_epoch_demography[1, 5])
dadi_simulation_two_epoch_Time_80 = c(-dadi_simulation_two_epoch_demography[1, 2], -dadi_simulation_two_epoch_demography[1, 4], dadi_simulation_two_epoch_demography[1, 6])
dadi_simulation_two_epoch_demography_80 = data.frame(dadi_simulation_two_epoch_Time_80, dadi_simulation_two_epoch_NEffective_80)
dadi_simulation_two_epoch_NEffective_100 = c(dadi_simulation_two_epoch_demography[2, 1], dadi_simulation_two_epoch_demography[2, 3], dadi_simulation_two_epoch_demography[2, 5])
dadi_simulation_two_epoch_Time_100 = c(-dadi_simulation_two_epoch_demography[2, 2], -dadi_simulation_two_epoch_demography[2, 4], dadi_simulation_two_epoch_demography[2, 6])
dadi_simulation_two_epoch_demography_100 = data.frame(dadi_simulation_two_epoch_Time_100, dadi_simulation_two_epoch_NEffective_100)
dadi_simulation_two_epoch_NEffective_120 = c(dadi_simulation_two_epoch_demography[3, 1], dadi_simulation_two_epoch_demography[3, 3], dadi_simulation_two_epoch_demography[3, 5])
dadi_simulation_two_epoch_Time_120 = c(-dadi_simulation_two_epoch_demography[3, 2], -dadi_simulation_two_epoch_demography[3, 4], dadi_simulation_two_epoch_demography[3, 6])
dadi_simulation_two_epoch_demography_120 = data.frame(dadi_simulation_two_epoch_Time_120, dadi_simulation_two_epoch_NEffective_120)
dadi_simulation_two_epoch_NEffective_140 = c(dadi_simulation_two_epoch_demography[4, 1], dadi_simulation_two_epoch_demography[4, 3], dadi_simulation_two_epoch_demography[4, 5])
dadi_simulation_two_epoch_Time_140 = c(-dadi_simulation_two_epoch_demography[4, 2], -dadi_simulation_two_epoch_demography[4, 4], dadi_simulation_two_epoch_demography[4, 6])
dadi_simulation_two_epoch_demography_140 = data.frame(dadi_simulation_two_epoch_Time_140, dadi_simulation_two_epoch_NEffective_140)
ThreeEpochB_true_NAnc = 10000
ThreeEpochB_true_NBottle = 1000
ThreeEpochB_true_NCurr = 50000
ThreeEpochB_true_TimeBottleEnd = 200
ThreeEpochB_true_TimeBottleStart = 1800
# ThreeEpochB_three_epoch_TimeBottleEnd = 2 * ThreeEpochB_three_epoch_tauF * ThreeEpochB_three_epoch_theta / (4 * ThreeEpochB_mu * ThreeEpochB_three_epoch_allele_sum)
# ThreeEpochB_three_epoch_TimeBottleStart = 2 * ThreeEpochB_three_epoch_tauB * ThreeEpochB_three_epoch_theta / (4 * ThreeEpochB_mu * ThreeEpochB_three_epoch_allele_sum) + ThreeEpochB_three_epoch_TimeBottleEnd
ThreeEpochB_true_TimeTotal = 2000
ThreeEpochB_true_TimeCurrent = 0
ThreeEpochB_true_demography = data.frame(ThreeEpochB_true_NAnc, two_epoch_max_time * 1.1,
ThreeEpochB_true_NBottle, ThreeEpochB_true_TimeBottleStart,
ThreeEpochB_true_NCurr, ThreeEpochB_true_TimeBottleEnd,
ThreeEpochB_true_NCurr, ThreeEpochB_true_TimeCurrent)
ThreeEpochB_true_NEffective_params = c(ThreeEpochB_true_demography[1, 1], ThreeEpochB_true_demography[1, 3], ThreeEpochB_true_demography[1, 5], ThreeEpochB_true_demography[1, 7])
ThreeEpochB_true_Time_params = c(-ThreeEpochB_true_demography[1, 2], -ThreeEpochB_true_demography[1, 4], -ThreeEpochB_true_demography[1, 6], -ThreeEpochB_true_demography[1, 8])
ThreeEpochB_true_demography_params = data.frame(ThreeEpochB_true_Time_params, ThreeEpochB_true_NEffective_params)
plot_A = compare_4_sample_size_sfs_cutoff(dadi_sfs_80, dadi_sfs_100, dadi_sfs_120, dadi_sfs_140) +
ggtitle('Proportional Dadi-simulated SFS by sample size')
plot_B = ggplot(dadi_simulation_two_epoch_demography_80, aes(dadi_simulation_two_epoch_Time_80, dadi_simulation_two_epoch_NEffective_80, color='N=80')) + geom_step(linewidth=1, linetype='dashed') +
geom_step(data=dadi_simulation_two_epoch_demography_100, aes(dadi_simulation_two_epoch_Time_100, dadi_simulation_two_epoch_NEffective_100, color='N=100'), linewidth=1, linetype='dashed') +
geom_step(data=dadi_simulation_two_epoch_demography_120, aes(dadi_simulation_two_epoch_Time_120, dadi_simulation_two_epoch_NEffective_120, color='N=120'), linewidth=1, linetype='dashed') +
geom_step(data=dadi_simulation_two_epoch_demography_140, aes(dadi_simulation_two_epoch_Time_140, dadi_simulation_two_epoch_NEffective_140, color='N=140'), linewidth=1, linetype='dashed') +
geom_step(data=ThreeEpochB_true_demography_params, aes(ThreeEpochB_true_Time_params, ThreeEpochB_true_NEffective_params, color='True'), linewidth=1, linetype='solid') +
scale_color_manual(name='Sample Size',
breaks=c('N=80', 'N=100', 'N=120', 'N=140', 'True'),
values=c('N=80'='#bfd3e6',
'N=100'='#8c96c6',
'N=120'='#88419d',
'N=140'='#4d004b',
'True'='#b30000')) +
theme_bw() +
ylab('Effective population size') +
xlab('Approximate time in years relative to current time') +
ggtitle('Inferred two-epoch demographic model from Dadi simulated SFS')
plot_A + plot_B + plot_layout(nrow=2)
ThreeEpochB_true_demography
dadi_simulation_two_epoch_time
dadi_simulation_two_epoch_Time_80
dadi_simulation_two_epoch_NEffective_100
dadi_simulation_two_epoch_NEffective_80 = c(dadi_simulation_two_epoch_demography[1, 1], dadi_simulation_two_epoch_demography[1, 3], dadi_simulation_two_epoch_demography[1, 5])
dadi_simulation_two_epoch_Time_80 = c(-dadi_simulation_two_epoch_demography[1, 2], -dadi_simulation_two_epoch_demography[1, 4], dadi_simulation_two_epoch_demography[1, 6])
dadi_simulation_two_epoch_demography_80 = data.frame(dadi_simulation_two_epoch_Time_80, dadi_simulation_two_epoch_NEffective_80)
dadi_simulation_two_epoch_NEffective_100 = c(dadi_simulation_two_epoch_demography[2, 1], -dadi_simulation_two_epoch_demography[2, 3], dadi_simulation_two_epoch_demography[2, 5])
dadi_simulation_two_epoch_Time_100 = c(-dadi_simulation_two_epoch_demography[2, 2], -dadi_simulation_two_epoch_demography[2, 4], dadi_simulation_two_epoch_demography[2, 6])
dadi_simulation_two_epoch_demography_100 = data.frame(dadi_simulation_two_epoch_Time_100, dadi_simulation_two_epoch_NEffective_100)
dadi_simulation_two_epoch_NEffective_120 = c(dadi_simulation_two_epoch_demography[3, 1], -dadi_simulation_two_epoch_demography[3, 3], dadi_simulation_two_epoch_demography[3, 5])
dadi_simulation_two_epoch_Time_120 = c(-dadi_simulation_two_epoch_demography[3, 2], -dadi_simulation_two_epoch_demography[3, 4], dadi_simulation_two_epoch_demography[3, 6])
dadi_simulation_two_epoch_demography_120 = data.frame(dadi_simulation_two_epoch_Time_120, dadi_simulation_two_epoch_NEffective_120)
dadi_simulation_two_epoch_NEffective_140 = c(dadi_simulation_two_epoch_demography[4, 1], -dadi_simulation_two_epoch_demography[4, 3], dadi_simulation_two_epoch_demography[4, 5])
dadi_simulation_two_epoch_Time_140 = c(-dadi_simulation_two_epoch_demography[4, 2], -dadi_simulation_two_epoch_demography[4, 4], dadi_simulation_two_epoch_demography[4, 6])
dadi_simulation_two_epoch_demography_140 = data.frame(dadi_simulation_two_epoch_Time_140, dadi_simulation_two_epoch_NEffective_140)
ThreeEpochB_true_NAnc = 10000
ThreeEpochB_true_NBottle = 1000
ThreeEpochB_true_NCurr = 50000
ThreeEpochB_true_TimeBottleEnd = 200
ThreeEpochB_true_TimeBottleStart = 1800
ThreeEpochB_true_TimeTotal = 2000
ThreeEpochB_true_TimeCurrent = 0
ThreeEpochB_true_demography = data.frame(ThreeEpochB_true_NAnc, two_epoch_max_time * 1.1,
ThreeEpochB_true_NBottle, ThreeEpochB_true_TimeBottleStart,
ThreeEpochB_true_NCurr, ThreeEpochB_true_TimeBottleEnd,
ThreeEpochB_true_NCurr, ThreeEpochB_true_TimeCurrent)
ThreeEpochB_true_NEffective_params = c(ThreeEpochB_true_demography[1, 1], ThreeEpochB_true_demography[1, 3], ThreeEpochB_true_demography[1, 5], ThreeEpochB_true_demography[1, 7])
ThreeEpochB_true_Time_params = c(-ThreeEpochB_true_demography[1, 2], -ThreeEpochB_true_demography[1, 4], -ThreeEpochB_true_demography[1, 6], -ThreeEpochB_true_demography[1, 8])
ThreeEpochB_true_demography_params = data.frame(ThreeEpochB_true_Time_params, ThreeEpochB_true_NEffective_params)
plot_A = compare_4_sample_size_sfs_cutoff(dadi_sfs_80, dadi_sfs_100, dadi_sfs_120, dadi_sfs_140) +
ggtitle('Proportional Dadi-simulated SFS by sample size')
plot_B = ggplot(dadi_simulation_two_epoch_demography_80, aes(dadi_simulation_two_epoch_Time_80, dadi_simulation_two_epoch_NEffective_80, color='N=80')) + geom_step(linewidth=1, linetype='dashed') +
geom_step(data=dadi_simulation_two_epoch_demography_100, aes(dadi_simulation_two_epoch_Time_100, dadi_simulation_two_epoch_NEffective_100, color='N=100'), linewidth=1, linetype='dashed') +
geom_step(data=dadi_simulation_two_epoch_demography_120, aes(dadi_simulation_two_epoch_Time_120, dadi_simulation_two_epoch_NEffective_120, color='N=120'), linewidth=1, linetype='dashed') +
geom_step(data=dadi_simulation_two_epoch_demography_140, aes(dadi_simulation_two_epoch_Time_140, dadi_simulation_two_epoch_NEffective_140, color='N=140'), linewidth=1, linetype='dashed') +
geom_step(data=ThreeEpochB_true_demography_params, aes(ThreeEpochB_true_Time_params, ThreeEpochB_true_NEffective_params, color='True'), linewidth=1, linetype='solid') +
scale_color_manual(name='Sample Size',
breaks=c('N=80', 'N=100', 'N=120', 'N=140', 'True'),
values=c('N=80'='#bfd3e6',
'N=100'='#8c96c6',
'N=120'='#88419d',
'N=140'='#4d004b',
'True'='#b30000')) +
theme_bw() +
ylab('Effective population size') +
xlab('Approximate time in years relative to current time') +
ggtitle('Inferred two-epoch demographic model from Dadi simulated SFS')
plot_A + plot_B + plot_layout(nrow=2)
# * 4 sample sizes ranging from small to large (ancient to recent)
# * 4 sample sizes ranging from small to large (ancient to recent)
# * Just Dadi shown in main text, MSPrime for supplement
# * 4 sample sizes ranging from small to large (ancient to recent)
# * Just Dadi shown in main text, MSPrime for supplement
# * SFS on left-hand, demography plot on right hand [two-epoch fit, for now, best-fit later or in supplement]
# * 4 sample sizes ranging from small to large (ancient to recent)
# * Just Dadi shown in main text, MSPrime for supplement
# * SFS on left-hand, demography plot on right hand [two-epoch fit, for now, best-fit later or in supplement]
# * Show true underlying simulated demography
# * 4 sample sizes ranging from small to large (ancient to recent)
# * Just Dadi shown in main text, MSPrime for supplement
# * SFS on left-hand, demography plot on right hand [two-epoch fit, for now, best-fit later or in supplement]
# * Show true underlying simulated demography
# * 4 sample sizes ranging from small to large (ancient to recent)
# * Just Dadi shown in main text, MSPrime for supplement
# * SFS on left-hand, demography plot on right hand [two-epoch fit, for now, best-fit later or in supplement]
# * Show true underlying simulated demography
# * 4 sample sizes ranging from small to large (ancient to recent)
# * Just Dadi shown in main text, MSPrime for supplement
# * SFS on left-hand, demography plot on right hand [two-epoch fit, for now, best-fit later or in supplement]
# * Show true underlying simulated demography
# * 4 sample sizes ranging from small to large (ancient to recent)
# * Just Dadi shown in main text, MSPrime for supplement
# * SFS on left-hand, demography plot on right hand [two-epoch fit, for now, best-fit later or in supplement]
# * Show true underlying simulated demography
# * 4 sample sizes ranging from small to large (ancient to recent)
# * Just Dadi shown in main text, MSPrime for supplement
# * SFS on left-hand, demography plot on right hand [two-epoch fit, for now, best-fit later or in supplement]
# * Show true underlying simulated demography
# * 4 sample sizes ranging from small to large (ancient to recent)
# * Just Dadi shown in main text, MSPrime for supplement
# * SFS on left-hand, demography plot on right hand [two-epoch fit, for now, best-fit later or in supplement]
# * Show true underlying simulated demography
dadi_simulation_two_epoch_time = c(dadi_time_80, dadi_time_100, dadi_time_120, dadi_time_140)
dadi_simulation_two_epoch_NEffective_80 = c(dadi_simulation_two_epoch_demography[1, 1], dadi_simulation_two_epoch_demography[1, 3], dadi_simulation_two_epoch_demography[1, 5])
dadi_simulation_two_epoch_Time_80 = c(-dadi_simulation_two_epoch_demography[1, 2], -dadi_simulation_two_epoch_demography[1, 4], dadi_simulation_two_epoch_demography[1, 6])
dadi_simulation_two_epoch_demography_80 = data.frame(dadi_simulation_two_epoch_Time_80, dadi_simulation_two_epoch_NEffective_80)
dadi_simulation_two_epoch_NEffective_100 = c(dadi_simulation_two_epoch_demography[2, 1], dadi_simulation_two_epoch_demography[2, 3], dadi_simulation_two_epoch_demography[2, 5])
dadi_simulation_two_epoch_Time_100 = c(-dadi_simulation_two_epoch_demography[2, 2], -dadi_simulation_two_epoch_demography[2, 4], dadi_simulation_two_epoch_demography[2, 6])
dadi_simulation_two_epoch_demography_100 = data.frame(dadi_simulation_two_epoch_Time_100, dadi_simulation_two_epoch_NEffective_100)
dadi_simulation_two_epoch_NEffective_120 = c(dadi_simulation_two_epoch_demography[3, 1], dadi_simulation_two_epoch_demography[3, 3], dadi_simulation_two_epoch_demography[3, 5])
dadi_simulation_two_epoch_Time_120 = c(-dadi_simulation_two_epoch_demography[3, 2], -dadi_simulation_two_epoch_demography[3, 4], dadi_simulation_two_epoch_demography[3, 6])
dadi_simulation_two_epoch_demography_120 = data.frame(dadi_simulation_two_epoch_Time_120, dadi_simulation_two_epoch_NEffective_120)
dadi_simulation_two_epoch_NEffective_140 = c(dadi_simulation_two_epoch_demography[4, 1], dadi_simulation_two_epoch_demography[4, 3], dadi_simulation_two_epoch_demography[4, 5])
dadi_simulation_two_epoch_Time_140 = c(-dadi_simulation_two_epoch_demography[4, 2], -dadi_simulation_two_epoch_demography[4, 4], dadi_simulation_two_epoch_demography[4, 6])
dadi_simulation_two_epoch_demography_140 = data.frame(dadi_simulation_two_epoch_Time_140, dadi_simulation_two_epoch_NEffective_140)
dadi_simulation_two_epoch_Time_80
dadi_simulation_two_epoch_Time_100
dadi_simulation_two_epoch_Time_120
dadi_simulation_two_epoch_demography
dadi_simulation_two_epoch_Time = c(dadi_time_80, dadi_time_100, dadi_time_120, dadi_time_140)
two_epoch_max_time = max(dadi_simulation_two_epoch_time)
dadi_simulation_two_epoch_max_time = rep(two_epoch_max_time * 1.1, 4)
dadi_simulation_two_epoch_current_time = rep(0, 4)
dadi_simulation_two_epoch_demography = data.frame(dadi_simulation_two_epoch_NAnc, dadi_simulation_two_epoch_max_time,
dadi_simulation_two_epoch_NCurr, dadi_simulation_two_epoch_Time,
dadi_simulation_two_epoch_NCurr, dadi_simulation_two_epoch_current_time)
dadi_simulation_two_epoch_NEffective_80 = c(dadi_simulation_two_epoch_demography[1, 1], dadi_simulation_two_epoch_demography[1, 3], dadi_simulation_two_epoch_demography[1, 5])
dadi_simulation_two_epoch_Time_80 = c(-dadi_simulation_two_epoch_demography[1, 2], -dadi_simulation_two_epoch_demography[1, 4], dadi_simulation_two_epoch_demography[1, 6])
dadi_simulation_two_epoch_Time
dadi_simulation_two_epoch_demography_80 = data.frame(dadi_simulation_two_epoch_Time_80, dadi_simulation_two_epoch_NEffective_80)
dadi_simulation_two_epoch_NEffective_100 = c(dadi_simulation_two_epoch_demography[2, 1], dadi_simulation_two_epoch_demography[2, 3], dadi_simulation_two_epoch_demography[2, 5])
dadi_simulation_two_epoch_Time_100 = c(-dadi_simulation_two_epoch_demography[2, 2], -dadi_simulation_two_epoch_demography[2, 4], dadi_simulation_two_epoch_demography[2, 6])
dadi_simulation_two_epoch_demography_100 = data.frame(dadi_simulation_two_epoch_Time_100, dadi_simulation_two_epoch_NEffective_100)
dadi_simulation_two_epoch_NEffective_120 = c(dadi_simulation_two_epoch_demography[3, 1], dadi_simulation_two_epoch_demography[3, 3], dadi_simulation_two_epoch_demography[3, 5])
dadi_simulation_two_epoch_Time_120 = c(-dadi_simulation_two_epoch_demography[3, 2], -dadi_simulation_two_epoch_demography[3, 4], dadi_simulation_two_epoch_demography[3, 6])
dadi_simulation_two_epoch_demography_120 = data.frame(dadi_simulation_two_epoch_Time_120, dadi_simulation_two_epoch_NEffective_120)
dadi_simulation_two_epoch_NEffective_140 = c(dadi_simulation_two_epoch_demography[4, 1], dadi_simulation_two_epoch_demography[4, 3], dadi_simulation_two_epoch_demography[4, 5])
dadi_simulation_two_epoch_Time_140 = c(-dadi_simulation_two_epoch_demography[4, 2], -dadi_simulation_two_epoch_demography[4, 4], dadi_simulation_two_epoch_demography[4, 6])
dadi_simulation_two_epoch_demography_140 = data.frame(dadi_simulation_two_epoch_Time_140, dadi_simulation_two_epoch_NEffective_140)
ThreeEpochB_true_NAnc = 10000
ThreeEpochB_true_NBottle = 1000
ThreeEpochB_true_NCurr = 50000
ThreeEpochB_true_TimeBottleEnd = 200
ThreeEpochB_true_TimeBottleStart = 1800
ThreeEpochB_true_TimeTotal = 2000
ThreeEpochB_true_TimeCurrent = 0
ThreeEpochB_true_demography = data.frame(ThreeEpochB_true_NAnc, two_epoch_max_time * 1.1,
ThreeEpochB_true_NBottle, ThreeEpochB_true_TimeBottleStart,
ThreeEpochB_true_NCurr, ThreeEpochB_true_TimeBottleEnd,
ThreeEpochB_true_NCurr, ThreeEpochB_true_TimeCurrent)
ThreeEpochB_true_NEffective_params = c(ThreeEpochB_true_demography[1, 1], ThreeEpochB_true_demography[1, 3], ThreeEpochB_true_demography[1, 5], ThreeEpochB_true_demography[1, 7])
ThreeEpochB_true_Time_params = c(-ThreeEpochB_true_demography[1, 2], -ThreeEpochB_true_demography[1, 4], -ThreeEpochB_true_demography[1, 6], -ThreeEpochB_true_demography[1, 8])
