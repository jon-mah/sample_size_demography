scale_y_log10() +
scale_x_continuous(breaks=EUR_df_long$Index) +
scale_color_manual(values = c("blue", "green", "red"),
label=c('One-epoch', 'Three-epoch', 'Two-epoch')) +
theme_bw()
ggplot(EUR_df_long, aes(x = Index, y = AIC, color = Epoch)) +
geom_line(linetype=3) +
geom_point() +
labs(title = "1KG EUR AIC and residual by sample size (N=10-19:1)",
x = "Sample Size",
y = "AIC") +
scale_y_log10(sec.axis = sec_axis(~.*1, name="Residual")) +
scale_x_continuous(breaks=EUR_df_long$Index) +
geom_line(data=EUR_df_long_residual, aes(x = Index, y = residual*1, color = Epoch)) +
scale_color_manual(values = c("blue", "orange", "green", "violet", "red", "seagreen"),
label=c('One-epoch AIC', 'One-epoch residual',
'Three-epoch AIC', 'Three-epoch residual',
'Two-epoch AIC', 'Two-epoch residual')) +
theme_bw()
# 1KG_EUR population genetic constants
EUR_mu = 1.5E-8
# NAnc = theta / (4 * allele_sum * mu)
# generations = 2 * tau * theta / (4 * mu * allele_sum)
# years = generations / 365
# NCurr = nu * NAnc
# generations_b = 2 * tauB * theta / (4 * mu * allele_sum)
# generations_f = 2 * tauF * theta / (4 * mu * allele_sum)
# NBottle = nuB * NAnc
# NSince = nuF * NAnc
EUR_one_epoch_NAnc = EUR_one_epoch_theta / (4 * EUR_one_epoch_allele_sum * EUR_mu)
EUR_two_epoch_NAnc = EUR_two_epoch_theta / (4 * EUR_two_epoch_allele_sum * EUR_mu)
EUR_two_epoch_NCurr = EUR_two_epoch_nu * EUR_two_epoch_NAnc
EUR_two_epoch_Time = 2 * 25 * EUR_two_epoch_tau * EUR_two_epoch_theta / (4 * EUR_mu * EUR_two_epoch_allele_sum)
EUR_three_epoch_NAnc = EUR_three_epoch_theta / (4 * EUR_three_epoch_allele_sum * EUR_mu)
EUR_three_epoch_NBottle = EUR_three_epoch_nuB * EUR_three_epoch_NAnc
EUR_three_epoch_NCurr = EUR_three_epoch_nuF * EUR_three_epoch_NAnc
EUR_three_epoch_TimeBottleEnd = 2 * 25 * EUR_three_epoch_tauF * EUR_three_epoch_theta / (4 * EUR_mu * EUR_three_epoch_allele_sum)
EUR_three_epoch_TimeBottleStart = 2 * 25 * EUR_three_epoch_tauB * EUR_three_epoch_theta / (4 * EUR_mu * EUR_three_epoch_allele_sum) + EUR_three_epoch_TimeBottleEnd
EUR_three_epoch_TimeTotal = EUR_three_epoch_TimeBottleStart + EUR_three_epoch_TimeBottleEnd
EUR_two_epoch_max_time = rep(1.25E6, 10)
# EUR_two_epoch_max_time = rep(2E4, 10)
EUR_two_epoch_current_time = rep(0, 10)
EUR_two_epoch_demography = data.frame(EUR_two_epoch_NAnc, EUR_two_epoch_max_time,
EUR_two_epoch_NCurr, EUR_two_epoch_Time,
EUR_two_epoch_NCurr, EUR_two_epoch_current_time)
# EUR_three_epoch_max_time = rep(100000000, 10)
# EUR_three_epoch_max_time = rep(5E6, 10)
EUR_three_epoch_max_time = rep(1.25E6, 10)
EUR_three_epoch_current_time = rep(0, 10)
EUR_three_epoch_demography = data.frame(EUR_three_epoch_NAnc, EUR_three_epoch_max_time,
EUR_three_epoch_NBottle, EUR_three_epoch_TimeBottleStart,
EUR_three_epoch_NCurr, EUR_three_epoch_TimeBottleEnd,
EUR_three_epoch_NCurr, EUR_three_epoch_current_time)
EUR_two_epoch_NEffective_10 = c(EUR_two_epoch_demography[1, 1], EUR_two_epoch_demography[1, 3], EUR_two_epoch_demography[1, 5])
EUR_two_epoch_Time_10 = c(-EUR_two_epoch_demography[1, 2], -EUR_two_epoch_demography[1, 4], EUR_two_epoch_demography[1, 6])
EUR_two_epoch_demography_10 = data.frame(EUR_two_epoch_Time_10, EUR_two_epoch_NEffective_10)
EUR_two_epoch_NEffective_11 = c(EUR_two_epoch_demography[2, 1], EUR_two_epoch_demography[2, 3], EUR_two_epoch_demography[2, 5])
EUR_two_epoch_Time_11 = c(-EUR_two_epoch_demography[2, 2], -EUR_two_epoch_demography[2, 4], EUR_two_epoch_demography[2, 6])
EUR_two_epoch_demography_11 = data.frame(EUR_two_epoch_Time_11, EUR_two_epoch_NEffective_11)
EUR_two_epoch_NEffective_12 = c(EUR_two_epoch_demography[3, 1], EUR_two_epoch_demography[3, 3], EUR_two_epoch_demography[3, 5])
EUR_two_epoch_Time_12 = c(-EUR_two_epoch_demography[3, 2], -EUR_two_epoch_demography[3, 4], EUR_two_epoch_demography[3, 6])
EUR_two_epoch_demography_12 = data.frame(EUR_two_epoch_Time_12, EUR_two_epoch_NEffective_12)
EUR_two_epoch_NEffective_13 = c(EUR_two_epoch_demography[4, 1], EUR_two_epoch_demography[4, 3], EUR_two_epoch_demography[4, 5])
EUR_two_epoch_Time_13 = c(-EUR_two_epoch_demography[4, 2], -EUR_two_epoch_demography[4, 4], EUR_two_epoch_demography[4, 6])
EUR_two_epoch_demography_13 = data.frame(EUR_two_epoch_Time_13, EUR_two_epoch_NEffective_13)
EUR_two_epoch_NEffective_14 = c(EUR_two_epoch_demography[5, 1], EUR_two_epoch_demography[5, 3], EUR_two_epoch_demography[5, 5])
EUR_two_epoch_Time_14 = c(-EUR_two_epoch_demography[5, 2], -EUR_two_epoch_demography[5, 4], EUR_two_epoch_demography[5, 6])
EUR_two_epoch_demography_14 = data.frame(EUR_two_epoch_Time_14, EUR_two_epoch_NEffective_14)
EUR_two_epoch_NEffective_15 = c(EUR_two_epoch_demography[6, 1], EUR_two_epoch_demography[6, 3], EUR_two_epoch_demography[6, 5])
EUR_two_epoch_Time_15 = c(-EUR_two_epoch_demography[6, 2], -EUR_two_epoch_demography[6, 4], EUR_two_epoch_demography[6, 6])
EUR_two_epoch_demography_15 = data.frame(EUR_two_epoch_Time_15, EUR_two_epoch_NEffective_15)
EUR_two_epoch_NEffective_16 = c(EUR_two_epoch_demography[7, 1], EUR_two_epoch_demography[7, 3], EUR_two_epoch_demography[7, 5])
EUR_two_epoch_Time_16 = c(-EUR_two_epoch_demography[7, 2], -EUR_two_epoch_demography[7, 4], EUR_two_epoch_demography[7, 6])
EUR_two_epoch_demography_16 = data.frame(EUR_two_epoch_Time_16, EUR_two_epoch_NEffective_16)
EUR_two_epoch_NEffective_17 = c(EUR_two_epoch_demography[8, 1], EUR_two_epoch_demography[8, 3], EUR_two_epoch_demography[8, 5])
EUR_two_epoch_Time_17 = c(-EUR_two_epoch_demography[8, 2], -EUR_two_epoch_demography[8, 4], EUR_two_epoch_demography[8, 6])
EUR_two_epoch_demography_17 = data.frame(EUR_two_epoch_Time_17, EUR_two_epoch_NEffective_17)
EUR_two_epoch_NEffective_18 = c(EUR_two_epoch_demography[9, 1], EUR_two_epoch_demography[9, 3], EUR_two_epoch_demography[9, 5])
EUR_two_epoch_Time_18 = c(-EUR_two_epoch_demography[9, 2], -EUR_two_epoch_demography[9, 4], EUR_two_epoch_demography[9, 6])
EUR_two_epoch_demography_18 = data.frame(EUR_two_epoch_Time_18, EUR_two_epoch_NEffective_18)
EUR_two_epoch_NEffective_19 = c(EUR_two_epoch_demography[10, 1], EUR_two_epoch_demography[10, 3], EUR_two_epoch_demography[10, 5])
EUR_two_epoch_Time_19 = c(-EUR_two_epoch_demography[10, 2], -EUR_two_epoch_demography[10, 4], EUR_two_epoch_demography[10, 6])
EUR_two_epoch_demography_19 = data.frame(EUR_two_epoch_Time_19, EUR_two_epoch_NEffective_19)
EUR_three_epoch_NEffective_10 = c(EUR_three_epoch_demography[1, 1], EUR_three_epoch_demography[1, 3], EUR_three_epoch_demography[1, 5], EUR_three_epoch_demography[1, 7])
EUR_three_epoch_Time_10 = c(-EUR_three_epoch_demography[1, 2], -EUR_three_epoch_demography[1, 4], -EUR_three_epoch_demography[1, 6], EUR_three_epoch_demography[1, 8])
EUR_three_epoch_demography_10 = data.frame(EUR_three_epoch_Time_10, EUR_three_epoch_NEffective_10)
EUR_three_epoch_NEffective_11 = c(EUR_three_epoch_demography[2, 1], EUR_three_epoch_demography[2, 3], EUR_three_epoch_demography[2, 5], EUR_three_epoch_demography[2, 7])
EUR_three_epoch_Time_11 = c(-EUR_three_epoch_demography[2, 2], -EUR_three_epoch_demography[2, 4], -EUR_three_epoch_demography[2, 6], EUR_three_epoch_demography[2, 8])
EUR_three_epoch_demography_11 = data.frame(EUR_three_epoch_Time_11, EUR_three_epoch_NEffective_11)
EUR_three_epoch_NEffective_12 = c(EUR_three_epoch_demography[3, 1], EUR_three_epoch_demography[3, 3], EUR_three_epoch_demography[3, 5], EUR_three_epoch_demography[3, 7])
EUR_three_epoch_Time_12 = c(-EUR_three_epoch_demography[3, 2], -EUR_three_epoch_demography[3, 4], -EUR_three_epoch_demography[3, 6], EUR_three_epoch_demography[3, 8])
EUR_three_epoch_demography_12 = data.frame(EUR_three_epoch_Time_12, EUR_three_epoch_NEffective_12)
EUR_three_epoch_NEffective_13 = c(EUR_three_epoch_demography[4, 1], EUR_three_epoch_demography[4, 3], EUR_three_epoch_demography[4, 5], EUR_three_epoch_demography[4, 7])
EUR_three_epoch_Time_13 = c(-EUR_three_epoch_demography[4, 2], -EUR_three_epoch_demography[4, 4], -EUR_three_epoch_demography[4, 6], EUR_three_epoch_demography[4, 8])
EUR_three_epoch_demography_13 = data.frame(EUR_three_epoch_Time_13, EUR_three_epoch_NEffective_13)
EUR_three_epoch_NEffective_14 = c(EUR_three_epoch_demography[5, 1], EUR_three_epoch_demography[5, 3], EUR_three_epoch_demography[5, 5], EUR_three_epoch_demography[5, 7])
EUR_three_epoch_Time_14 = c(-EUR_three_epoch_demography[5, 2], -EUR_three_epoch_demography[5, 4], -EUR_three_epoch_demography[5, 6], EUR_three_epoch_demography[5, 8])
EUR_three_epoch_demography_14 = data.frame(EUR_three_epoch_Time_14, EUR_three_epoch_NEffective_14)
EUR_three_epoch_NEffective_15 = c(EUR_three_epoch_demography[6, 1], EUR_three_epoch_demography[6, 3], EUR_three_epoch_demography[6, 5], EUR_three_epoch_demography[6, 7])
EUR_three_epoch_Time_15 = c(-EUR_three_epoch_demography[6, 2], -EUR_three_epoch_demography[6, 4], -EUR_three_epoch_demography[6, 6], EUR_three_epoch_demography[6, 8])
EUR_three_epoch_demography_15 = data.frame(EUR_three_epoch_Time_15, EUR_three_epoch_NEffective_15)
EUR_three_epoch_NEffective_16 = c(EUR_three_epoch_demography[7, 1], EUR_three_epoch_demography[7, 3], EUR_three_epoch_demography[7, 5], EUR_three_epoch_demography[7, 7])
EUR_three_epoch_Time_16 = c(-EUR_three_epoch_demography[7, 2], -EUR_three_epoch_demography[7, 4], -EUR_three_epoch_demography[7, 6], EUR_three_epoch_demography[7, 8])
EUR_three_epoch_demography_16 = data.frame(EUR_three_epoch_Time_16, EUR_three_epoch_NEffective_16)
EUR_three_epoch_NEffective_17 = c(EUR_three_epoch_demography[8, 1], EUR_three_epoch_demography[8, 3], EUR_three_epoch_demography[8, 5], EUR_three_epoch_demography[8, 7])
EUR_three_epoch_Time_17 = c(-EUR_three_epoch_demography[8, 2], -EUR_three_epoch_demography[8, 4], -EUR_three_epoch_demography[8, 6], EUR_three_epoch_demography[8, 8])
EUR_three_epoch_demography_17 = data.frame(EUR_three_epoch_Time_17, EUR_three_epoch_NEffective_17)
EUR_three_epoch_NEffective_18 = c(EUR_three_epoch_demography[9, 1], EUR_three_epoch_demography[9, 3], EUR_three_epoch_demography[9, 5], EUR_three_epoch_demography[9, 7])
EUR_three_epoch_Time_18 = c(-EUR_three_epoch_demography[9, 2], -EUR_three_epoch_demography[9, 4], -EUR_three_epoch_demography[9, 6], EUR_three_epoch_demography[9, 8])
EUR_three_epoch_demography_18 = data.frame(EUR_three_epoch_Time_18, EUR_three_epoch_NEffective_18)
EUR_three_epoch_NEffective_19 = c(EUR_three_epoch_demography[10, 1], EUR_three_epoch_demography[10, 3], EUR_three_epoch_demography[10, 5], EUR_three_epoch_demography[10, 7])
EUR_three_epoch_Time_19 = c(-EUR_three_epoch_demography[10, 2], -EUR_three_epoch_demography[10, 4], -EUR_three_epoch_demography[10, 6], EUR_three_epoch_demography[10, 8])
EUR_three_epoch_demography_19 = data.frame(EUR_three_epoch_Time_19, EUR_three_epoch_NEffective_19)
ggplot(EUR_two_epoch_demography_10, aes(EUR_two_epoch_Time_10, EUR_two_epoch_NEffective_10, color='N=10')) + geom_step(linewidth=1, linetype='dotted') +
geom_step(data=EUR_two_epoch_demography_11, aes(EUR_two_epoch_Time_11, EUR_two_epoch_NEffective_11, color='N=11'), linewidth=1, linetype='dotted') +
geom_step(data=EUR_two_epoch_demography_12, aes(EUR_two_epoch_Time_12, EUR_two_epoch_NEffective_12, color='N=12'), linewidth=1, linetype='dotted') +
geom_step(data=EUR_two_epoch_demography_13, aes(EUR_two_epoch_Time_13, EUR_two_epoch_NEffective_13, color='N=13'), linewidth=1, linetype='dotted') +
geom_step(data=EUR_two_epoch_demography_14, aes(EUR_two_epoch_Time_14, EUR_two_epoch_NEffective_14, color='N=14'), linewidth=1, linetype='dotted') +
geom_step(data=EUR_two_epoch_demography_15, aes(EUR_two_epoch_Time_15, EUR_two_epoch_NEffective_15, color='N=15'), linewidth=1, linetype='dotted') +
geom_step(data=EUR_two_epoch_demography_16, aes(EUR_two_epoch_Time_16, EUR_two_epoch_NEffective_16, color='N=16'), linewidth=1, linetype='dotted') +
geom_step(data=EUR_two_epoch_demography_17, aes(EUR_two_epoch_Time_17, EUR_two_epoch_NEffective_17, color='N=17'), linewidth=1, linetype='dotted') +
geom_step(data=EUR_two_epoch_demography_18, aes(EUR_two_epoch_Time_18, EUR_two_epoch_NEffective_18, color='N=18'), linewidth=1, linetype='dotted') +
geom_step(data=EUR_two_epoch_demography_19, aes(EUR_two_epoch_Time_19, EUR_two_epoch_NEffective_19, color='N=19'), linewidth=1, linetype='dotted') +
scale_color_manual(name='Sample Size',
breaks=c('N=10', 'N=11', 'N=12', 'N=13', 'N=14', 'N=15', 'N=16', 'N=17', 'N=18', 'N=19'),
values=c('N=10'='#7f3b08',
'N=11'='#b35806',
'N=12'='#e08214',
'N=13'='#fdb863',
'N=14'='#fee0b6',
'N=15'='#d8daeb',
'N=16'='#b2abd2',
'N=17'='#8073ac',
'N=18'='#542788',
'N=19'='#2d004b')) +
theme_bw() +
ylab('Effective Population Size') +
xlab('Time in Years') +
ggtitle('1KG EUR two Epoch Demography (N=10-19:1)')
ggplot(EUR_two_epoch_demography_10, aes(EUR_two_epoch_Time_10, EUR_two_epoch_NEffective_10, color='N=10')) + geom_step(linewidth=1, linetype='dashed') +
geom_step(data=EUR_two_epoch_demography_11, aes(EUR_two_epoch_Time_11, EUR_two_epoch_NEffective_11, color='N=11'), linewidth=1, linetype='dashed') +
geom_step(data=EUR_two_epoch_demography_12, aes(EUR_two_epoch_Time_12, EUR_two_epoch_NEffective_12, color='N=12'), linewidth=1, linetype='dashed') +
geom_step(data=EUR_two_epoch_demography_13, aes(EUR_two_epoch_Time_13, EUR_two_epoch_NEffective_13, color='N=13'), linewidth=1, linetype='dashed') +
geom_step(data=EUR_two_epoch_demography_14, aes(EUR_two_epoch_Time_14, EUR_two_epoch_NEffective_14, color='N=14'), linewidth=1, linetype='dashed') +
geom_step(data=EUR_two_epoch_demography_15, aes(EUR_two_epoch_Time_15, EUR_two_epoch_NEffective_15, color='N=15'), linewidth=1, linetype='dashed') +
# geom_step(data=EUR_two_epoch_demography_16, aes(EUR_two_epoch_Time_16, EUR_two_epoch_NEffective_16, color='N=16'), linewidth=1, linetype='dashed') +
# geom_step(data=EUR_two_epoch_demography_17, aes(EUR_two_epoch_Time_17, EUR_two_epoch_NEffective_17, color='N=17'), linewidth=1, linetype='dashed') +
# geom_step(data=EUR_two_epoch_demography_18, aes(EUR_two_epoch_Time_18, EUR_two_epoch_NEffective_18, color='N=18'), linewidth=1, linetype='dashed') +
# geom_step(data=EUR_two_epoch_demography_19, aes(EUR_two_epoch_Time_19, EUR_two_epoch_NEffective_19, color='N=19'), linewidth=1, linetype='dashed') +
# geom_step(data=EUR_three_epoch_demography_10, aes(EUR_three_epoch_Time_10, EUR_three_epoch_NEffective_10, color='N=10'), linewidth=1, linetype='solid') +
# geom_step(data=EUR_three_epoch_demography_11, aes(EUR_three_epoch_Time_11, EUR_three_epoch_NEffective_11, color='N=11'), linewidth=1, linetype='solid') +
# geom_step(data=EUR_three_epoch_demography_12, aes(EUR_three_epoch_Time_12, EUR_three_epoch_NEffective_12, color='N=12'), linewidth=1, linetype='solid') +
# geom_step(data=EUR_three_epoch_demography_13, aes(EUR_three_epoch_Time_13, EUR_three_epoch_NEffective_13, color='N=13'), linewidth=1, linetype='solid') +
# geom_step(data=EUR_three_epoch_demography_14, aes(EUR_three_epoch_Time_14, EUR_three_epoch_NEffective_14, color='N=14'), linewidth=1, linetype='solid') +
# geom_step(data=EUR_three_epoch_demography_15, aes(EUR_three_epoch_Time_15, EUR_three_epoch_NEffective_15, color='N=15'), linewidth=1, linetype='solid') +
geom_step(data=EUR_three_epoch_demography_16, aes(EUR_three_epoch_Time_16, EUR_three_epoch_NEffective_16, color='N=16'), linewidth=1, linetype='solid') +
geom_step(data=EUR_three_epoch_demography_17, aes(EUR_three_epoch_Time_17, EUR_three_epoch_NEffective_17, color='N=17'), linewidth=1, linetype='solid') +
geom_step(data=EUR_three_epoch_demography_18, aes(EUR_three_epoch_Time_18, EUR_three_epoch_NEffective_18, color='N=18'), linewidth=1, linetype='solid') +
geom_step(data=EUR_three_epoch_demography_19, aes(EUR_three_epoch_Time_19, EUR_three_epoch_NEffective_19, color='N=19'), linewidth=1, linetype='solid') +
scale_color_manual(name='Sample Size',
breaks=c('N=10', 'N=11', 'N=12', 'N=13', 'N=14', 'N=15', 'N=16', 'N=17', 'N=18', 'N=19'),
values=c('N=10'='#7f3b08',
'N=11'='#b35806',
'N=12'='#e08214',
'N=13'='#fdb863',
'N=14'='#fee0b6',
'N=15'='#d8daeb',
'N=16'='#b2abd2',
'N=17'='#8073ac',
'N=18'='#542788',
'N=19'='#2d004b')) +
theme_bw() +
ylab('Effective Population Size') +
xlab('Time in Years') +
ggtitle('1KG EUR Best-fitting Demography (N=10-19:1)')
ggplot(EUR_three_epoch_demography_10, aes(EUR_three_epoch_Time_10, EUR_three_epoch_NEffective_10, color='N=10')) + geom_step(linewidth=1, linetype='solid') +
geom_step(data=EUR_three_epoch_demography_11, aes(EUR_three_epoch_Time_11, EUR_three_epoch_NEffective_11, color='N=11'), linewidth=1, linetype='solid') +
geom_step(data=EUR_three_epoch_demography_12, aes(EUR_three_epoch_Time_12, EUR_three_epoch_NEffective_12, color='N=12'), linewidth=1, linetype='solid') +
geom_step(data=EUR_three_epoch_demography_13, aes(EUR_three_epoch_Time_13, EUR_three_epoch_NEffective_13, color='N=13'), linewidth=1, linetype='solid') +
geom_step(data=EUR_three_epoch_demography_14, aes(EUR_three_epoch_Time_14, EUR_three_epoch_NEffective_14, color='N=14'), linewidth=1, linetype='solid') +
geom_step(data=EUR_three_epoch_demography_15, aes(EUR_three_epoch_Time_15, EUR_three_epoch_NEffective_15, color='N=15'), linewidth=1, linetype='solid') +
geom_step(data=EUR_three_epoch_demography_16, aes(EUR_three_epoch_Time_16, EUR_three_epoch_NEffective_16, color='N=16'), linewidth=1, linetype='solid') +
geom_step(data=EUR_three_epoch_demography_17, aes(EUR_three_epoch_Time_17, EUR_three_epoch_NEffective_17, color='N=17'), linewidth=1, linetype='solid') +
geom_step(data=EUR_three_epoch_demography_18, aes(EUR_three_epoch_Time_18, EUR_three_epoch_NEffective_18, color='N=18'), linewidth=1, linetype='solid') +
geom_step(data=EUR_three_epoch_demography_19, aes(EUR_three_epoch_Time_19, EUR_three_epoch_NEffective_19, color='N=19'), linewidth=1, linetype='solid') +
scale_color_manual(name='Sample Size',
breaks=c('N=10', 'N=11', 'N=12', 'N=13', 'N=14', 'N=15', 'N=16', 'N=17', 'N=18', 'N=19'),
values=c('N=10'='#7f3b08',
'N=11'='#b35806',
'N=12'='#e08214',
'N=13'='#fdb863',
'N=14'='#fee0b6',
'N=15'='#d8daeb',
'N=16'='#b2abd2',
'N=17'='#8073ac',
'N=18'='#542788',
'N=19'='#2d004b')) +
theme_bw() +
ylab('Effective Population Size') +
xlab('Time in Years') +
ggtitle('1KG EUR Three Epoch Demography (N=10-19:1)')
# ggplot(EUR_three_epoch_demography_11, aes(EUR_three_epoch_Time_11, EUR_three_epoch_NEffective_11)) + geom_step(color='#b35806', linewidth=1, linetype='solid') +
#   # geom_step(data=EUR_three_epoch_demography_11, aes(EUR_three_epoch_Time_11, EUR_three_epoch_NEffective_11), color='#b35806', linewidth=1, linetype='solid') +
#   geom_step(data=EUR_three_epoch_demography_12, aes(EUR_three_epoch_Time_12, EUR_three_epoch_NEffective_12), color='#e08214', linewidth=1, linetype='solid') +
#   geom_step(data=EUR_three_epoch_demography_13, aes(EUR_three_epoch_Time_13, EUR_three_epoch_NEffective_13), color='#fdb863', linewidth=1, linetype='solid') +
#   geom_step(data=EUR_three_epoch_demography_14, aes(EUR_three_epoch_Time_14, EUR_three_epoch_NEffective_14), color='#fee0b6', linewidth=1, linetype='solid') +
#   geom_step(data=EUR_three_epoch_demography_15, aes(EUR_three_epoch_Time_15, EUR_three_epoch_NEffective_15), color='#d8daeb', linewidth=1, linetype='solid') +
#   geom_step(data=EUR_three_epoch_demography_16, aes(EUR_three_epoch_Time_16, EUR_three_epoch_NEffective_16), color='#b2abd2', linewidth=1, linetype='solid') +
#   geom_step(data=EUR_three_epoch_demography_17, aes(EUR_three_epoch_Time_17, EUR_three_epoch_NEffective_17), color='#8073ac', linewidth=1, linetype='solid') +
#   geom_step(data=EUR_three_epoch_demography_18, aes(EUR_three_epoch_Time_18, EUR_three_epoch_NEffective_18), color='#542788', linewidth=1, linetype='solid') +
#   geom_step(data=EUR_three_epoch_demography_19, aes(EUR_three_epoch_Time_19, EUR_three_epoch_NEffective_19), color='#2d004b', linewidth=1, linetype='solid') +
#   theme_bw() +
#   ylab('Effective Population Size') +
#   xlab('Time in Years') +
#   ggtitle('1KG EUR Three Epoch Demography (N=10-19:1)')
# NAnc Estimate by Sample Size
sample_size = c(10, 11, 12, 13, 14, 15, 16, 17, 18, 19)
NAnc_df = data.frame(sample_size, EUR_one_epoch_NAnc, EUR_two_epoch_NAnc, EUR_three_epoch_NAnc)
NAnc_df = melt(NAnc_df, id='sample_size')
ggplot(data=NAnc_df, aes(x=sample_size, y=value, color=variable)) + geom_line() +
xlab('Sample size') +
ylab('Estimated ancestral effective population size') +
ggtitle('1KG EUR NAnc by sample size (N=10-19:1)') +
theme_bw() +
guides(color=guide_legend(title="Epoch")) +
scale_color_manual(
labels=c('One-epoch', 'Two-epoch', 'Three-epoch'),
values=c('red', 'blue', 'green')) +
geom_hline(yintercept=12378, color='black', linetype='dashed') +
scale_x_continuous(breaks=sample_size)
# Create the line plot with ggplot2
ggplot(EUR_df_long, aes(x = Index, y = AIC, color = Epoch)) +
geom_line() +
geom_point() +
labs(title = "1KG EUR AIC values by sample size (N=10-19:1)",
x = "Sample Size",
y = "AIC") +
scale_y_log10() +
scale_x_continuous(breaks=EUR_df_long$Index) +
scale_color_manual(values = c("blue", "green", "red"),
label=c('One-epoch', 'Three-epoch', 'Two-epoch')) +
theme_bw()
# Create the line plot with ggplot2
ggplot(EUR_df_long_lambda, aes(x = Index, y = Lambda, color = Full_vs_Null)) +
geom_line() +
geom_point() +
labs(title = "1KG EUR Lambda values by sample size (N=10-19:1)",
x = "Sample Size",
y = "2 * Lambda") +
# scale_y_log10() +
scale_x_continuous(breaks=EUR_df_long$Index) +
scale_color_manual(values = c("blue", "green", "red"),
label=c('Three vs. One', 'Three vs. Two', 'Two vs. One')) +
theme_bw()
# Create the line plot with ggplot2
ggplot(EUR_df_long_lambda, aes(x = Index, y = Lambda, color = Full_vs_Null)) +
geom_line() +
geom_point() +
labs(title = "1KG EUR Lambda values by sample size (N=10-19:1)",
x = "Sample Size",
y = "2 * Lambda") +
# scale_y_log10() +
scale_x_continuous(breaks=EUR_df_long$Index) +
scale_color_manual(values = c("blue", "green", "red"),
label=c('Three vs. One', 'Three vs. Two', 'Two vs. One')) +
theme_bw() +
ylim(-5, 10)
# Create the line plot with ggplot2
ggplot(EUR_df_long_lambda, aes(x = Index, y = Lambda, color = Full_vs_Null)) +
geom_line() +
geom_point() +
labs(title = "1KG EUR Lambda values by sample size (N=10-19:1)",
x = "Sample Size",
y = "2 * Lambda") +
# scale_y_log10() +
scale_x_continuous(breaks=EUR_df_long$Index) +
scale_color_manual(values = c("blue", "green", "red"),
label=c('Three vs. One', 'Three vs. Two', 'Two vs. One')) +
theme_bw()
# Create the line plot with ggplot2
ggplot(EUR_df_long_lambda, aes(x = Index, y = Lambda, color = Full_vs_Null)) +
geom_line() +
geom_point() +
labs(title = "1KG EUR Lambda values by sample size (N=10-19:1)",
x = "Sample Size",
y = "2 * Lambda") +
# scale_y_log10() +
scale_x_continuous(breaks=EUR_df_long$Index) +
scale_color_manual(values = c("blue", "green", "red"),
label=c('Three vs. One', 'Three vs. Two', 'Two vs. One')) +
theme_bw() +
ylim(-5, 10)
EUR_one_epoch_residual = c()
EUR_two_epoch_residual = c()
EUR_three_epoch_residual = c()
for (i in 1:10) {
EUR_one_epoch_residual = c(EUR_one_epoch_residual, compute_residual(unlist(EUR_empirical_file_list[i]), unlist(EUR_one_epoch_file_list[i])))
EUR_two_epoch_residual = c(EUR_two_epoch_residual, compute_residual(unlist(EUR_empirical_file_list[i]), unlist(EUR_two_epoch_file_list[i])))
EUR_three_epoch_residual = c(EUR_three_epoch_residual, compute_residual(unlist(EUR_empirical_file_list[i]), unlist(EUR_three_epoch_file_list[i])))
}
EUR_residual_df = data.frame(EUR_one_epoch_residual, EUR_two_epoch_residual, EUR_three_epoch_residual)
# Reshape the data from wide to long format
EUR_df_long_residual <- tidyr::gather(EUR_residual_df, key = "Epoch", value = "residual", EUR_one_epoch_residual:EUR_three_epoch_residual)
# Increase the x-axis index by 4
EUR_df_long_residual$Index <- rep(seq(10, 19, by = 1), times = 3)
# Create the line plot with ggplot2
ggplot(EUR_df_long_residual, aes(x = Index, y = residual, color = Epoch)) +
geom_line() +
geom_point() +
labs(title = "EUR residual values by sample size (N=10-19:1)",
x = "Sample Size",
y = "Residual") +
scale_y_log10() +
scale_x_continuous(breaks=EUR_df_long$Index) +
scale_color_manual(values = c("blue", "green", "red"),
label=c('One-epoch', 'Three-epoch', 'Two-epoch')) +
theme_bw()
ggplot(EUR_df_long, aes(x = Index, y = AIC, color = Epoch)) +
geom_line(linetype=3) +
geom_point() +
labs(title = "1KG EUR AIC and residual by sample size (N=10-19:1)",
x = "Sample Size",
y = "AIC") +
scale_y_log10(sec.axis = sec_axis(~.*1, name="Residual")) +
scale_x_continuous(breaks=EUR_df_long$Index) +
geom_line(data=EUR_df_long_residual, aes(x = Index, y = residual*1, color = Epoch)) +
scale_color_manual(values = c("blue", "orange", "green", "violet", "red", "seagreen"),
label=c('One-epoch AIC', 'One-epoch residual',
'Three-epoch AIC', 'Three-epoch residual',
'Two-epoch AIC', 'Two-epoch residual')) +
theme_bw()
EUR_mu = 1.5E-8
# NAnc = theta / (4 * allele_sum * mu)
# generations = 2 * tau * theta / (4 * mu * allele_sum)
# years = generations / 365
# NCurr = nu * NAnc
# generations_b = 2 * tauB * theta / (4 * mu * allele_sum)
# generations_f = 2 * tauF * theta / (4 * mu * allele_sum)
# NBottle = nuB * NAnc
# NSince = nuF * NAnc
EUR_one_epoch_NAnc = EUR_one_epoch_theta / (4 * EUR_one_epoch_allele_sum * EUR_mu)
EUR_two_epoch_NAnc = EUR_two_epoch_theta / (4 * EUR_two_epoch_allele_sum * EUR_mu)
EUR_two_epoch_NCurr = EUR_two_epoch_nu * EUR_two_epoch_NAnc
EUR_two_epoch_Time = 2 * 25 * EUR_two_epoch_tau * EUR_two_epoch_theta / (4 * EUR_mu * EUR_two_epoch_allele_sum)
EUR_three_epoch_NAnc = EUR_three_epoch_theta / (4 * EUR_three_epoch_allele_sum * EUR_mu)
EUR_three_epoch_NBottle = EUR_three_epoch_nuB * EUR_three_epoch_NAnc
EUR_three_epoch_NCurr = EUR_three_epoch_nuF * EUR_three_epoch_NAnc
EUR_three_epoch_TimeBottleEnd = 2 * 25 * EUR_three_epoch_tauF * EUR_three_epoch_theta / (4 * EUR_mu * EUR_three_epoch_allele_sum)
EUR_three_epoch_TimeBottleStart = 2 * 25 * EUR_three_epoch_tauB * EUR_three_epoch_theta / (4 * EUR_mu * EUR_three_epoch_allele_sum) + EUR_three_epoch_TimeBottleEnd
EUR_three_epoch_TimeTotal = EUR_three_epoch_TimeBottleStart + EUR_three_epoch_TimeBottleEnd
EUR_two_epoch_max_time = rep(1.25E6, 10)
# EUR_two_epoch_max_time = rep(2E4, 10)
EUR_two_epoch_current_time = rep(0, 10)
EUR_two_epoch_demography = data.frame(EUR_two_epoch_NAnc, EUR_two_epoch_max_time,
EUR_two_epoch_NCurr, EUR_two_epoch_Time,
EUR_two_epoch_NCurr, EUR_two_epoch_current_time)
# EUR_three_epoch_max_time = rep(100000000, 10)
# EUR_three_epoch_max_time = rep(5E6, 10)
EUR_three_epoch_max_time = rep(1.25E6, 10)
EUR_three_epoch_current_time = rep(0, 10)
EUR_three_epoch_demography = data.frame(EUR_three_epoch_NAnc, EUR_three_epoch_max_time,
EUR_three_epoch_NBottle, EUR_three_epoch_TimeBottleStart,
EUR_three_epoch_NCurr, EUR_three_epoch_TimeBottleEnd,
EUR_three_epoch_NCurr, EUR_three_epoch_current_time)
EUR_two_epoch_NEffective_10 = c(EUR_two_epoch_demography[1, 1], EUR_two_epoch_demography[1, 3], EUR_two_epoch_demography[1, 5])
EUR_two_epoch_Time_10 = c(-EUR_two_epoch_demography[1, 2], -EUR_two_epoch_demography[1, 4], EUR_two_epoch_demography[1, 6])
EUR_two_epoch_demography_10 = data.frame(EUR_two_epoch_Time_10, EUR_two_epoch_NEffective_10)
EUR_two_epoch_NEffective_11 = c(EUR_two_epoch_demography[2, 1], EUR_two_epoch_demography[2, 3], EUR_two_epoch_demography[2, 5])
EUR_two_epoch_Time_11 = c(-EUR_two_epoch_demography[2, 2], -EUR_two_epoch_demography[2, 4], EUR_two_epoch_demography[2, 6])
EUR_two_epoch_demography_11 = data.frame(EUR_two_epoch_Time_11, EUR_two_epoch_NEffective_11)
EUR_two_epoch_NEffective_12 = c(EUR_two_epoch_demography[3, 1], EUR_two_epoch_demography[3, 3], EUR_two_epoch_demography[3, 5])
EUR_two_epoch_Time_12 = c(-EUR_two_epoch_demography[3, 2], -EUR_two_epoch_demography[3, 4], EUR_two_epoch_demography[3, 6])
EUR_two_epoch_demography_12 = data.frame(EUR_two_epoch_Time_12, EUR_two_epoch_NEffective_12)
EUR_two_epoch_NEffective_13 = c(EUR_two_epoch_demography[4, 1], EUR_two_epoch_demography[4, 3], EUR_two_epoch_demography[4, 5])
EUR_two_epoch_Time_13 = c(-EUR_two_epoch_demography[4, 2], -EUR_two_epoch_demography[4, 4], EUR_two_epoch_demography[4, 6])
EUR_two_epoch_demography_13 = data.frame(EUR_two_epoch_Time_13, EUR_two_epoch_NEffective_13)
EUR_two_epoch_NEffective_14 = c(EUR_two_epoch_demography[5, 1], EUR_two_epoch_demography[5, 3], EUR_two_epoch_demography[5, 5])
EUR_two_epoch_Time_14 = c(-EUR_two_epoch_demography[5, 2], -EUR_two_epoch_demography[5, 4], EUR_two_epoch_demography[5, 6])
EUR_two_epoch_demography_14 = data.frame(EUR_two_epoch_Time_14, EUR_two_epoch_NEffective_14)
EUR_two_epoch_NEffective_15 = c(EUR_two_epoch_demography[6, 1], EUR_two_epoch_demography[6, 3], EUR_two_epoch_demography[6, 5])
EUR_two_epoch_Time_15 = c(-EUR_two_epoch_demography[6, 2], -EUR_two_epoch_demography[6, 4], EUR_two_epoch_demography[6, 6])
EUR_two_epoch_demography_15 = data.frame(EUR_two_epoch_Time_15, EUR_two_epoch_NEffective_15)
EUR_two_epoch_NEffective_16 = c(EUR_two_epoch_demography[7, 1], EUR_two_epoch_demography[7, 3], EUR_two_epoch_demography[7, 5])
EUR_two_epoch_Time_16 = c(-EUR_two_epoch_demography[7, 2], -EUR_two_epoch_demography[7, 4], EUR_two_epoch_demography[7, 6])
EUR_two_epoch_demography_16 = data.frame(EUR_two_epoch_Time_16, EUR_two_epoch_NEffective_16)
EUR_two_epoch_NEffective_17 = c(EUR_two_epoch_demography[8, 1], EUR_two_epoch_demography[8, 3], EUR_two_epoch_demography[8, 5])
EUR_two_epoch_Time_17 = c(-EUR_two_epoch_demography[8, 2], -EUR_two_epoch_demography[8, 4], EUR_two_epoch_demography[8, 6])
EUR_two_epoch_demography_17 = data.frame(EUR_two_epoch_Time_17, EUR_two_epoch_NEffective_17)
EUR_two_epoch_NEffective_18 = c(EUR_two_epoch_demography[9, 1], EUR_two_epoch_demography[9, 3], EUR_two_epoch_demography[9, 5])
EUR_two_epoch_Time_18 = c(-EUR_two_epoch_demography[9, 2], -EUR_two_epoch_demography[9, 4], EUR_two_epoch_demography[9, 6])
EUR_two_epoch_demography_18 = data.frame(EUR_two_epoch_Time_18, EUR_two_epoch_NEffective_18)
EUR_two_epoch_NEffective_19 = c(EUR_two_epoch_demography[10, 1], EUR_two_epoch_demography[10, 3], EUR_two_epoch_demography[10, 5])
EUR_two_epoch_Time_19 = c(-EUR_two_epoch_demography[10, 2], -EUR_two_epoch_demography[10, 4], EUR_two_epoch_demography[10, 6])
EUR_two_epoch_demography_19 = data.frame(EUR_two_epoch_Time_19, EUR_two_epoch_NEffective_19)
EUR_three_epoch_NEffective_10 = c(EUR_three_epoch_demography[1, 1], EUR_three_epoch_demography[1, 3], EUR_three_epoch_demography[1, 5], EUR_three_epoch_demography[1, 7])
EUR_three_epoch_Time_10 = c(-EUR_three_epoch_demography[1, 2], -EUR_three_epoch_demography[1, 4], -EUR_three_epoch_demography[1, 6], EUR_three_epoch_demography[1, 8])
EUR_three_epoch_demography_10 = data.frame(EUR_three_epoch_Time_10, EUR_three_epoch_NEffective_10)
EUR_three_epoch_NEffective_11 = c(EUR_three_epoch_demography[2, 1], EUR_three_epoch_demography[2, 3], EUR_three_epoch_demography[2, 5], EUR_three_epoch_demography[2, 7])
EUR_three_epoch_Time_11 = c(-EUR_three_epoch_demography[2, 2], -EUR_three_epoch_demography[2, 4], -EUR_three_epoch_demography[2, 6], EUR_three_epoch_demography[2, 8])
EUR_three_epoch_demography_11 = data.frame(EUR_three_epoch_Time_11, EUR_three_epoch_NEffective_11)
EUR_three_epoch_NEffective_12 = c(EUR_three_epoch_demography[3, 1], EUR_three_epoch_demography[3, 3], EUR_three_epoch_demography[3, 5], EUR_three_epoch_demography[3, 7])
EUR_three_epoch_Time_12 = c(-EUR_three_epoch_demography[3, 2], -EUR_three_epoch_demography[3, 4], -EUR_three_epoch_demography[3, 6], EUR_three_epoch_demography[3, 8])
EUR_three_epoch_demography_12 = data.frame(EUR_three_epoch_Time_12, EUR_three_epoch_NEffective_12)
EUR_three_epoch_NEffective_13 = c(EUR_three_epoch_demography[4, 1], EUR_three_epoch_demography[4, 3], EUR_three_epoch_demography[4, 5], EUR_three_epoch_demography[4, 7])
EUR_three_epoch_Time_13 = c(-EUR_three_epoch_demography[4, 2], -EUR_three_epoch_demography[4, 4], -EUR_three_epoch_demography[4, 6], EUR_three_epoch_demography[4, 8])
EUR_three_epoch_demography_13 = data.frame(EUR_three_epoch_Time_13, EUR_three_epoch_NEffective_13)
EUR_three_epoch_NEffective_14 = c(EUR_three_epoch_demography[5, 1], EUR_three_epoch_demography[5, 3], EUR_three_epoch_demography[5, 5], EUR_three_epoch_demography[5, 7])
EUR_three_epoch_Time_14 = c(-EUR_three_epoch_demography[5, 2], -EUR_three_epoch_demography[5, 4], -EUR_three_epoch_demography[5, 6], EUR_three_epoch_demography[5, 8])
EUR_three_epoch_demography_14 = data.frame(EUR_three_epoch_Time_14, EUR_three_epoch_NEffective_14)
EUR_three_epoch_NEffective_15 = c(EUR_three_epoch_demography[6, 1], EUR_three_epoch_demography[6, 3], EUR_three_epoch_demography[6, 5], EUR_three_epoch_demography[6, 7])
EUR_three_epoch_Time_15 = c(-EUR_three_epoch_demography[6, 2], -EUR_three_epoch_demography[6, 4], -EUR_three_epoch_demography[6, 6], EUR_three_epoch_demography[6, 8])
EUR_three_epoch_demography_15 = data.frame(EUR_three_epoch_Time_15, EUR_three_epoch_NEffective_15)
EUR_three_epoch_NEffective_16 = c(EUR_three_epoch_demography[7, 1], EUR_three_epoch_demography[7, 3], EUR_three_epoch_demography[7, 5], EUR_three_epoch_demography[7, 7])
EUR_three_epoch_Time_16 = c(-EUR_three_epoch_demography[7, 2], -EUR_three_epoch_demography[7, 4], -EUR_three_epoch_demography[7, 6], EUR_three_epoch_demography[7, 8])
EUR_three_epoch_demography_16 = data.frame(EUR_three_epoch_Time_16, EUR_three_epoch_NEffective_16)
EUR_three_epoch_NEffective_17 = c(EUR_three_epoch_demography[8, 1], EUR_three_epoch_demography[8, 3], EUR_three_epoch_demography[8, 5], EUR_three_epoch_demography[8, 7])
EUR_three_epoch_Time_17 = c(-EUR_three_epoch_demography[8, 2], -EUR_three_epoch_demography[8, 4], -EUR_three_epoch_demography[8, 6], EUR_three_epoch_demography[8, 8])
EUR_three_epoch_demography_17 = data.frame(EUR_three_epoch_Time_17, EUR_three_epoch_NEffective_17)
EUR_three_epoch_NEffective_18 = c(EUR_three_epoch_demography[9, 1], EUR_three_epoch_demography[9, 3], EUR_three_epoch_demography[9, 5], EUR_three_epoch_demography[9, 7])
EUR_three_epoch_Time_18 = c(-EUR_three_epoch_demography[9, 2], -EUR_three_epoch_demography[9, 4], -EUR_three_epoch_demography[9, 6], EUR_three_epoch_demography[9, 8])
EUR_three_epoch_demography_18 = data.frame(EUR_three_epoch_Time_18, EUR_three_epoch_NEffective_18)
EUR_three_epoch_NEffective_19 = c(EUR_three_epoch_demography[10, 1], EUR_three_epoch_demography[10, 3], EUR_three_epoch_demography[10, 5], EUR_three_epoch_demography[10, 7])
EUR_three_epoch_Time_19 = c(-EUR_three_epoch_demography[10, 2], -EUR_three_epoch_demography[10, 4], -EUR_three_epoch_demography[10, 6], EUR_three_epoch_demography[10, 8])
EUR_three_epoch_demography_19 = data.frame(EUR_three_epoch_Time_19, EUR_three_epoch_NEffective_19)
ggplot(EUR_two_epoch_demography_10, aes(EUR_two_epoch_Time_10, EUR_two_epoch_NEffective_10, color='N=10')) + geom_step(linewidth=1, linetype='dotted') +
geom_step(data=EUR_two_epoch_demography_11, aes(EUR_two_epoch_Time_11, EUR_two_epoch_NEffective_11, color='N=11'), linewidth=1, linetype='dotted') +
geom_step(data=EUR_two_epoch_demography_12, aes(EUR_two_epoch_Time_12, EUR_two_epoch_NEffective_12, color='N=12'), linewidth=1, linetype='dotted') +
geom_step(data=EUR_two_epoch_demography_13, aes(EUR_two_epoch_Time_13, EUR_two_epoch_NEffective_13, color='N=13'), linewidth=1, linetype='dotted') +
geom_step(data=EUR_two_epoch_demography_14, aes(EUR_two_epoch_Time_14, EUR_two_epoch_NEffective_14, color='N=14'), linewidth=1, linetype='dotted') +
geom_step(data=EUR_two_epoch_demography_15, aes(EUR_two_epoch_Time_15, EUR_two_epoch_NEffective_15, color='N=15'), linewidth=1, linetype='dotted') +
geom_step(data=EUR_two_epoch_demography_16, aes(EUR_two_epoch_Time_16, EUR_two_epoch_NEffective_16, color='N=16'), linewidth=1, linetype='dotted') +
geom_step(data=EUR_two_epoch_demography_17, aes(EUR_two_epoch_Time_17, EUR_two_epoch_NEffective_17, color='N=17'), linewidth=1, linetype='dotted') +
geom_step(data=EUR_two_epoch_demography_18, aes(EUR_two_epoch_Time_18, EUR_two_epoch_NEffective_18, color='N=18'), linewidth=1, linetype='dotted') +
geom_step(data=EUR_two_epoch_demography_19, aes(EUR_two_epoch_Time_19, EUR_two_epoch_NEffective_19, color='N=19'), linewidth=1, linetype='dotted') +
scale_color_manual(name='Sample Size',
breaks=c('N=10', 'N=11', 'N=12', 'N=13', 'N=14', 'N=15', 'N=16', 'N=17', 'N=18', 'N=19'),
values=c('N=10'='#7f3b08',
'N=11'='#b35806',
'N=12'='#e08214',
'N=13'='#fdb863',
'N=14'='#fee0b6',
'N=15'='#d8daeb',
'N=16'='#b2abd2',
'N=17'='#8073ac',
'N=18'='#542788',
'N=19'='#2d004b')) +
theme_bw() +
ylab('Effective Population Size') +
xlab('Time in Years') +
ggtitle('1KG EUR two Epoch Demography (N=10-19:1)')
ggplot(EUR_three_epoch_demography_10, aes(EUR_three_epoch_Time_10, EUR_three_epoch_NEffective_10, color='N=10')) + geom_step(linewidth=1, linetype='solid') +
geom_step(data=EUR_three_epoch_demography_11, aes(EUR_three_epoch_Time_11, EUR_three_epoch_NEffective_11, color='N=11'), linewidth=1, linetype='solid') +
geom_step(data=EUR_three_epoch_demography_12, aes(EUR_three_epoch_Time_12, EUR_three_epoch_NEffective_12, color='N=12'), linewidth=1, linetype='solid') +
geom_step(data=EUR_three_epoch_demography_13, aes(EUR_three_epoch_Time_13, EUR_three_epoch_NEffective_13, color='N=13'), linewidth=1, linetype='solid') +
geom_step(data=EUR_three_epoch_demography_14, aes(EUR_three_epoch_Time_14, EUR_three_epoch_NEffective_14, color='N=14'), linewidth=1, linetype='solid') +
geom_step(data=EUR_three_epoch_demography_15, aes(EUR_three_epoch_Time_15, EUR_three_epoch_NEffective_15, color='N=15'), linewidth=1, linetype='solid') +
geom_step(data=EUR_three_epoch_demography_16, aes(EUR_three_epoch_Time_16, EUR_three_epoch_NEffective_16, color='N=16'), linewidth=1, linetype='solid') +
geom_step(data=EUR_three_epoch_demography_17, aes(EUR_three_epoch_Time_17, EUR_three_epoch_NEffective_17, color='N=17'), linewidth=1, linetype='solid') +
geom_step(data=EUR_three_epoch_demography_18, aes(EUR_three_epoch_Time_18, EUR_three_epoch_NEffective_18, color='N=18'), linewidth=1, linetype='solid') +
geom_step(data=EUR_three_epoch_demography_19, aes(EUR_three_epoch_Time_19, EUR_three_epoch_NEffective_19, color='N=19'), linewidth=1, linetype='solid') +
scale_color_manual(name='Sample Size',
breaks=c('N=10', 'N=11', 'N=12', 'N=13', 'N=14', 'N=15', 'N=16', 'N=17', 'N=18', 'N=19'),
values=c('N=10'='#7f3b08',
'N=11'='#b35806',
'N=12'='#e08214',
'N=13'='#fdb863',
'N=14'='#fee0b6',
'N=15'='#d8daeb',
'N=16'='#b2abd2',
'N=17'='#8073ac',
'N=18'='#542788',
'N=19'='#2d004b')) +
theme_bw() +
ylab('Effective Population Size') +
xlab('Time in Years') +
ggtitle('1KG EUR Three Epoch Demography (N=10-19:1)')
ggplot(EUR_two_epoch_demography_10, aes(EUR_two_epoch_Time_10, EUR_two_epoch_NEffective_10, color='N=10')) + geom_step(linewidth=1, linetype='dashed') +
geom_step(data=EUR_two_epoch_demography_11, aes(EUR_two_epoch_Time_11, EUR_two_epoch_NEffective_11, color='N=11'), linewidth=1, linetype='dashed') +
geom_step(data=EUR_two_epoch_demography_12, aes(EUR_two_epoch_Time_12, EUR_two_epoch_NEffective_12, color='N=12'), linewidth=1, linetype='dashed') +
geom_step(data=EUR_two_epoch_demography_13, aes(EUR_two_epoch_Time_13, EUR_two_epoch_NEffective_13, color='N=13'), linewidth=1, linetype='dashed') +
geom_step(data=EUR_two_epoch_demography_14, aes(EUR_two_epoch_Time_14, EUR_two_epoch_NEffective_14, color='N=14'), linewidth=1, linetype='dashed') +
geom_step(data=EUR_two_epoch_demography_15, aes(EUR_two_epoch_Time_15, EUR_two_epoch_NEffective_15, color='N=15'), linewidth=1, linetype='dashed') +
# geom_step(data=EUR_two_epoch_demography_16, aes(EUR_two_epoch_Time_16, EUR_two_epoch_NEffective_16, color='N=16'), linewidth=1, linetype='dashed') +
# geom_step(data=EUR_two_epoch_demography_17, aes(EUR_two_epoch_Time_17, EUR_two_epoch_NEffective_17, color='N=17'), linewidth=1, linetype='dashed') +
# geom_step(data=EUR_two_epoch_demography_18, aes(EUR_two_epoch_Time_18, EUR_two_epoch_NEffective_18, color='N=18'), linewidth=1, linetype='dashed') +
# geom_step(data=EUR_two_epoch_demography_19, aes(EUR_two_epoch_Time_19, EUR_two_epoch_NEffective_19, color='N=19'), linewidth=1, linetype='dashed') +
# geom_step(data=EUR_three_epoch_demography_10, aes(EUR_three_epoch_Time_10, EUR_three_epoch_NEffective_10, color='N=10'), linewidth=1, linetype='solid') +
# geom_step(data=EUR_three_epoch_demography_11, aes(EUR_three_epoch_Time_11, EUR_three_epoch_NEffective_11, color='N=11'), linewidth=1, linetype='solid') +
# geom_step(data=EUR_three_epoch_demography_12, aes(EUR_three_epoch_Time_12, EUR_three_epoch_NEffective_12, color='N=12'), linewidth=1, linetype='solid') +
# geom_step(data=EUR_three_epoch_demography_13, aes(EUR_three_epoch_Time_13, EUR_three_epoch_NEffective_13, color='N=13'), linewidth=1, linetype='solid') +
# geom_step(data=EUR_three_epoch_demography_14, aes(EUR_three_epoch_Time_14, EUR_three_epoch_NEffective_14, color='N=14'), linewidth=1, linetype='solid') +
# geom_step(data=EUR_three_epoch_demography_15, aes(EUR_three_epoch_Time_15, EUR_three_epoch_NEffective_15, color='N=15'), linewidth=1, linetype='solid') +
geom_step(data=EUR_three_epoch_demography_16, aes(EUR_three_epoch_Time_16, EUR_three_epoch_NEffective_16, color='N=16'), linewidth=1, linetype='solid') +
geom_step(data=EUR_three_epoch_demography_17, aes(EUR_three_epoch_Time_17, EUR_three_epoch_NEffective_17, color='N=17'), linewidth=1, linetype='solid') +
geom_step(data=EUR_three_epoch_demography_18, aes(EUR_three_epoch_Time_18, EUR_three_epoch_NEffective_18, color='N=18'), linewidth=1, linetype='solid') +
geom_step(data=EUR_three_epoch_demography_19, aes(EUR_three_epoch_Time_19, EUR_three_epoch_NEffective_19, color='N=19'), linewidth=1, linetype='solid') +
scale_color_manual(name='Sample Size',
breaks=c('N=10', 'N=11', 'N=12', 'N=13', 'N=14', 'N=15', 'N=16', 'N=17', 'N=18', 'N=19'),
values=c('N=10'='#7f3b08',
'N=11'='#b35806',
'N=12'='#e08214',
'N=13'='#fdb863',
'N=14'='#fee0b6',
'N=15'='#d8daeb',
'N=16'='#b2abd2',
'N=17'='#8073ac',
'N=18'='#542788',
'N=19'='#2d004b')) +
theme_bw() +
ylab('Effective Population Size') +
xlab('Time in Years') +
ggtitle('1KG EUR Best-fitting Demography (N=10-19:1)')
