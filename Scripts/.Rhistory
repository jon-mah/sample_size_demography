ggtitle('Two Epoch Contraction, k=20') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_20_SFS, TwoEpochE_20_msprime_SFS,
TwoEpochE_20_dadi_projection_SFS, TwoEpochE_20_lynch_SFS) +
ggtitle('Two Epoch Expansion, k=20') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_20_SFS, ThreeEpochC_20_msprime_SFS,
ThreeEpochC_20_dadi_projection_SFS, ThreeEpochC_20_lynch_SFS) +
ggtitle('Three Epoch Contraction, k=20') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_20_SFS, ThreeEpochE_20_msprime_SFS,
ThreeEpochE_20_dadi_projection_SFS, ThreeEpochE_20_lynch_SFS) +
ggtitle('Three Epoch Expansion, k=20') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_20_SFS, ThreeEpochB_20_msprime_SFS,
ThreeEpochB_20_dadi_projection_SFS, ThreeEpochB_20_lynch_SFS) +
ggtitle('Three Epoch Bottleneck, k=20') +
plot_layout(nrow=3)
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_30_SFS, TwoEpochC_30_msprime_SFS,
TwoEpochC_30_dadi_projection_SFS, TwoEpochC_30_lynch_SFS) +
ggtitle('Two Epoch Contraction, k=30') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_30_SFS, TwoEpochE_30_msprime_SFS,
TwoEpochE_30_dadi_projection_SFS, TwoEpochE_30_lynch_SFS) +
ggtitle('Two Epoch Expansion, k=30') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_30_SFS, ThreeEpochC_30_msprime_SFS,
ThreeEpochC_30_dadi_projection_SFS, ThreeEpochC_30_lynch_SFS) +
ggtitle('Three Epoch Contraction, k=30') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_30_SFS, ThreeEpochE_30_msprime_SFS,
ThreeEpochE_30_dadi_projection_SFS, ThreeEpochE_30_lynch_SFS) +
ggtitle('Three Epoch Expansion, k=30') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_30_SFS, ThreeEpochB_30_msprime_SFS,
ThreeEpochB_30_dadi_projection_SFS, ThreeEpochB_30_lynch_SFS) +
ggtitle('Three Epoch Bottleneck, k=30') +
plot_layout(nrow=3)
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_40_SFS, TwoEpochC_40_msprime_SFS,
TwoEpochC_40_dadi_projection_SFS, TwoEpochC_40_lynch_SFS) +
ggtitle('Two Epoch Contraction, k=40') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_40_SFS, TwoEpochE_40_msprime_SFS,
TwoEpochE_40_dadi_projection_SFS, TwoEpochE_40_lynch_SFS) +
ggtitle('Two Epoch Expansion, k=40') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_40_SFS, ThreeEpochC_40_msprime_SFS,
ThreeEpochC_40_dadi_projection_SFS, ThreeEpochC_40_lynch_SFS) +
ggtitle('Three Epoch Contraction, k=40') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_40_SFS, ThreeEpochE_40_msprime_SFS,
ThreeEpochE_40_dadi_projection_SFS, ThreeEpochE_40_lynch_SFS) +
ggtitle('Three Epoch Expansion, k=40') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_40_SFS, ThreeEpochB_40_msprime_SFS,
ThreeEpochB_40_dadi_projection_SFS, ThreeEpochB_40_lynch_SFS) +
ggtitle('Three Epoch Bottleneck, k=40') +
plot_layout(nrow=3)
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_50_SFS, TwoEpochC_50_msprime_SFS,
TwoEpochC_50_dadi_projection_SFS, TwoEpochC_50_lynch_SFS) +
ggtitle('Two Epoch Contraction, k=50') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_50_SFS, TwoEpochE_50_msprime_SFS,
TwoEpochE_50_dadi_projection_SFS, TwoEpochE_50_lynch_SFS) +
ggtitle('Two Epoch Expansion, k=50') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_50_SFS, ThreeEpochC_50_msprime_SFS,
ThreeEpochC_50_dadi_projection_SFS, ThreeEpochC_50_lynch_SFS) +
ggtitle('Three Epoch Contraction, k=50') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_50_SFS, ThreeEpochE_50_msprime_SFS,
ThreeEpochE_50_dadi_projection_SFS, ThreeEpochE_50_lynch_SFS) +
ggtitle('Three Epoch Expansion, k=50') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_50_SFS, ThreeEpochB_50_msprime_SFS,
ThreeEpochB_50_dadi_projection_SFS, ThreeEpochB_50_lynch_SFS) +
ggtitle('Three Epoch Bottleneck, k=50') +
plot_layout(nrow=3)
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_60_SFS, TwoEpochC_60_msprime_SFS,
TwoEpochC_60_dadi_projection_SFS, TwoEpochC_60_lynch_SFS) +
ggtitle('Two Epoch Contraction, k=60') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_60_SFS, TwoEpochE_60_msprime_SFS,
TwoEpochE_60_dadi_projection_SFS, TwoEpochE_60_lynch_SFS) +
ggtitle('Two Epoch Expansion, k=60') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_60_SFS, ThreeEpochC_60_msprime_SFS,
ThreeEpochC_60_dadi_projection_SFS, ThreeEpochC_60_lynch_SFS) +
ggtitle('Three Epoch Contraction, k=60') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_60_SFS, ThreeEpochE_60_msprime_SFS,
ThreeEpochE_60_dadi_projection_SFS, ThreeEpochE_60_lynch_SFS) +
ggtitle('Three Epoch Expansion, k=60') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_60_SFS, ThreeEpochB_60_msprime_SFS,
ThreeEpochB_60_dadi_projection_SFS, ThreeEpochB_60_lynch_SFS) +
ggtitle('Three Epoch Bottleneck, k=60') +
plot_layout(nrow=3)
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_70_SFS, TwoEpochC_70_msprime_SFS,
TwoEpochC_70_dadi_projection_SFS, TwoEpochC_70_lynch_SFS) +
ggtitle('Two Epoch Contraction, k=70') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_70_SFS, TwoEpochE_70_msprime_SFS,
TwoEpochE_70_dadi_projection_SFS, TwoEpochE_70_lynch_SFS) +
ggtitle('Two Epoch Expansion, k=70') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_70_SFS, ThreeEpochC_70_msprime_SFS,
ThreeEpochC_70_dadi_projection_SFS, ThreeEpochC_70_lynch_SFS) +
ggtitle('Three Epoch Contraction, k=70') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_70_SFS, ThreeEpochE_70_msprime_SFS,
ThreeEpochE_70_dadi_projection_SFS, ThreeEpochE_70_lynch_SFS) +
ggtitle('Three Epoch Expansion, k=70') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_70_SFS, ThreeEpochB_70_msprime_SFS,
ThreeEpochB_70_dadi_projection_SFS, ThreeEpochB_70_lynch_SFS) +
ggtitle('Three Epoch Bottleneck, k=70') +
plot_layout(nrow=3)
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_80_SFS, TwoEpochC_80_msprime_SFS,
TwoEpochC_80_dadi_projection_SFS, TwoEpochC_80_lynch_SFS) +
ggtitle('Two Epoch Contraction, k=80') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_80_SFS, TwoEpochE_80_msprime_SFS,
TwoEpochE_80_dadi_projection_SFS, TwoEpochE_80_lynch_SFS) +
ggtitle('Two Epoch Expansion, k=80') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_80_SFS, ThreeEpochC_80_msprime_SFS,
ThreeEpochC_80_dadi_projection_SFS, ThreeEpochC_80_lynch_SFS) +
ggtitle('Three Epoch Contraction, k=80') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_80_SFS, ThreeEpochE_80_msprime_SFS,
ThreeEpochE_80_dadi_projection_SFS, ThreeEpochE_80_lynch_SFS) +
ggtitle('Three Epoch Expansion, k=80') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_80_SFS, ThreeEpochB_80_msprime_SFS,
ThreeEpochB_80_dadi_projection_SFS, ThreeEpochB_80_lynch_SFS) +
ggtitle('Three Epoch Bottleneck, k=80') +
plot_layout(nrow=3)
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_90_SFS, TwoEpochC_90_msprime_SFS,
TwoEpochC_90_dadi_projection_SFS, TwoEpochC_90_lynch_SFS) +
ggtitle('Two Epoch Contraction, k=90') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_90_SFS, TwoEpochE_90_msprime_SFS,
TwoEpochE_90_dadi_projection_SFS, TwoEpochE_90_lynch_SFS) +
ggtitle('Two Epoch Expansion, k=90') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_90_SFS, ThreeEpochC_90_msprime_SFS,
ThreeEpochC_90_dadi_projection_SFS, ThreeEpochC_90_lynch_SFS) +
ggtitle('Three Epoch Contraction, k=90') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_90_SFS, ThreeEpochE_90_msprime_SFS,
ThreeEpochE_90_dadi_projection_SFS, ThreeEpochE_90_lynch_SFS) +
ggtitle('Three Epoch Expansion, k=90') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_90_SFS, ThreeEpochB_90_msprime_SFS,
ThreeEpochB_90_dadi_projection_SFS, ThreeEpochB_90_lynch_SFS) +
ggtitle('Three Epoch Bottleneck, k=90') +
plot_layout(nrow=3)
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_100_SFS, TwoEpochC_100_msprime_SFS,
TwoEpochC_100_dadi_projection_SFS, TwoEpochC_100_lynch_SFS) +
ggtitle('Two Epoch Contraction, k=100') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_100_SFS, TwoEpochE_100_msprime_SFS,
TwoEpochE_100_dadi_projection_SFS, TwoEpochE_100_lynch_SFS) +
ggtitle('Two Epoch Expansion, k=100') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_100_SFS, ThreeEpochC_100_msprime_SFS,
ThreeEpochC_100_dadi_projection_SFS, ThreeEpochC_100_lynch_SFS) +
ggtitle('Three Epoch Contraction, k=100') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_100_SFS, ThreeEpochE_100_msprime_SFS,
ThreeEpochE_100_dadi_projection_SFS, ThreeEpochE_100_lynch_SFS) +
ggtitle('Three Epoch Expansion, k=100') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_100_SFS, ThreeEpochB_100_msprime_SFS,
ThreeEpochB_100_dadi_projection_SFS, ThreeEpochB_100_lynch_SFS) +
ggtitle('Three Epoch Bottleneck, k=100') +
plot_layout(nrow=3)
compare_msprime_dadi_lynch_count_sfs(one_epoch_10_SFS, TwoEpochC_10_msprime_SFS,
TwoEpochC_10_dadi_projection_SFS, TwoEpochC_10_lynch_SFS) +
ggtitle('Two Epoch Contraction, k=10') +
compare_msprime_dadi_lynch_count_sfs(one_epoch_10_SFS, TwoEpochE_10_msprime_SFS,
TwoEpochE_10_dadi_projection_SFS, TwoEpochE_10_lynch_SFS) +
ggtitle('Two Epoch Expansion, k=10') +
compare_msprime_dadi_lynch_count_sfs(one_epoch_10_SFS, ThreeEpochC_10_msprime_SFS,
ThreeEpochC_10_dadi_projection_SFS, ThreeEpochC_10_lynch_SFS) +
ggtitle('Three Epoch Contraction, k=10') +
compare_msprime_dadi_lynch_count_sfs(one_epoch_10_SFS, ThreeEpochE_10_msprime_SFS,
ThreeEpochE_10_dadi_projection_SFS, ThreeEpochE_10_lynch_SFS) +
ggtitle('Three Epoch Expansion, k=10') +
compare_msprime_dadi_lynch_count_sfs(one_epoch_10_SFS, ThreeEpochB_10_msprime_SFS,
ThreeEpochB_10_dadi_projection_SFS, ThreeEpochB_10_lynch_SFS) +
ggtitle('Three Epoch Bottleneck, k=10') +
plot_layout(nrow=3)
compare_msprime_dadi_lynch_count_sfs = function(null, msprime, dadi, lynch) {
if (length(msprime) > 10) {
x_axis = 1:10
null = null[1:10] * 5
msprime = msprime[1:10]
dadi = dadi[1:10]
lynch = lynch[1:10] * 4 * 100000000 * 1.5E-8
} else {
x_axis = 1:length(msprime)
null = null * 5
msprime = msprime
dadi = dadi
lynch = lynch * 4 * 100000000 * 1.5E-8
}
input_df = data.frame(null,
msprime,
dadi,
lynch,
x_axis)
names(input_df) = c('SNM',
'MSPrime',
'Dadi projection',
'Lynch Theoretical',
'x_axis')
p_input_comparison <- ggplot(data = melt(input_df, id='x_axis'),
aes(x=x_axis,
y=value,
fill=variable)) +
geom_bar(position='dodge2', stat='identity') +
labs(x = "", fill = "") +
scale_x_continuous(name='Minor allele frequency in sample', breaks=x_axis, limits=c(0.5, length(x_axis) + 0.5)) +
ylab('Count of segregating sites') +
theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
return(p_input_comparison)
}
compare_msprime_dadi_lynch_count_sfs(one_epoch_10_SFS, TwoEpochC_10_msprime_SFS,
TwoEpochC_10_dadi_projection_SFS, TwoEpochC_10_lynch_SFS) +
ggtitle('Two Epoch Contraction, k=10') +
compare_msprime_dadi_lynch_count_sfs(one_epoch_10_SFS, TwoEpochE_10_msprime_SFS,
TwoEpochE_10_dadi_projection_SFS, TwoEpochE_10_lynch_SFS) +
ggtitle('Two Epoch Expansion, k=10') +
compare_msprime_dadi_lynch_count_sfs(one_epoch_10_SFS, ThreeEpochC_10_msprime_SFS,
ThreeEpochC_10_dadi_projection_SFS, ThreeEpochC_10_lynch_SFS) +
ggtitle('Three Epoch Contraction, k=10') +
compare_msprime_dadi_lynch_count_sfs(one_epoch_10_SFS, ThreeEpochE_10_msprime_SFS,
ThreeEpochE_10_dadi_projection_SFS, ThreeEpochE_10_lynch_SFS) +
ggtitle('Three Epoch Expansion, k=10') +
compare_msprime_dadi_lynch_count_sfs(one_epoch_10_SFS, ThreeEpochB_10_msprime_SFS,
ThreeEpochB_10_dadi_projection_SFS, ThreeEpochB_10_lynch_SFS) +
ggtitle('Three Epoch Bottleneck, k=10') +
plot_layout(nrow=3)
compare_msprime_dadi_lynch_count_sfs(one_epoch_20_SFS, TwoEpochC_20_msprime_SFS,
TwoEpochC_20_dadi_projection_SFS, TwoEpochC_20_lynch_SFS) +
ggtitle('Two Epoch Contraction, k=20') +
compare_msprime_dadi_lynch_count_sfs(one_epoch_20_SFS, TwoEpochE_20_msprime_SFS,
TwoEpochE_20_dadi_projection_SFS, TwoEpochE_20_lynch_SFS) +
ggtitle('Two Epoch Expansion, k=20') +
compare_msprime_dadi_lynch_count_sfs(one_epoch_20_SFS, ThreeEpochC_20_msprime_SFS,
ThreeEpochC_20_dadi_projection_SFS, ThreeEpochC_20_lynch_SFS) +
ggtitle('Three Epoch Contraction, k=20') +
compare_msprime_dadi_lynch_count_sfs(one_epoch_20_SFS, ThreeEpochE_20_msprime_SFS,
ThreeEpochE_20_dadi_projection_SFS, ThreeEpochE_20_lynch_SFS) +
ggtitle('Three Epoch Expansion, k=20') +
compare_msprime_dadi_lynch_count_sfs(one_epoch_20_SFS, ThreeEpochB_20_msprime_SFS,
ThreeEpochB_20_dadi_projection_SFS, ThreeEpochB_20_lynch_SFS) +
ggtitle('Three Epoch Bottleneck, k=20') +
plot_layout(nrow=3)
compare_msprime_dadi_lynch_count_sfs(one_epoch_30_SFS, TwoEpochC_30_msprime_SFS,
TwoEpochC_30_dadi_projection_SFS, TwoEpochC_30_lynch_SFS) +
ggtitle('Two Epoch Contraction, k=30') +
compare_msprime_dadi_lynch_count_sfs(one_epoch_30_SFS, TwoEpochE_30_msprime_SFS,
TwoEpochE_30_dadi_projection_SFS, TwoEpochE_30_lynch_SFS) +
ggtitle('Two Epoch Expansion, k=30') +
compare_msprime_dadi_lynch_count_sfs(one_epoch_30_SFS, ThreeEpochC_30_msprime_SFS,
ThreeEpochC_30_dadi_projection_SFS, ThreeEpochC_30_lynch_SFS) +
ggtitle('Three Epoch Contraction, k=30') +
compare_msprime_dadi_lynch_count_sfs(one_epoch_30_SFS, ThreeEpochE_30_msprime_SFS,
ThreeEpochE_30_dadi_projection_SFS, ThreeEpochE_30_lynch_SFS) +
ggtitle('Three Epoch Expansion, k=30') +
compare_msprime_dadi_lynch_count_sfs(one_epoch_30_SFS, ThreeEpochB_30_msprime_SFS,
ThreeEpochB_30_dadi_projection_SFS, ThreeEpochB_30_lynch_SFS) +
ggtitle('Three Epoch Bottleneck, k=30') +
plot_layout(nrow=3)
compare_msprime_dadi_lynch_count_sfs(one_epoch_40_SFS, TwoEpochC_40_msprime_SFS,
TwoEpochC_40_dadi_projection_SFS, TwoEpochC_40_lynch_SFS) +
ggtitle('Two Epoch Contraction, k=40') +
compare_msprime_dadi_lynch_count_sfs(one_epoch_40_SFS, TwoEpochE_40_msprime_SFS,
TwoEpochE_40_dadi_projection_SFS, TwoEpochE_40_lynch_SFS) +
ggtitle('Two Epoch Expansion, k=40') +
compare_msprime_dadi_lynch_count_sfs(one_epoch_40_SFS, ThreeEpochC_40_msprime_SFS,
ThreeEpochC_40_dadi_projection_SFS, ThreeEpochC_40_lynch_SFS) +
ggtitle('Three Epoch Contraction, k=40') +
compare_msprime_dadi_lynch_count_sfs(one_epoch_40_SFS, ThreeEpochE_40_msprime_SFS,
ThreeEpochE_40_dadi_projection_SFS, ThreeEpochE_40_lynch_SFS) +
ggtitle('Three Epoch Expansion, k=40') +
compare_msprime_dadi_lynch_count_sfs(one_epoch_40_SFS, ThreeEpochB_40_msprime_SFS,
ThreeEpochB_40_dadi_projection_SFS, ThreeEpochB_40_lynch_SFS) +
ggtitle('Three Epoch Bottleneck, k=40') +
plot_layout(nrow=3)
compare_msprime_dadi_lynch_count_sfs(one_epoch_50_SFS, TwoEpochC_50_msprime_SFS,
TwoEpochC_50_dadi_projection_SFS, TwoEpochC_50_lynch_SFS) +
ggtitle('Two Epoch Contraction, k=50') +
compare_msprime_dadi_lynch_count_sfs(one_epoch_50_SFS, TwoEpochE_50_msprime_SFS,
TwoEpochE_50_dadi_projection_SFS, TwoEpochE_50_lynch_SFS) +
ggtitle('Two Epoch Expansion, k=50') +
compare_msprime_dadi_lynch_count_sfs(one_epoch_50_SFS, ThreeEpochC_50_msprime_SFS,
ThreeEpochC_50_dadi_projection_SFS, ThreeEpochC_50_lynch_SFS) +
ggtitle('Three Epoch Contraction, k=50') +
compare_msprime_dadi_lynch_count_sfs(one_epoch_50_SFS, ThreeEpochE_50_msprime_SFS,
ThreeEpochE_50_dadi_projection_SFS, ThreeEpochE_50_lynch_SFS) +
ggtitle('Three Epoch Expansion, k=50') +
compare_msprime_dadi_lynch_count_sfs(one_epoch_50_SFS, ThreeEpochB_50_msprime_SFS,
ThreeEpochB_50_dadi_projection_SFS, ThreeEpochB_50_lynch_SFS) +
ggtitle('Three Epoch Bottleneck, k=50') +
plot_layout(nrow=3)
compare_msprime_dadi_lynch_count_sfs(one_epoch_60_SFS, TwoEpochC_60_msprime_SFS,
TwoEpochC_60_dadi_projection_SFS, TwoEpochC_60_lynch_SFS) +
ggtitle('Two Epoch Contraction, k=60') +
compare_msprime_dadi_lynch_count_sfs(one_epoch_60_SFS, TwoEpochE_60_msprime_SFS,
TwoEpochE_60_dadi_projection_SFS, TwoEpochE_60_lynch_SFS) +
ggtitle('Two Epoch Expansion, k=60') +
compare_msprime_dadi_lynch_count_sfs(one_epoch_60_SFS, ThreeEpochC_60_msprime_SFS,
ThreeEpochC_60_dadi_projection_SFS, ThreeEpochC_60_lynch_SFS) +
ggtitle('Three Epoch Contraction, k=60') +
compare_msprime_dadi_lynch_count_sfs(one_epoch_60_SFS, ThreeEpochE_60_msprime_SFS,
ThreeEpochE_60_dadi_projection_SFS, ThreeEpochE_60_lynch_SFS) +
ggtitle('Three Epoch Expansion, k=60') +
compare_msprime_dadi_lynch_count_sfs(one_epoch_60_SFS, ThreeEpochB_60_msprime_SFS,
ThreeEpochB_60_dadi_projection_SFS, ThreeEpochB_60_lynch_SFS) +
ggtitle('Three Epoch Bottleneck, k=60') +
plot_layout(nrow=3)
compare_msprime_dadi_lynch_count_sfs(one_epoch_70_SFS, TwoEpochC_70_msprime_SFS,
TwoEpochC_70_dadi_projection_SFS, TwoEpochC_70_lynch_SFS) +
ggtitle('Two Epoch Contraction, k=70') +
compare_msprime_dadi_lynch_count_sfs(one_epoch_70_SFS, TwoEpochE_70_msprime_SFS,
TwoEpochE_70_dadi_projection_SFS, TwoEpochE_70_lynch_SFS) +
ggtitle('Two Epoch Expansion, k=70') +
compare_msprime_dadi_lynch_count_sfs(one_epoch_70_SFS, ThreeEpochC_70_msprime_SFS,
ThreeEpochC_70_dadi_projection_SFS, ThreeEpochC_70_lynch_SFS) +
ggtitle('Three Epoch Contraction, k=70') +
compare_msprime_dadi_lynch_count_sfs(one_epoch_70_SFS, ThreeEpochE_70_msprime_SFS,
ThreeEpochE_70_dadi_projection_SFS, ThreeEpochE_70_lynch_SFS) +
ggtitle('Three Epoch Expansion, k=70') +
compare_msprime_dadi_lynch_count_sfs(one_epoch_70_SFS, ThreeEpochB_70_msprime_SFS,
ThreeEpochB_70_dadi_projection_SFS, ThreeEpochB_70_lynch_SFS) +
ggtitle('Three Epoch Bottleneck, k=70') +
plot_layout(nrow=3)
compare_msprime_dadi_lynch_count_sfs(one_epoch_80_SFS, TwoEpochC_80_msprime_SFS,
TwoEpochC_80_dadi_projection_SFS, TwoEpochC_80_lynch_SFS) +
ggtitle('Two Epoch Contraction, k=80') +
compare_msprime_dadi_lynch_count_sfs(one_epoch_80_SFS, TwoEpochE_80_msprime_SFS,
TwoEpochE_80_dadi_projection_SFS, TwoEpochE_80_lynch_SFS) +
ggtitle('Two Epoch Expansion, k=80') +
compare_msprime_dadi_lynch_count_sfs(one_epoch_80_SFS, ThreeEpochC_80_msprime_SFS,
ThreeEpochC_80_dadi_projection_SFS, ThreeEpochC_80_lynch_SFS) +
ggtitle('Three Epoch Contraction, k=80') +
compare_msprime_dadi_lynch_count_sfs(one_epoch_80_SFS, ThreeEpochE_80_msprime_SFS,
ThreeEpochE_80_dadi_projection_SFS, ThreeEpochE_80_lynch_SFS) +
ggtitle('Three Epoch Expansion, k=80') +
compare_msprime_dadi_lynch_count_sfs(one_epoch_80_SFS, ThreeEpochB_80_msprime_SFS,
ThreeEpochB_80_dadi_projection_SFS, ThreeEpochB_80_lynch_SFS) +
ggtitle('Three Epoch Bottleneck, k=80') +
plot_layout(nrow=3)
compare_msprime_dadi_lynch_count_sfs(one_epoch_90_SFS, TwoEpochC_90_msprime_SFS,
TwoEpochC_90_dadi_projection_SFS, TwoEpochC_90_lynch_SFS) +
ggtitle('Two Epoch Contraction, k=90') +
compare_msprime_dadi_lynch_count_sfs(one_epoch_90_SFS, TwoEpochE_90_msprime_SFS,
TwoEpochE_90_dadi_projection_SFS, TwoEpochE_90_lynch_SFS) +
ggtitle('Two Epoch Expansion, k=90') +
compare_msprime_dadi_lynch_count_sfs(one_epoch_90_SFS, ThreeEpochC_90_msprime_SFS,
ThreeEpochC_90_dadi_projection_SFS, ThreeEpochC_90_lynch_SFS) +
ggtitle('Three Epoch Contraction, k=90') +
compare_msprime_dadi_lynch_count_sfs(one_epoch_90_SFS, ThreeEpochE_90_msprime_SFS,
ThreeEpochE_90_dadi_projection_SFS, ThreeEpochE_90_lynch_SFS) +
ggtitle('Three Epoch Expansion, k=90') +
compare_msprime_dadi_lynch_count_sfs(one_epoch_90_SFS, ThreeEpochB_90_msprime_SFS,
ThreeEpochB_90_dadi_projection_SFS, ThreeEpochB_90_lynch_SFS) +
ggtitle('Three Epoch Bottleneck, k=90') +
plot_layout(nrow=3)
compare_msprime_dadi_lynch_count_sfs(one_epoch_100_SFS, TwoEpochC_100_msprime_SFS,
TwoEpochC_100_dadi_projection_SFS, TwoEpochC_100_lynch_SFS) +
ggtitle('Two Epoch Contraction, k=100') +
compare_msprime_dadi_lynch_count_sfs(one_epoch_100_SFS, TwoEpochE_100_msprime_SFS,
TwoEpochE_100_dadi_projection_SFS, TwoEpochE_100_lynch_SFS) +
ggtitle('Two Epoch Expansion, k=100') +
compare_msprime_dadi_lynch_count_sfs(one_epoch_100_SFS, ThreeEpochC_100_msprime_SFS,
ThreeEpochC_100_dadi_projection_SFS, ThreeEpochC_100_lynch_SFS) +
ggtitle('Three Epoch Contraction, k=100') +
compare_msprime_dadi_lynch_count_sfs(one_epoch_100_SFS, ThreeEpochE_100_msprime_SFS,
ThreeEpochE_100_dadi_projection_SFS, ThreeEpochE_100_lynch_SFS) +
ggtitle('Three Epoch Expansion, k=100') +
compare_msprime_dadi_lynch_count_sfs(one_epoch_100_SFS, ThreeEpochB_100_msprime_SFS,
ThreeEpochB_100_dadi_projection_SFS, ThreeEpochB_100_lynch_SFS) +
ggtitle('Three Epoch Bottleneck, k=100') +
plot_layout(nrow=3)
TwoEpochC_dadi_tajima_d = c()
TwoEpochE_dadi_tajima_d = c()
ThreeEpochC_dadi_tajima_d = c()
ThreeEpochE_dadi_tajima_d = c()
ThreeEpochB_dadi_tajima_d = c()
TwoEpochC_msprime_tajima_d = c()
TwoEpochE_msprime_tajima_d = c()
ThreeEpochC_msprime_tajima_d = c()
ThreeEpochE_msprime_tajima_d = c()
ThreeEpochB_msprime_tajima_d = c()
TwoEpochC_lynch_tajima_d = c()
TwoEpochE_lynch_tajima_d = c()
ThreeEpochC_lynch_tajima_d = c()
ThreeEpochE_lynch_tajima_d = c()
ThreeEpochB_lynch_tajima_d = c()
# Loop through subdirectories and get relevant files
for (i in seq(from=10, to=800, by=10)) {
# Dadi
subdirectory_dadi_2epC <- paste0("../Analysis/TwoEpochContraction_", i)
subdirectory_dadi_2epE <- paste0("../Analysis/TwoEpochExpansion_", i)
subdirectory_dadi_3epB <- paste0("../Analysis/ThreeEpochBottleneck_", i)
subdirectory_dadi_3epC <- paste0("../Analysis/ThreeEpochContraction_", i)
subdirectory_dadi_3epE <- paste0("../Analysis/ThreeEpochExpansion_", i)
TwoEpochC_dadi_summary <- paste0(subdirectory_dadi_2epC, "/summary.txt")
TwoEpochE_dadi_summary <- paste0(subdirectory_dadi_2epE, "/summary.txt")
ThreeEpochB_dadi_summary <- paste0(subdirectory_dadi_3epB, "/summary.txt")
ThreeEpochC_dadi_summary <- paste0(subdirectory_dadi_3epC, "/summary.txt")
ThreeEpochE_dadi_summary <- paste0(subdirectory_dadi_3epE, "/summary.txt")
TwoEpochC_dadi_tajima_d = c(TwoEpochC_dadi_tajima_d, read_summary_statistics(TwoEpochC_dadi_summary)[3])
TwoEpochE_dadi_tajima_d = c(TwoEpochE_dadi_tajima_d, read_summary_statistics(TwoEpochE_dadi_summary)[3])
ThreeEpochB_dadi_tajima_d = c(ThreeEpochB_dadi_tajima_d, read_summary_statistics(ThreeEpochB_dadi_summary)[3])
ThreeEpochC_dadi_tajima_d = c(ThreeEpochC_dadi_tajima_d, read_summary_statistics(ThreeEpochC_dadi_summary)[3])
ThreeEpochE_dadi_tajima_d = c(ThreeEpochE_dadi_tajima_d, read_summary_statistics(ThreeEpochE_dadi_summary)[3])
# Lynch
j = i + 1
subdirectory_lynch_2epC <- paste0("../Analysis/optimal_sample_size_test/2epC_", j)
subdirectory_lynch_2epE <- paste0("../Analysis/optimal_sample_size_test/2epE_", j)
subdirectory_lynch_3epB <- paste0("../Analysis/optimal_sample_size_test/3epB_", j)
subdirectory_lynch_3epC <- paste0("../Analysis/optimal_sample_size_test/3epC_", j)
subdirectory_lynch_3epE <- paste0("../Analysis/optimal_sample_size_test/3epE_", j)
TwoEpochC_lynch_summary <- paste0(subdirectory_lynch_2epC, "_summary.txt")
TwoEpochE_lynch_summary <- paste0(subdirectory_lynch_2epE, "_summary.txt")
ThreeEpochB_lynch_summary <- paste0(subdirectory_lynch_3epB, "_summary.txt")
ThreeEpochC_lynch_summary <- paste0(subdirectory_lynch_3epC, "_summary.txt")
ThreeEpochE_lynch_summary <- paste0(subdirectory_lynch_3epE, "_summary.txt")
TwoEpochC_lynch_tajima_d = c(TwoEpochC_lynch_tajima_d, read_summary_statistics(TwoEpochC_lynch_summary)[3])
TwoEpochE_lynch_tajima_d = c(TwoEpochE_lynch_tajima_d, read_summary_statistics(TwoEpochE_lynch_summary)[3])
ThreeEpochB_lynch_tajima_d = c(ThreeEpochB_lynch_tajima_d, read_summary_statistics(ThreeEpochB_lynch_summary)[3])
ThreeEpochC_lynch_tajima_d = c(ThreeEpochC_lynch_tajima_d, read_summary_statistics(ThreeEpochC_lynch_summary)[3])
ThreeEpochE_lynch_tajima_d = c(ThreeEpochE_lynch_tajima_d, read_summary_statistics(ThreeEpochE_lynch_summary)[3])
# MSPrime
subdirectory_msprime_2epC <- paste0("../Simulations/simple_simulations/TwoEpochContraction_", i)
subdirectory_msprime_2epE <- paste0("../Simulations/simple_simulations/TwoEpochExpansion_", i)
subdirectory_msprime_3epB <- paste0("../Simulations/simple_simulations/ThreeEpochBottleneck_", i)
subdirectory_msprime_3epC <- paste0("../Simulations/simple_simulations/ThreeEpochContraction_", i)
subdirectory_msprime_3epE <- paste0("../Simulations/simple_simulations/ThreeEpochExpansion_", i)
TwoEpochC_msprime_summary <- paste0(subdirectory_msprime_2epC, "_concat_summary.txt")
TwoEpochE_msprime_summary <- paste0(subdirectory_msprime_2epE, "_concat_summary.txt")
ThreeEpochB_msprime_summary <- paste0(subdirectory_msprime_3epB, "_concat_summary.txt")
ThreeEpochC_msprime_summary <- paste0(subdirectory_msprime_3epC, "_concat_summary.txt")
ThreeEpochE_msprime_summary <- paste0(subdirectory_msprime_3epE, "_concat_summary.txt")
TwoEpochC_msprime_tajima_d = c(TwoEpochC_msprime_tajima_d, read_summary_statistics(TwoEpochC_msprime_summary)[3])
TwoEpochE_msprime_tajima_d = c(TwoEpochE_msprime_tajima_d, read_summary_statistics(TwoEpochE_msprime_summary)[3])
ThreeEpochB_msprime_tajima_d = c(ThreeEpochB_msprime_tajima_d, read_summary_statistics(ThreeEpochB_msprime_summary)[3])
ThreeEpochC_msprime_tajima_d = c(ThreeEpochC_msprime_tajima_d, read_summary_statistics(ThreeEpochC_msprime_summary)[3])
ThreeEpochE_msprime_tajima_d = c(ThreeEpochE_msprime_tajima_d, read_summary_statistics(ThreeEpochE_msprime_summary)[3])
}
sample_size_index = seq(10, 800, 10)
TwoEpochC_tajima_d_df = melt(data.frame(
TwoEpochC_dadi_tajima_d,
TwoEpochC_msprime_tajima_d,
TwoEpochC_lynch_tajima_d
))
TwoEpochC_tajima_d_df$sample_size = sample_size_index
TwoEpochE_tajima_d_df = melt(data.frame(
TwoEpochE_dadi_tajima_d,
TwoEpochE_msprime_tajima_d,
TwoEpochE_lynch_tajima_d
))
TwoEpochE_tajima_d_df$sample_size = sample_size_index
ThreeEpochC_tajima_d_df = melt(data.frame(
ThreeEpochC_dadi_tajima_d,
ThreeEpochC_msprime_tajima_d,
ThreeEpochC_lynch_tajima_d
))
ThreeEpochC_tajima_d_df$sample_size = sample_size_index
ThreeEpochE_tajima_d_df = melt(data.frame(
ThreeEpochE_dadi_tajima_d,
ThreeEpochE_msprime_tajima_d,
ThreeEpochE_lynch_tajima_d
))
ThreeEpochE_tajima_d_df$sample_size = sample_size_index
ThreeEpochB_tajima_d_df = melt(data.frame(
ThreeEpochB_dadi_tajima_d,
ThreeEpochB_msprime_tajima_d,
ThreeEpochB_lynch_tajima_d
))
ThreeEpochB_tajima_d_df$sample_size = sample_size_index
ggplot(data=TwoEpochC_tajima_d_df, aes(x=sample_size, y=value, color=variable)) + geom_line(size=2) +
theme_bw() + guides(color=guide_legend(title="Type of SFS")) +
xlab('Sample size') +
ylab("Tajima's D") +
ggtitle("Tajima's D, Two Epoch Contraction") +
scale_colour_manual(
values = c("TwoEpochC_dadi_tajima_d"='red',
"TwoEpochC_msprime_tajima_d"='blue',
"TwoEpochC_lynch_tajima_d"='green'),
labels = c("Dadi", "MSPrime", "Lynch Theory")
) +
geom_hline(yintercept = 0, size = 2, linetype = 'dashed')
ggplot(data=TwoEpochE_tajima_d_df, aes(x=sample_size, y=value, color=variable)) + geom_line(size=2) +
theme_bw() + guides(color=guide_legend(title="Type of SFS")) +
xlab('Sample size') +
ylab("Tajima's D") +
ggtitle("Tajima's D, Two Epoch Expansion") +
scale_colour_manual(
values = c("TwoEpochE_dadi_tajima_d"='red',
"TwoEpochE_msprime_tajima_d"='blue',
"TwoEpochE_lynch_tajima_d"='green'),
labels = c("Dadi", "MSPrime", "Lynch Theory")
) +
geom_hline(yintercept = 0, size = 2, linetype = 'dashed')
ggplot(data=ThreeEpochC_tajima_d_df, aes(x=sample_size, y=value, color=variable)) + geom_line(size=2) +
theme_bw() + guides(color=guide_legend(title="Type of SFS")) +
xlab('Sample size') +
ylab("Tajima's D") +
ggtitle("Tajima's D, Three Epoch Contraction") +
scale_colour_manual(
values = c("ThreeEpochC_dadi_tajima_d"='red',
"ThreeEpochC_msprime_tajima_d"='blue',
"ThreeEpochC_lynch_tajima_d"='green'),
labels = c("Dadi", "MSPrime", "Lynch Theory")
) +
geom_hline(yintercept = 0, size = 2, linetype = 'dashed')
ggplot(data=ThreeEpochE_tajima_d_df, aes(x=sample_size, y=value, color=variable)) + geom_line(size=2) +
theme_bw() + guides(color=guide_legend(title="Type of SFS")) +
xlab('Sample size') +
ylab("Tajima's D") +
ggtitle("Tajima's D, Three Epoch Expansion") +
scale_colour_manual(
values = c("ThreeEpochE_dadi_tajima_d"='red',
"ThreeEpochE_msprime_tajima_d"='blue',
"ThreeEpochE_lynch_tajima_d"='green'),
labels = c("Dadi", "MSPrime", "Lynch Theory")
) +
geom_hline(yintercept = 0, size = 2, linetype = 'dashed')
ggplot(data=ThreeEpochB_tajima_d_df, aes(x=sample_size, y=value, color=variable)) + geom_line(size=2) +
theme_bw() + guides(color=guide_legend(title="Type of SFS")) +
xlab('Sample size') +
ylab("Tajima's D") +
ggtitle("Tajima's D, Three-epoch Bottleneck + Growth") +
scale_colour_manual(
values = c("ThreeEpochB_dadi_tajima_d"='red',
"ThreeEpochB_msprime_tajima_d"='blue',
"ThreeEpochB_lynch_tajima_d"='green'),
labels = c("Dadi", "MSPrime", "Lynch Theory")
) +
geom_hline(yintercept = 0, size = 2, linetype = 'dashed')
