plot_E_2 = ggplot(data=epoch_ratio_dataframe_msprime, aes(x=sample_size, y=value, color=variable)) + geom_line(size=2) +
theme_bw() + guides(color=guide_legend(title="Epoch Comparison")) +
xlab('Sample size') +
ylab("Ratio of effective population size") +
ggtitle("Effective population size between epochs") +
scale_colour_manual(
values = c("#FFC20A", "#CA5A08"),
labels = c("MSPrime, Bottleneck vs. Ancestral", "MSPrime, Recent vs. Bottleneck")
) +
geom_hline(yintercept = 1, size = 1, linetype = 'dashed', color='red')
# plot_E = plot_likelihood_surface_contour('../Analysis/dadi_3EpB_50/likelihood_surface.csv') +
#   ggtitle('Likelihood surface for dadi-simulated SFS, k=50') +
#   theme(axis.title.x=element_blank())
# find_CI_bounds('../Analysis/dadi_3EpB_50/likelihood_surface.csv')$nu_min
# plot_F = plot_likelihood_surface_contour('../Analysis/dadi_3EpB_100/likelihood_surface.csv') +
#   ggtitle('Likelihood surface for dadi-simulated SFS, k=100') +
#   theme(axis.title.x=element_blank(), axis.title.y=element_blank())
# plot_G = plot_likelihood_surface_contour('../Analysis/dadi_3EpB_200/likelihood_surface.csv') +
#   ggtitle('Likelihood surface for dadi-simulated SFS, k=200') +
#   theme(axis.title.x=element_blank(), axis.title.y=element_blank())
#
# plot_H = plot_likelihood_surface_contour('../Analysis/dadi_3EpB_300/likelihood_surface.csv') +
#   ggtitle('Likelihood surface for dadi-simulated SFS, k=300') +
#   theme(legend.position='none')
#
# loglik_dataframe = melt(data.frame(
#   dadi_two_LL,
#   dadi_three_LL
# ))
# loglik_dataframe$sample_size = sample_size
# ggplot(data=loglik_dataframe, aes(x=sample_size, y=value, color=variable)) + geom_line(size=2) +
#   theme_bw() + guides(color=guide_legend(title="Type of SFS")) +
#   xlab('Sample size') +
#   ylab("Log likelihood") +
#   ggtitle("Log likelihood for simulated SFS") +
#   scale_colour_manual(
#     values = c("#0C7BDC","#FFC20A"),
#     labels = c("Two-epoch", "Three-epoch")
#   ) +
#   geom_hline(yintercept = 0, size = 2, linetype = 'dashed')
#
design = "
AADD
BBEE
CCEE
"
# 1000 x 1200
plot_A +
plot_B +
plot_C +
plot_D +
plot_E +
plot_layout(design=design)
design_2 = "
AADD
BBFF
CCGG
"
# 1200 x 800
plot_A +
plot_B +
plot_C +
plot_D +
plot_E_1 + plot_E_2 +
plot_layout(design=design_2)
# for (i in sample_size) {
#   print(i)
#   print('dadi')
#   dadi_likelihood = paste0(
#     "../Analysis/dadi_3EpB_", i, '/likelihood_surface.csv')
#   plot_likelihood_surface_contour(dadi_likelihood)
# }
#
# for (i in sample_size) {
#   print(i)
#   print('msprime')
#   msprime_likelihood = paste0(
#    "../Analysis/msprime_3EpB_", i, '/likelihood_surface.csv')
#   plot_likelihood_surface_contour(msprime_likelihood)
# }
#### SCalE Talk figures
nu_dataframe = melt(data.frame(
msprime_nu
))
nu_dataframe$sample_size = sample_size
nu_dataframe$msprime_min = msprime_nu_min
nu_dataframe$msprime_max = msprime_nu_max
nu_dataframe_CI_bounds = melt(data.frame(
msprime_nu_min,
msprime_nu_max
))
nu_dataframe_CI_bounds$sample_size = sample_size
tau_dataframe = melt(data.frame(
msprime_tau
))
tau_dataframe$sample_size = sample_size
tau_dataframe$msprime_min = msprime_tau_min
tau_dataframe$msprime_max = msprime_tau_max
tajima_D_dataframe = melt(data.frame(
msprime_tajima_D
))
tajima_D_dataframe$sample_size = sample_size
plot_A = ggplot(data=nu_dataframe, aes(x=sample_size, y=value, color=variable)) + geom_line(size=2) +
theme_bw() + guides(color=guide_legend(title="Type of SFS")) +
xlab('Sample size') +
ylab(nu_label_text) +
ggtitle("Ratio of Effective to Ancestral population size") +
scale_colour_manual(
values = c("#FFC20A"),
labels = c("MSPrime")
) +
scale_y_log10() +
geom_hline(yintercept = 1, size = 2, linetype = 'dashed') +
theme(legend.position='none') +
theme(axis.title.x = element_blank()) +
theme(axis.title.y = element_text(size = 16))
plot_B = ggplot(data=tau_dataframe, aes(x=sample_size, y=value, color=variable)) + geom_line(size=2) +
theme_bw() + guides(color=guide_legend(title="Type of SFS")) +
xlab('Sample size') +
ylab(tau_label_text) +
ggtitle('Timing of inferred instantaneous size change') +
# scale_y_log10() +
scale_colour_manual(
values = c("#FFC20A"),
labels = c("MSPrime")
) +
theme(legend.position='none') +
theme(axis.title.x = element_text(size = 20)) +
theme(axis.title.y = element_text(size = 16))
plot_C = ggplot(data=tajima_D_dataframe, aes(x=sample_size, y=value, color=variable)) + geom_line(size=2) +
theme_bw() + guides(color=guide_legend(title="Type of SFS")) +
xlab('Sample size') +
ylab("Tajima's D") +
ggtitle("Tajima's D for simulated SFS") +
scale_colour_manual(
values = c("#FFC20A"),
labels = c("MSPrime")
) +
geom_hline(yintercept = 0, size = 2, linetype = 'dashed') +
theme(legend.position='none') +
theme(axis.title.x = element_blank()) +
theme(axis.title.y = element_text(size = 16))
plot_C + plot_A + plot_B + plot_layout(nrow=3)
# 600 x 800
# 1000 x 1200
plot_A +
plot_B +
plot_C +
plot_D +
plot_E +
plot_layout(design=design)
# 1000 x 1200
plot_A +
plot_B +
plot_C +
plot_D +
plot_E_2 +
plot_layout(design=design)
plot_D_2 = ggplot(data=lambda_dataframe, aes(x=sample_size, y=value, color=variable)) + geom_line(size=2) +
theme_bw() + guides(color=guide_legend(title="Demographic model comparison")) +
xlab('Sample size') +
ylab(twoLambda_text) +
ggtitle("Demographic model fit criterion, three-epoch vs. two-epoch") +
scale_colour_manual(
values = c("#FFC20A", "#CA5A08"),
labels = c("MSPrime, three-epoch vs. two-epoch", "MSPrime, two-epoch vs. one-epoch")
) +
geom_hline(yintercept = 14.75552, size = 1, linetype = 'dashed', color='red')
# 1000 x 1200
plot_A +
plot_B +
plot_C +
plot_D_2 +
plot_E_2 +
plot_layout(design=design)
lambda_dataframe_msprime = melt(data.frame(
msprime_lambda_32,
msprime_lambda_21
))
lambda_dataframe_msprime$sample_size = sample_size
plot_D_2 = ggplot(data=lambda_dataframe_msprime, aes(x=sample_size, y=value, color=variable)) + geom_line(size=2) +
theme_bw() + guides(color=guide_legend(title="Demographic model comparison")) +
xlab('Sample size') +
ylab(twoLambda_text) +
ggtitle("Demographic model fit criterion, three-epoch vs. two-epoch") +
scale_colour_manual(
values = c("#FFC20A", "#CA5A08"),
labels = c("MSPrime, three-epoch vs. two-epoch", "MSPrime, two-epoch vs. one-epoch")
) +
geom_hline(yintercept = 14.75552, size = 1, linetype = 'dashed', color='red')
# 1000 x 1200
plot_A +
plot_B +
plot_C +
plot_D_2 +
plot_E_2 +
plot_layout(design=design)
plot_D_2
plot_E_2
plot_E_2 = ggplot(data=epoch_ratio_dataframe_msprime, aes(x=sample_size, y=value, color=variable)) + geom_line(size=2) +
theme_bw() + guides(color=guide_legend(title="Epoch Comparison")) +
xlab('Sample size') +
ylab("Ratio of effective population size") +
ggtitle("Effective population size between epochs") +
scale_colour_manual(
values = c("#FFC20A", "#CA5A08"),
labels = c("MSPrime, Bottleneck vs. Ancestral", "MSPrime, Recent vs. Bottleneck")
) +
scale_y_log10() +
geom_hline(yintercept = 1, size = 1, linetype = 'dashed', color='red')
plot_E_2
# 1200 x 800
plot_A +
plot_B +
plot_C +
plot_D +
plot_E_1 + plot_E_2 +
plot_layout(design=design_2)
# 1000 x 1200
plot_A +
plot_B +
plot_C +
plot_D_2 +
plot_E_2 +
plot_layout(design=design)
# 1200 x 800
plot_A +
plot_B +
plot_C +
plot_D +
plot_E_1 + plot_E_2 +
plot_layout(design=design_2)
# 1000 x 1200
plot_A +
plot_B +
plot_C +
plot_D_2 +
plot_E_2 +
plot_layout(design=design)
plot_D_2 = ggplot(data=lambda_dataframe_msprime, aes(x=sample_size, y=value, color=variable)) + geom_line(size=2) +
theme_bw() + guides(color=guide_legend(title="Demographic model comparison")) +
xlab('Sample size') +
ylab(twoLambda_text) +
ggtitle("Demographic model fit criterion, three-epoch vs. two-epoch") +
scale_colour_manual(
values = c("#FFC20A", "#CA5A08"),
labels = c("MSPrime, three-epoch vs. two-epoch", "MSPrime, two-epoch vs. one-epoch")
) +
scale_y_log10() +
geom_hline(yintercept = 14.75552, size = 1, linetype = 'dashed', color='red')
# 1000 x 1200
plot_A +
plot_B +
plot_C +
plot_D_2 +
plot_E_2 +
plot_layout(design=design)
plot_B = ggplot(data=tau_dataframe, aes(x=sample_size, y=value, color=variable)) + geom_line(size=1) +
theme_bw() + guides(color=guide_legend(title="Type of SFS")) +
geom_ribbon(aes(ymin = dadi_min, ymax = dadi_max), fill = "#0C7BDC", color="#0C7BDC", alpha = 0.2) +
geom_ribbon(aes(ymin = msprime_min, ymax = msprime_max), fill = "#FFC20A", color="#FFC20A", alpha = 0.2) +
xlab('Sample size') +
ylab(tau_label_text) +
ggtitle('Timing of inferred instantaneous size change') +
scale_y_log10() +
scale_colour_manual(
values = c("#0C7BDC","#FFC20A"),
labels = c("Dadi", "MSPrime")
) +
theme(legend.position='none')
# 1000 x 1200
plot_A +
plot_B +
plot_C +
plot_D_2 +
plot_E_2 +
plot_layout(design=design)
plot_A = ggplot(data=nu_dataframe, aes(x=sample_size, y=value, color=variable)) + geom_line(size=1) +
theme_bw() + guides(color=guide_legend(title="Type of SFS")) +
# geom_ribbon(aes(ymin = dadi_min, ymax = dadi_max), fill = "#0C7BDC", color="#0C7BDC", alpha = 0.2) +
geom_ribbon(aes(ymin = msprime_min, ymax = msprime_max), fill = "#FFC20A", color="#FFC20A", alpha = 0.2) +
xlab('Sample size') +
ylab(nu_label_text) +
ggtitle("Ratio of Effective to Ancestral population size") +
scale_colour_manual(
values = c("#0C7BDC","#FFC20A"),
labels = c("Dadi", "MSPrime")
) +
scale_y_log10() +
geom_hline(yintercept = 1, size = 2, linetype = 'dashed')
plot_B = ggplot(data=tau_dataframe, aes(x=sample_size, y=value, color=variable)) + geom_line(size=1) +
theme_bw() + guides(color=guide_legend(title="Type of SFS")) +
# geom_ribbon(aes(ymin = dadi_min, ymax = dadi_max), fill = "#0C7BDC", color="#0C7BDC", alpha = 0.2) +
geom_ribbon(aes(ymin = msprime_min, ymax = msprime_max), fill = "#FFC20A", color="#FFC20A", alpha = 0.2) +
xlab('Sample size') +
ylab(tau_label_text) +
ggtitle('Timing of inferred instantaneous size change') +
scale_y_log10() +
scale_colour_manual(
values = c("#0C7BDC","#FFC20A"),
labels = c("Dadi", "MSPrime")
) +
theme(legend.position='none')
# 1000 x 1200
plot_A +
plot_B +
plot_C +
plot_D_2 +
plot_E_2 +
plot_layout(design=design)
plot_A = ggplot(data=nu_dataframe, aes(x=sample_size, y=value, color=variable)) + geom_line(size=2) +
theme_bw() + guides(color=guide_legend(title="Type of SFS")) +
xlab('Sample size') +
ylab(nu_label_text) +
ggtitle("Ratio of Effective to Ancestral population size") +
scale_colour_manual(
values = c("#FFC20A"),
labels = c("MSPrime")
) +
scale_y_log10() +
geom_hline(yintercept = 1, size = 2, linetype = 'dashed') +
theme(legend.position='none') +
theme(axis.title.x = element_blank()) +
theme(axis.title.y = element_text(size = 16))
plot_B = ggplot(data=tau_dataframe, aes(x=sample_size, y=value, color=variable)) + geom_line(size=2) +
theme_bw() + guides(color=guide_legend(title="Type of SFS")) +
xlab('Sample size') +
ylab(tau_label_text) +
ggtitle('Timing of inferred instantaneous size change') +
# scale_y_log10() +
scale_colour_manual(
values = c("#FFC20A"),
labels = c("MSPrime")
) +
theme(legend.position='none') +
theme(axis.title.x = element_text(size = 20)) +
theme(axis.title.y = element_text(size = 16))
plot_C = ggplot(data=tajima_D_dataframe, aes(x=sample_size, y=value, color=variable)) + geom_line(size=2) +
theme_bw() + guides(color=guide_legend(title="Type of SFS")) +
xlab('Sample size') +
ylab("Tajima's D") +
ggtitle("Tajima's D for simulated SFS") +
scale_colour_manual(
values = c("#FFC20A"),
labels = c("MSPrime")
) +
geom_hline(yintercept = 0, size = 2, linetype = 'dashed') +
theme(legend.position='none') +
theme(axis.title.x = element_blank()) +
theme(axis.title.y = element_text(size = 16))
plot_C + plot_A + plot_B + plot_layout(nrow=3)
# 1000 x 1200
plot_A +
plot_B +
plot_C +
plot_D_2 +
plot_E_2 +
plot_layout(design=design)
plot_A = ggplot(data=nu_dataframe, aes(x=sample_size, y=value, color=variable)) + geom_line(size=2) +
theme_bw() + guides(color=guide_legend(title="Type of SFS")) +
xlab('Sample size') +
ylab(nu_label_text) +
ggtitle("Ratio of Effective to Ancestral population size") +
scale_colour_manual(
values = c("#FFC20A"),
labels = c("MSPrime")
) +
geom_ribbon(aes(ymin = msprime_min, ymax = msprime_max), fill = "#FFC20A", color="#FFC20A", alpha = 0.2) +
scale_y_log10() +
geom_hline(yintercept = 1, size = 2, linetype = 'dashed') +
theme(legend.position='none') +
theme(axis.title.x = element_blank()) +
theme(axis.title.y = element_text(size = 16))
plot_B = ggplot(data=tau_dataframe, aes(x=sample_size, y=value, color=variable)) + geom_line(size=2) +
theme_bw() + guides(color=guide_legend(title="Type of SFS")) +
xlab('Sample size') +
ylab(tau_label_text) +
geom_ribbon(aes(ymin = msprime_min, ymax = msprime_max), fill = "#FFC20A", color="#FFC20A", alpha = 0.2) +
ggtitle('Timing of inferred instantaneous size change') +
# scale_y_log10() +
scale_colour_manual(
values = c("#FFC20A"),
labels = c("MSPrime")
) +
theme(legend.position='none') +
theme(axis.title.x = element_text(size = 20)) +
theme(axis.title.y = element_text(size = 16))
plot_C = ggplot(data=tajima_D_dataframe, aes(x=sample_size, y=value, color=variable)) + geom_line(size=2) +
theme_bw() + guides(color=guide_legend(title="Type of SFS")) +
xlab('Sample size') +
ylab("Tajima's D") +
ggtitle("Tajima's D for simulated SFS") +
scale_colour_manual(
values = c("#FFC20A"),
labels = c("MSPrime")
) +
geom_hline(yintercept = 0, size = 2, linetype = 'dashed') +
theme(legend.position='none') +
theme(axis.title.x = element_blank()) +
theme(axis.title.y = element_text(size = 16))
plot_C + plot_A + plot_B + plot_layout(nrow=3)
# 1000 x 1200
plot_A +
plot_B +
plot_C +
plot_D_2 +
plot_E_2 +
plot_layout(design=design)
#   theme_bw() + guides(color=guide_legend(title="Type of SFS")) +
#   xlab('Sample size') +
#   ylab("Log likelihood") +
#   ggtitle("Log likelihood for simulated SFS") +
#   scale_colour_manual(
#     values = c("#0C7BDC","#FFC20A"),
#     labels = c("Two-epoch", "Three-epoch")
#   ) +
#   geom_hline(yintercept = 0, size = 2, linetype = 'dashed')
#
design = "
CCDD
AAEE
BBEE
"
# 1200 x 800
plot_A +
plot_B +
plot_C +
plot_D_2 +
plot_E_2 +
plot_layout(design=design)
# figure_4.R
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
source('useful_functions.R')
sample_size = seq(from=10, to=800, by=10)
dadi_sfs_singletons = c()
dadi_snm_singletons = c()
dadi_singleton_ratio = c()
dadi_singleton_diff = c()
msprime_sfs_singletons = c()
msprime_snm_singletons = c()
msprime_singleton_ratio = c()
msprime_singleton_diff = c()
for (i in sample_size) {
dadi_sfs = proportional_sfs(read_input_sfs(paste0(
"../Simulations/dadi_simulations/ThreeEpochBottleneck_", i, '.sfs')))
dadi_snm_sfs = proportional_sfs(sfs_from_demography(paste0(
"../Analysis/dadi_3EpB_", i, '/one_epoch_demography.txt')))
dadi_sfs_singletons = c(dadi_sfs_singletons, dadi_sfs[1])
dadi_snm_singletons = c(dadi_snm_singletons, dadi_snm_sfs[1])
dadi_singleton_ratio = c(dadi_singleton_ratio, dadi_sfs[1] / dadi_snm_sfs[1])
dadi_singleton_diff = c(dadi_singleton_diff, (dadi_sfs[1] - dadi_snm_sfs[1]))
msprime_sfs = proportional_sfs(read_input_sfs(paste0(
"../Simulations/simple_simulations/ThreeEpochBottleneck_", i, '_concat.sfs')))
msprime_snm_sfs = proportional_sfs(sfs_from_demography(paste0(
"../Analysis/msprime_3EpB_", i, '/one_epoch_demography.txt')))
msprime_sfs_singletons = c(msprime_sfs_singletons, msprime_sfs[1])
msprime_snm_singletons = c(msprime_snm_singletons, msprime_snm_sfs[1])
msprime_singleton_ratio = c(msprime_singleton_ratio, msprime_sfs[1] / msprime_snm_sfs[1])
msprime_singleton_diff = c(msprime_singleton_diff, (msprime_sfs[1] - msprime_snm_sfs[1]))
}
singleton_ratio_dataframe = melt(data.frame(
dadi_singleton_ratio,
msprime_singleton_ratio
))
singleton_ratio_dataframe$sample_size = sample_size
nu_label_text = expression(nu == frac(N[current], N[ancestral]))
ratio_label_text = expression(frac('Proportion of singletons in data', 'Proportion of singletons in SNM'))
singleton_proportion_dataframe = melt(data.frame(
dadi_sfs_singletons,
msprime_sfs_singletons,
dadi_snm_singletons
))
singleton_proportion_dataframe$sample_size = sample_size
singleton_diff_dataframe = melt(data.frame(
dadi_singleton_diff,
msprime_singleton_diff
))
singleton_diff_dataframe$sample_size = sample_size
plot_A = ggplot(data=singleton_proportion_dataframe, aes(x=sample_size, y=value, color=variable)) + geom_line(linewidth=1) +
theme_bw() + guides(color=guide_legend(title="Type of SFS")) +
xlab('Sample size') +
ylab('Proportion') +
ggtitle('Proportion of SFS comprised of singletons') +
scale_colour_manual(
values = c("#0C7BDC","#FFC20A", 'black'),
labels = c("Dadi", "MSPrime", "SNM")
)
# plot_B = ggplot(data=singleton_diff_dataframe, aes(x=sample_size, y=value, color=variable)) + geom_line(linewidth=1) +
#   theme_bw() + guides(color=guide_legend(title="Type of SFS")) +
#   xlab('Sample size') +
#   ylab('Difference in proportion of singletons') +
#   ggtitle('Difference in singleton proportion between data and SNM') +
#   scale_colour_manual(
#     values = c("#0C7BDC","#FFC20A"),
#     labels = c("Dadi", "MSPrime")
#   ) +
#   geom_hline(yintercept = 0, size = 1, linetype = 'dotted') +
#   theme(legend.position='none')
plot_B = ggplot(data=singleton_ratio_dataframe, aes(x=sample_size, y=value, color=variable)) + geom_line(linewidth=1) +
theme_bw() + guides(color=guide_legend(title="Type of SFS")) +
xlab('Sample size') +
ylab(ratio_label_text) +
ggtitle('Ratio of singleton proportion between data and SNM') +
scale_colour_manual(
values = c("#0C7BDC","#FFC20A"),
labels = c("Dadi", "MSPrime")
) +
scale_y_log10() +
geom_hline(yintercept = 1, linewidth = 1, linetype = 'dotted') +
theme(legend.position='none')
# 800 x 800
plot_A + plot_B + plot_layout(nrow=2)
