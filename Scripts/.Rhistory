'msprime_expand'=22),
labels=c('Contraction',
'Expansion')) +
guides(shape='none', color='none')
plot_3A_1000_2000 + plot_3B_simplified_1000_2000 + plot_layout(nrow=2)
plot_3A_1000_2000 + plot_3B_simplified_1000_2000 + plot_layout(nrow=2)
# 500_2000
sample_size = seq(from=10, to=800, by=10)
mean_list_500_2000 = c()
growth_coal_proportion_500_2000 = c()
bottleneck_coal_proportion_500_2000 = c()
ancestral_coal_proportion_500_2000 = c()
msprime_time_500_2000 = c()
msprime_nu_shape_500_2000 = c()
growth_b_len_proportion_mean_500_2000 = c()
bottleneck_b_len_proportion_mean_500_2000 = c()
ancestral_b_len_proportion_mean_500_2000 = c()
# Iterate through sample size and replicate
for (i in sample_size) {
this_sample_size_distribution = c() # Initialize
msprime_demography_500_2000 = paste0(
"../Analysis/msprime_3EpB_500_2000_", i, '/two_epoch_demography.txt')
msprime_nu_500_2000 = nu_from_demography(msprime_demography_500_2000)
msprime_time_500_2000 = c(msprime_time_500_2000, time_from_demography(msprime_demography_500_2000))
if (is.na(msprime_nu_500_2000)) {
msprime_nu_shape_500_2000 = c(msprime_nu_shape_500_2000, NA)
} else if (msprime_nu_500_2000 > 1) {
msprime_nu_shape_500_2000 = c(msprime_nu_shape_500_2000, 'msprime_expand')
} else {
msprime_nu_shape_500_2000 = c(msprime_nu_shape_500_2000, 'msprime_contract')
}
for (j in seq(from=1, to=5, by=1)) {
this_replicate_distribution = paste0(
"../Simulations/simple_simulations/ThreeEpochBottleneck_500_2000_",
i, '_coal_dist_',
j, '.csv')
# Read in the appropriate file
this_csv = read.csv(this_replicate_distribution, header=TRUE)
this_sample_size_distribution = c(this_sample_size_distribution, this_csv$generations)
}
this_b_len_growth = c()
this_b_len_bottleneck = c()
this_b_len_ancestral = c()
for (g in seq(from=1, to=5, by=1)) {
this_branch_distribution = paste0(
"../Simulations/simple_simulations/ThreeEpochBottleneck_500_2000_",
i, '_branch_length_dist_',
g, '.csv')
if (file.exists(this_branch_distribution)) {
} else {
next
}
# Read in the appropriate file
this_b_len_csv = read.csv(this_branch_distribution, header=TRUE)
growth_sum = sum(this_b_len_csv[this_b_len_csv$node_generations <= 200, ]$branch_length)
bottleneck_sum = sum(this_b_len_csv[this_b_len_csv$node_generations > 200 &
this_b_len_csv$node_generations<= 2000, ]$branch_length)
ancestral_sum = sum(this_b_len_csv[this_b_len_csv$node_generations > 2000, ]$branch_length)
total_branch_length = growth_sum + bottleneck_sum + ancestral_sum
this_b_len_growth = c(this_b_len_growth, growth_sum / total_branch_length)
this_b_len_bottleneck = c(this_b_len_bottleneck, bottleneck_sum / total_branch_length)
this_b_len_ancestral = c(this_b_len_ancestral, ancestral_sum / total_branch_length)
}
# Take the mean of coalescent times for this sample size's distribution
mean_list_500_2000 = c(mean_list_500_2000, mean(this_sample_size_distribution))
# Similarly, take standard deviation
# Lastly find the proportion of coalescent events in each epoch
growth_coal_proportion_500_2000 = c(growth_coal_proportion_500_2000,
mean(this_sample_size_distribution <= 200))
bottleneck_coal_proportion_500_2000 = c(bottleneck_coal_proportion_500_2000,
mean(this_sample_size_distribution <= 2000) - mean(this_sample_size_distribution < 200))
ancestral_coal_proportion_500_2000 = c(ancestral_coal_proportion_500_2000,
mean(this_sample_size_distribution > 2000))
# Mean and sd of branch length proportions by epoch
growth_b_len_proportion_mean_500_2000 = c(growth_b_len_proportion_mean_500_2000, mean(this_b_len_growth))
bottleneck_b_len_proportion_mean_500_2000 = c(bottleneck_b_len_proportion_mean_500_2000, mean(this_b_len_bottleneck))
ancestral_b_len_proportion_mean_500_2000 = c(ancestral_b_len_proportion_mean_500_2000, mean(this_b_len_ancestral))
}
# 1500_2000
sample_size = seq(from=10, to=800, by=10)
mean_list_1500_2000 = c()
growth_coal_proportion_1500_2000 = c()
bottleneck_coal_proportion_1500_2000 = c()
ancestral_coal_proportion_1500_2000 = c()
msprime_time_1500_2000 = c()
msprime_nu_shape_1500_2000 = c()
growth_b_len_proportion_mean_1500_2000 = c()
bottleneck_b_len_proportion_mean_1500_2000 = c()
ancestral_b_len_proportion_mean_1500_2000 = c()
# Iterate through sample size and replicate
for (i in sample_size) {
this_sample_size_distribution = c() # Initialize
msprime_demography_1500_2000 = paste0(
"../Analysis/msprime_3EpB_1500_2000_", i, '/two_epoch_demography.txt')
msprime_nu_1500_2000 = nu_from_demography(msprime_demography_1500_2000)
msprime_time_1500_2000 = c(msprime_time_1500_2000, time_from_demography(msprime_demography_1500_2000))
if (is.na(msprime_nu_1500_2000)) {
msprime_nu_shape_1500_2000 = c(msprime_nu_shape_1500_2000, NA)
} else if (msprime_nu_1500_2000 > 1) {
msprime_nu_shape_1500_2000 = c(msprime_nu_shape_1500_2000, 'msprime_expand')
} else {
msprime_nu_shape_1500_2000 = c(msprime_nu_shape_1500_2000, 'msprime_contract')
}
for (j in seq(from=1, to=5, by=1)) {
this_replicate_distribution = paste0(
"../Simulations/simple_simulations/ThreeEpochBottleneck_1500_2000_",
i, '_coal_dist_',
j, '.csv')
# Read in the appropriate file
this_csv = read.csv(this_replicate_distribution, header=TRUE)
this_sample_size_distribution = c(this_sample_size_distribution, this_csv$generations)
}
this_b_len_growth = c()
this_b_len_bottleneck = c()
this_b_len_ancestral = c()
for (g in seq(from=1, to=5, by=1)) {
this_branch_distribution = paste0(
"../Simulations/simple_simulations/ThreeEpochBottleneck_1500_2000_",
i, '_branch_length_dist_',
g, '.csv')
if (file.exists(this_branch_distribution)) {
} else {
next
}
# Read in the appropriate file
this_b_len_csv = read.csv(this_branch_distribution, header=TRUE)
growth_sum = sum(this_b_len_csv[this_b_len_csv$node_generations <= 200, ]$branch_length)
bottleneck_sum = sum(this_b_len_csv[this_b_len_csv$node_generations > 200 &
this_b_len_csv$node_generations<= 2000, ]$branch_length)
ancestral_sum = sum(this_b_len_csv[this_b_len_csv$node_generations > 2000, ]$branch_length)
total_branch_length = growth_sum + bottleneck_sum + ancestral_sum
this_b_len_growth = c(this_b_len_growth, growth_sum / total_branch_length)
this_b_len_bottleneck = c(this_b_len_bottleneck, bottleneck_sum / total_branch_length)
this_b_len_ancestral = c(this_b_len_ancestral, ancestral_sum / total_branch_length)
}
# Take the mean of coalescent times for this sample size's distribution
mean_list_1500_2000 = c(mean_list_1500_2000, mean(this_sample_size_distribution))
# Similarly, take standard deviation
# Lastly find the proportion of coalescent events in each epoch
growth_coal_proportion_1500_2000 = c(growth_coal_proportion_1500_2000,
mean(this_sample_size_distribution <= 200))
bottleneck_coal_proportion_1500_2000 = c(bottleneck_coal_proportion_1500_2000,
mean(this_sample_size_distribution <= 2000) - mean(this_sample_size_distribution < 200))
ancestral_coal_proportion_1500_2000 = c(ancestral_coal_proportion_1500_2000,
mean(this_sample_size_distribution > 2000))
# Mean and sd of branch length proportions by epoch
growth_b_len_proportion_mean_1500_2000 = c(growth_b_len_proportion_mean_1500_2000, mean(this_b_len_growth))
bottleneck_b_len_proportion_mean_1500_2000 = c(bottleneck_b_len_proportion_mean_1500_2000, mean(this_b_len_bottleneck))
ancestral_b_len_proportion_mean_1500_2000 = c(ancestral_b_len_proportion_mean_1500_2000, mean(this_b_len_ancestral))
}
figure_SX_dataframe = data.frame(
mean_list_1500_2000,
sample_size
)
# figure_3A_dataframe$sample_size = sample_size
plot_SX = ggplot(data=figure_SX_dataframe, aes(x=sample_size, y=mean_list)) +
geom_line(linewidth=1) +
theme_bw() +
xlab('Sample size') +
ylab("Mean coalescent time (generations)") +
ggtitle("Mean coalescent time by sample size") +
geom_hline(yintercept = 1, linewidth = 1, linetype = 'dashed')
figure_3A_dataframe_1500_2000 = melt(data.frame(
growth_coal_proportion_1500_2000,
bottleneck_coal_proportion_1500_2000,
ancestral_coal_proportion_1500_2000
))
figure_3A_dataframe_1500_2000$msprime_time = msprime_time_1500_2000
figure_3A_dataframe_1500_2000$msprime_shape = msprime_nu_shape_1500_2000
figure_3A_dataframe_1500_2000$sample_size = sample_size
plot_3A_1500_2000 = ggplot(data=figure_3A_dataframe_1500_2000, aes(x=sample_size, y=value, color=variable, shape=msprime_shape)) +
geom_point(size=1.5) +
theme_bw() +
xlab('Sample size') +
ylab('Proportion') +
ggtitle('Coalescent events per epoch, [Anc., 3500 g.a., 2000 g.a.]') +
scale_color_manual(name='Epoch',
breaks=c('growth_coal_proportion_1500_2000',
'bottleneck_coal_proportion_1500_2000',
'ancestral_coal_proportion_1500_2000'),
values=c('growth_coal_proportion_1500_2000'='#1b9e77',
'bottleneck_coal_proportion_1500_2000'='#d95f02',
'ancestral_coal_proportion_1500_2000'='#7570b3'),
labels=c('Recent growth [2000 g.a.]',
'Bottleneck [3500 g.a.]',
'Ancestral population')) +
scale_shape_manual(name='Inferred two-epoch model',
breaks=c('msprime_contract',
'msprime_expand'),
values=c('msprime_contract'=15,
'msprime_expand'=22),
labels=c('Contraction',
'Expansion'))
figure_3B_dataframe_1500_2000 = melt(data.frame(
growth_b_len_proportion_mean_1500_2000,
bottleneck_b_len_proportion_mean_1500_2000,
ancestral_b_len_proportion_mean_1500_2000
))
figure_3B_dataframe_1500_2000$sample_size = sample_size
figure_3B_dataframe_1500_2000$msprime_shape = msprime_nu_shape_1500_2000
plot_3B_simplified_1500_2000 = ggplot(data=figure_3B_dataframe_1500_2000, aes(x=sample_size, y=value, color=variable)) +
geom_point(aes(shape=msprime_shape), size=1.5) +
theme_bw() +
xlab('Sample size') +
ylab('Mean branch length') +
ggtitle('Branch length per epoch') +
scale_color_manual(name='Epoch',
breaks=c('growth_b_len_proportion_mean_1500_2000',
'bottleneck_b_len_proportion_mean_1500_2000',
'ancestral_b_len_proportion_mean_1500_2000'),
values=c('growth_b_len_proportion_mean_1500_2000'='#1b9e77',
'bottleneck_b_len_proportion_mean_1500_2000'='#d95f02',
'ancestral_b_len_proportion_mean_1500_2000'='#7570b3'),
labels=c('Recent growth', 'Bottleneck', 'Ancestral population')) +
scale_shape_manual(name='Inferred two-epoch model',
breaks=c('msprime_contract',
'msprime_expand'),
values=c('msprime_contract'=15,
'msprime_expand'=22),
labels=c('Contraction',
'Expansion')) +
guides(shape='none', color='none')
plot_3A_1500_2000 + plot_3B_simplified_1500_2000 + plot_layout(nrow=2)
# 2000_2000
sample_size = seq(from=10, to=800, by=10)
mean_list_2000_2000 = c()
growth_coal_proportion_2000_2000 = c()
bottleneck_coal_proportion_2000_2000 = c()
ancestral_coal_proportion_2000_2000 = c()
msprime_time_2000_2000 = c()
msprime_nu_shape_2000_2000 = c()
growth_b_len_proportion_mean_2000_2000 = c()
bottleneck_b_len_proportion_mean_2000_2000 = c()
ancestral_b_len_proportion_mean_2000_2000 = c()
# Iterate through sample size and replicate
for (i in sample_size) {
this_sample_size_distribution = c() # Initialize
msprime_demography_2000_2000 = paste0(
"../Analysis/msprime_3EpB_2000_2000_", i, '/two_epoch_demography.txt')
msprime_nu_2000_2000 = nu_from_demography(msprime_demography_2000_2000)
msprime_time_2000_2000 = c(msprime_time_2000_2000, time_from_demography(msprime_demography_2000_2000))
if (is.na(msprime_nu_2000_2000)) {
msprime_nu_shape_2000_2000 = c(msprime_nu_shape_2000_2000, NA)
} else if (msprime_nu_2000_2000 > 1) {
msprime_nu_shape_2000_2000 = c(msprime_nu_shape_2000_2000, 'msprime_expand')
} else {
msprime_nu_shape_2000_2000 = c(msprime_nu_shape_2000_2000, 'msprime_contract')
}
for (j in seq(from=1, to=5, by=1)) {
this_replicate_distribution = paste0(
"../Simulations/simple_simulations/ThreeEpochBottleneck_2000_2000_",
i, '_coal_dist_',
j, '.csv')
# Read in the appropriate file
this_csv = read.csv(this_replicate_distribution, header=TRUE)
this_sample_size_distribution = c(this_sample_size_distribution, this_csv$generations)
}
this_b_len_growth = c()
this_b_len_bottleneck = c()
this_b_len_ancestral = c()
for (g in seq(from=1, to=5, by=1)) {
this_branch_distribution = paste0(
"../Simulations/simple_simulations/ThreeEpochBottleneck_2000_2000_",
i, '_branch_length_dist_',
g, '.csv')
if (file.exists(this_branch_distribution)) {
} else {
next
}
# Read in the appropriate file
this_b_len_csv = read.csv(this_branch_distribution, header=TRUE)
growth_sum = sum(this_b_len_csv[this_b_len_csv$node_generations <= 200, ]$branch_length)
bottleneck_sum = sum(this_b_len_csv[this_b_len_csv$node_generations > 200 &
this_b_len_csv$node_generations<= 2000, ]$branch_length)
ancestral_sum = sum(this_b_len_csv[this_b_len_csv$node_generations > 2000, ]$branch_length)
total_branch_length = growth_sum + bottleneck_sum + ancestral_sum
this_b_len_growth = c(this_b_len_growth, growth_sum / total_branch_length)
this_b_len_bottleneck = c(this_b_len_bottleneck, bottleneck_sum / total_branch_length)
this_b_len_ancestral = c(this_b_len_ancestral, ancestral_sum / total_branch_length)
}
# Take the mean of coalescent times for this sample size's distribution
mean_list_2000_2000 = c(mean_list_2000_2000, mean(this_sample_size_distribution))
# Similarly, take standard deviation
# Lastly find the proportion of coalescent events in each epoch
growth_coal_proportion_2000_2000 = c(growth_coal_proportion_2000_2000,
mean(this_sample_size_distribution <= 200))
bottleneck_coal_proportion_2000_2000 = c(bottleneck_coal_proportion_2000_2000,
mean(this_sample_size_distribution <= 2000) - mean(this_sample_size_distribution < 200))
ancestral_coal_proportion_2000_2000 = c(ancestral_coal_proportion_2000_2000,
mean(this_sample_size_distribution > 2000))
# Mean and sd of branch length proportions by epoch
growth_b_len_proportion_mean_2000_2000 = c(growth_b_len_proportion_mean_2000_2000, mean(this_b_len_growth))
bottleneck_b_len_proportion_mean_2000_2000 = c(bottleneck_b_len_proportion_mean_2000_2000, mean(this_b_len_bottleneck))
ancestral_b_len_proportion_mean_2000_2000 = c(ancestral_b_len_proportion_mean_2000_2000, mean(this_b_len_ancestral))
}
figure_SX_dataframe = data.frame(
mean_list_2000_2000,
sample_size
)
# figure_3A_dataframe$sample_size = sample_size
plot_SX = ggplot(data=figure_SX_dataframe, aes(x=sample_size, y=mean_list)) +
geom_line(linewidth=1) +
theme_bw() +
xlab('Sample size') +
ylab("Mean coalescent time (generations)") +
ggtitle("Mean coalescent time by sample size") +
geom_hline(yintercept = 1, linewidth = 1, linetype = 'dashed')
figure_3A_dataframe_2000_2000 = melt(data.frame(
growth_coal_proportion_2000_2000,
bottleneck_coal_proportion_2000_2000,
ancestral_coal_proportion_2000_2000
))
figure_3A_dataframe_2000_2000$msprime_time = msprime_time_2000_2000
figure_3A_dataframe_2000_2000$msprime_shape = msprime_nu_shape_2000_2000
figure_3A_dataframe_2000_2000$sample_size = sample_size
plot_3A_2000_2000 = ggplot(data=figure_3A_dataframe_2000_2000, aes(x=sample_size, y=value, color=variable, shape=msprime_shape)) +
geom_point(size=1.5) +
theme_bw() +
xlab('Sample size') +
ylab('Proportion') +
ggtitle('Coalescent events per epoch, [Anc., 4000 g.a., 2000 g.a.]') +
scale_color_manual(name='Epoch',
breaks=c('growth_coal_proportion_2000_2000',
'bottleneck_coal_proportion_2000_2000',
'ancestral_coal_proportion_2000_2000'),
values=c('growth_coal_proportion_2000_2000'='#1b9e77',
'bottleneck_coal_proportion_2000_2000'='#d95f02',
'ancestral_coal_proportion_2000_2000'='#7570b3'),
labels=c('Recent growth [2000 g.a.]',
'Bottleneck [4000 g.a.]',
'Ancestral population')) +
scale_shape_manual(name='Inferred two-epoch model',
breaks=c('msprime_contract',
'msprime_expand'),
values=c('msprime_contract'=15,
'msprime_expand'=22),
labels=c('Contraction',
'Expansion'))
figure_3B_dataframe_2000_2000 = melt(data.frame(
growth_b_len_proportion_mean_2000_2000,
bottleneck_b_len_proportion_mean_2000_2000,
ancestral_b_len_proportion_mean_2000_2000
))
figure_3B_dataframe_2000_2000$sample_size = sample_size
figure_3B_dataframe_2000_2000$msprime_shape = msprime_nu_shape_2000_2000
plot_3B_simplified_2000_2000 = ggplot(data=figure_3B_dataframe_2000_2000, aes(x=sample_size, y=value, color=variable)) +
geom_point(aes(shape=msprime_shape), size=1.5) +
theme_bw() +
xlab('Sample size') +
ylab('Mean branch length') +
ggtitle('Branch length per epoch') +
scale_color_manual(name='Epoch',
breaks=c('growth_b_len_proportion_mean_2000_2000',
'bottleneck_b_len_proportion_mean_2000_2000',
'ancestral_b_len_proportion_mean_2000_2000'),
values=c('growth_b_len_proportion_mean_2000_2000'='#1b9e77',
'bottleneck_b_len_proportion_mean_2000_2000'='#d95f02',
'ancestral_b_len_proportion_mean_2000_2000'='#7570b3'),
labels=c('Recent growth', 'Bottleneck', 'Ancestral population')) +
scale_shape_manual(name='Inferred two-epoch model',
breaks=c('msprime_contract',
'msprime_expand'),
values=c('msprime_contract'=15,
'msprime_expand'=22),
labels=c('Contraction',
'Expansion')) +
guides(shape='none', color='none')
plot_3A_2000_2000 + plot_3B_simplified_2000_2000 + plot_layout(nrow=2)
# 500_2000
sample_size = seq(from=10, to=800, by=10)
mean_list_500_2000 = c()
growth_coal_proportion_500_2000 = c()
bottleneck_coal_proportion_500_2000 = c()
ancestral_coal_proportion_500_2000 = c()
msprime_time_500_2000 = c()
msprime_nu_shape_500_2000 = c()
growth_b_len_proportion_mean_500_2000 = c()
bottleneck_b_len_proportion_mean_500_2000 = c()
ancestral_b_len_proportion_mean_500_2000 = c()
# Iterate through sample size and replicate
for (i in sample_size) {
this_sample_size_distribution = c() # Initialize
msprime_demography_500_2000 = paste0(
"../Analysis/msprime_3EpB_500_2000_", i, '/two_epoch_demography.txt')
msprime_nu_500_2000 = nu_from_demography(msprime_demography_500_2000)
msprime_time_500_2000 = c(msprime_time_500_2000, time_from_demography(msprime_demography_500_2000))
if (is.na(msprime_nu_500_2000)) {
msprime_nu_shape_500_2000 = c(msprime_nu_shape_500_2000, NA)
} else if (msprime_nu_500_2000 > 1) {
msprime_nu_shape_500_2000 = c(msprime_nu_shape_500_2000, 'msprime_expand')
} else {
msprime_nu_shape_500_2000 = c(msprime_nu_shape_500_2000, 'msprime_contract')
}
for (j in seq(from=1, to=5, by=1)) {
this_replicate_distribution = paste0(
"../Simulations/simple_simulations/ThreeEpochBottleneck_500_2000_",
i, '_coal_dist_',
j, '.csv')
# Read in the appropriate file
this_csv = read.csv(this_replicate_distribution, header=TRUE)
this_sample_size_distribution = c(this_sample_size_distribution, this_csv$generations)
}
this_b_len_growth = c()
this_b_len_bottleneck = c()
this_b_len_ancestral = c()
for (g in seq(from=1, to=5, by=1)) {
this_branch_distribution = paste0(
"../Simulations/simple_simulations/ThreeEpochBottleneck_500_2000_",
i, '_branch_length_dist_',
g, '.csv')
if (file.exists(this_branch_distribution)) {
} else {
next
}
# Read in the appropriate file
this_b_len_csv = read.csv(this_branch_distribution, header=TRUE)
growth_sum = sum(this_b_len_csv[this_b_len_csv$node_generations <= 200, ]$branch_length)
bottleneck_sum = sum(this_b_len_csv[this_b_len_csv$node_generations > 200 &
this_b_len_csv$node_generations<= 2000, ]$branch_length)
ancestral_sum = sum(this_b_len_csv[this_b_len_csv$node_generations > 2000, ]$branch_length)
total_branch_length = growth_sum + bottleneck_sum + ancestral_sum
this_b_len_growth = c(this_b_len_growth, growth_sum / total_branch_length)
this_b_len_bottleneck = c(this_b_len_bottleneck, bottleneck_sum / total_branch_length)
this_b_len_ancestral = c(this_b_len_ancestral, ancestral_sum / total_branch_length)
}
# Take the mean of coalescent times for this sample size's distribution
mean_list_500_2000 = c(mean_list_500_2000, mean(this_sample_size_distribution))
# Similarly, take standard deviation
# Lastly find the proportion of coalescent events in each epoch
growth_coal_proportion_500_2000 = c(growth_coal_proportion_500_2000,
mean(this_sample_size_distribution <= 200))
bottleneck_coal_proportion_500_2000 = c(bottleneck_coal_proportion_500_2000,
mean(this_sample_size_distribution <= 2000) - mean(this_sample_size_distribution < 200))
ancestral_coal_proportion_500_2000 = c(ancestral_coal_proportion_500_2000,
mean(this_sample_size_distribution > 2000))
# Mean and sd of branch length proportions by epoch
growth_b_len_proportion_mean_500_2000 = c(growth_b_len_proportion_mean_500_2000, mean(this_b_len_growth))
bottleneck_b_len_proportion_mean_500_2000 = c(bottleneck_b_len_proportion_mean_500_2000, mean(this_b_len_bottleneck))
ancestral_b_len_proportion_mean_500_2000 = c(ancestral_b_len_proportion_mean_500_2000, mean(this_b_len_ancestral))
}
# 500_2000
sample_size = seq(from=10, to=800, by=10)
mean_list_500_2000 = c()
growth_coal_proportion_500_2000 = c()
bottleneck_coal_proportion_500_2000 = c()
ancestral_coal_proportion_500_2000 = c()
msprime_time_500_2000 = c()
msprime_nu_shape_500_2000 = c()
growth_b_len_proportion_mean_500_2000 = c()
bottleneck_b_len_proportion_mean_500_2000 = c()
ancestral_b_len_proportion_mean_500_2000 = c()
# Iterate through sample size and replicate
for (i in sample_size) {
this_sample_size_distribution = c() # Initialize
msprime_demography_500_2000 = paste0(
"../Analysis/msprime_3EpB_500_2000_", i, '/two_epoch_demography.txt')
msprime_nu_500_2000 = nu_from_demography(msprime_demography_500_2000)
msprime_time_500_2000 = c(msprime_time_500_2000, time_from_demography(msprime_demography_500_2000))
if (is.na(msprime_nu_500_2000)) {
msprime_nu_shape_500_2000 = c(msprime_nu_shape_500_2000, NA)
} else if (msprime_nu_500_2000 > 1) {
msprime_nu_shape_500_2000 = c(msprime_nu_shape_500_2000, 'msprime_expand')
} else {
msprime_nu_shape_500_2000 = c(msprime_nu_shape_500_2000, 'msprime_contract')
}
for (j in seq(from=1, to=5, by=1)) {
this_replicate_distribution = paste0(
"../Simulations/simple_simulations/ThreeEpochBottleneck_500_2000_",
i, '_coal_dist_',
j, '.csv')
# Read in the appropriate file
this_csv = read.csv(this_replicate_distribution, header=TRUE)
this_sample_size_distribution = c(this_sample_size_distribution, this_csv$generations)
}
this_b_len_growth = c()
this_b_len_bottleneck = c()
this_b_len_ancestral = c()
for (g in seq(from=1, to=5, by=1)) {
this_branch_distribution = paste0(
"../Simulations/simple_simulations/ThreeEpochBottleneck_500_2000_",
i, '_branch_length_dist_',
g, '.csv')
if (file.exists(this_branch_distribution)) {
} else {
next
}
# Read in the appropriate file
this_b_len_csv = read.csv(this_branch_distribution, header=TRUE)
growth_sum = sum(this_b_len_csv[this_b_len_csv$node_generations <= 200, ]$branch_length)
bottleneck_sum = sum(this_b_len_csv[this_b_len_csv$node_generations > 200 &
this_b_len_csv$node_generations<= 2000, ]$branch_length)
ancestral_sum = sum(this_b_len_csv[this_b_len_csv$node_generations > 2000, ]$branch_length)
total_branch_length = growth_sum + bottleneck_sum + ancestral_sum
this_b_len_growth = c(this_b_len_growth, growth_sum / total_branch_length)
this_b_len_bottleneck = c(this_b_len_bottleneck, bottleneck_sum / total_branch_length)
this_b_len_ancestral = c(this_b_len_ancestral, ancestral_sum / total_branch_length)
}
# Take the mean of coalescent times for this sample size's distribution
mean_list_500_2000 = c(mean_list_500_2000, mean(this_sample_size_distribution))
# Similarly, take standard deviation
# Lastly find the proportion of coalescent events in each epoch
growth_coal_proportion_500_2000 = c(growth_coal_proportion_500_2000,
mean(this_sample_size_distribution <= 200))
bottleneck_coal_proportion_500_2000 = c(bottleneck_coal_proportion_500_2000,
mean(this_sample_size_distribution <= 2000) - mean(this_sample_size_distribution < 200))
ancestral_coal_proportion_500_2000 = c(ancestral_coal_proportion_500_2000,
mean(this_sample_size_distribution > 2000))
# Mean and sd of branch length proportions by epoch
growth_b_len_proportion_mean_500_2000 = c(growth_b_len_proportion_mean_500_2000, mean(this_b_len_growth))
bottleneck_b_len_proportion_mean_500_2000 = c(bottleneck_b_len_proportion_mean_500_2000, mean(this_b_len_bottleneck))
ancestral_b_len_proportion_mean_500_2000 = c(ancestral_b_len_proportion_mean_500_2000, mean(this_b_len_ancestral))
}
