ylab("Tajima's D") +
ggtitle("Tajima's D, Three Epoch Contraction") +
scale_colour_manual(
values = c("ThreeEpochC_dadi_tajima_d"='red',
"ThreeEpochC_msprime_tajima_d"='blue',
"ThreeEpochC_lynch_tajima_d"='green'),
labels = c("Dadi", "MSPrime", "Lynch Theory")
) +
geom_hline(yintercept = 0, size = 2, linetype = 'dashed')
ggplot(data=ThreeEpochE_tajima_d_df, aes(x=sample_size, y=value, color=variable)) + geom_line(size=2) +
theme_bw() + guides(color=guide_legend(title="Type of SFS")) +
xlab('Sample size') +
ylab("Tajima's D") +
ggtitle("Tajima's D, Three Epoch Expansion") +
scale_colour_manual(
values = c("ThreeEpochE_dadi_tajima_d"='red',
"ThreeEpochE_msprime_tajima_d"='blue',
"ThreeEpochE_lynch_tajima_d"='green'),
labels = c("Dadi", "MSPrime", "Lynch Theory")
) +
geom_hline(yintercept = 0, size = 2, linetype = 'dashed')
ggplot(data=ThreeEpochB_tajima_d_df, aes(x=sample_size, y=value, color=variable)) + geom_line(size=2) +
theme_bw() + guides(color=guide_legend(title="Type of SFS")) +
xlab('Sample size') +
ylab("Tajima's D") +
ggtitle("Tajima's D, Three-epoch Bottleneck + Growth") +
scale_colour_manual(
values = c("ThreeEpochB_dadi_tajima_d"='red',
"ThreeEpochB_msprime_tajima_d"='blue',
"ThreeEpochB_lynch_tajima_d"='green'),
labels = c("Dadi", "MSPrime", "Lynch Theory")
) +
geom_hline(yintercept = 0, size = 2, linetype = 'dashed')
tennessen_lynch_tajima_d = c()
# Loop through subdirectories and get relevant files
for (i in seq(from=10, to=800, by=10)) {
# Lynch
j = i + 1
subdirectory_lynch_tennessen <- paste0("../Analysis/optimal_sample_size_test/tennessen_", j)
tennessen_lynch_summary <- paste0(subdirectory_lynch_tennessen, "_summary.txt")
tennessen_lynch_tajima_d = c(ThreeEpochE_lynch_tajima_d, read_summary_statistics(ThreeEpochE_lynch_summary)[3])
}
tennessen_lynch_tajima_d
tennessen_tajima_d_df = data.frame(tennessen_lynch_tajima_d, sample_size_index)
length(tennessen_lynch_tajima_d)
tennessen_lynch_tajima_d = c()
# Loop through subdirectories and get relevant files
for (i in seq(from=10, to=800, by=10)) {
# Lynch
j = i + 1
subdirectory_lynch_tennessen <- paste0("../Analysis/optimal_sample_size_test/tennessen_", j)
tennessen_lynch_summary <- paste0(subdirectory_lynch_tennessen, "_summary.txt")
tennessen_lynch_tajima_d = c(ThreeEpochE_lynch_tajima_d, read_summary_statistics(ThreeEpochE_lynch_summary)[3])
}
length(tennessen_lynch_tajima_d)
sample_size_index = seq(10, 800, 10)
length(sample_size_index)
# Loop through subdirectories and get relevant files
for (i in seq(from=10, to=799, by=10)) {
# Lynch
j = i + 1
subdirectory_lynch_tennessen <- paste0("../Analysis/optimal_sample_size_test/tennessen_", j)
tennessen_lynch_summary <- paste0(subdirectory_lynch_tennessen, "_summary.txt")
tennessen_lynch_tajima_d = c(ThreeEpochE_lynch_tajima_d, read_summary_statistics(ThreeEpochE_lynch_summary)[3])
}
tennessen_lynch_tajima_d = c()
# Loop through subdirectories and get relevant files
for (i in seq(from=10, to=799, by=10)) {
# Lynch
j = i + 1
subdirectory_lynch_tennessen <- paste0("../Analysis/optimal_sample_size_test/tennessen_", j)
tennessen_lynch_summary <- paste0(subdirectory_lynch_tennessen, "_summary.txt")
tennessen_lynch_tajima_d = c(ThreeEpochE_lynch_tajima_d, read_summary_statistics(ThreeEpochE_lynch_summary)[3])
}
tennessen_tajima_d_df = data.frame(tennessen_lynch_tajima_d, sample_size_index)
tennessen_lynch_tajima_d = c()
# Loop through subdirectories and get relevant files
for (i in seq(from=10, to=790, by=10)) {
# Lynch
j = i + 1
subdirectory_lynch_tennessen <- paste0("../Analysis/optimal_sample_size_test/tennessen_", j)
tennessen_lynch_summary <- paste0(subdirectory_lynch_tennessen, "_summary.txt")
tennessen_lynch_tajima_d = c(ThreeEpochE_lynch_tajima_d, read_summary_statistics(ThreeEpochE_lynch_summary)[3])
}
tennessen_tajima_d_df = data.frame(tennessen_lynch_tajima_d, sample_size_index)
tennessen_lynch_tajima_d = c()
length(tennessen_lynch_tajima_d)
# Loop through subdirectories and get relevant files
for (i in seq(from=10, to=490, by=10)) {
# Lynch
j = i + 1
subdirectory_lynch_tennessen <- paste0("../Analysis/optimal_sample_size_test/tennessen_", j)
tennessen_lynch_summary <- paste0(subdirectory_lynch_tennessen, "_summary.txt")
tennessen_lynch_tajima_d = c(ThreeEpochE_lynch_tajima_d, read_summary_statistics(ThreeEpochE_lynch_summary)[3])
}
length(tennessen_lynch_tajima_d)
tennessen_lynch_tajima_d = c()
# Loop through subdirectories and get relevant files
for (i in seq(from=10, to=490, by=10)) {
# Lynch
j = i + 1
subdirectory_lynch_tennessen <- paste0("../Analysis/optimal_sample_size_test/tennessen_", j)
tennessen_lynch_summary <- paste0(subdirectory_lynch_tennessen, "_summary.txt")
tennessen_lynch_tajima_d = c(tennessen_lynch_tajima_d, read_summary_statistics(tennessen_lynch_summary)[3])
}
tennessen_lynch_tajima_d = c()
# Loop through subdirectories and get relevant files
for (i in seq(from=10, to=490, by=10)) {
# Lynch
j = i + 1
subdirectory_lynch_tennessen <- paste0("../Analysis/optimal_sample_size_test/tennessen_", j)
tennessen_lynch_summary <- paste0(subdirectory_lynch_tennessen, "_summary.txt")
tennessen_lynch_tajima_d = c(tennessen_lynch_tajima_d, read_summary_statistics(tennessen_lynch_summary)[3])
}
tennessen_tajima_d_df = data.frame(tennessen_lynch_tajima_d, sample_size_index)
tennessen_lynch_tajima_d = c()
# Loop through subdirectories and get relevant files
for (i in seq(from=10, to=800, by=10)) {
# Lynch
j = i + 1
subdirectory_lynch_tennessen <- paste0("../Analysis/optimal_sample_size_test/tennessen_", j)
tennessen_lynch_summary <- paste0(subdirectory_lynch_tennessen, "_summary.txt")
tennessen_lynch_tajima_d = c(tennessen_lynch_tajima_d, read_summary_statistics(tennessen_lynch_summary)[3])
}
tennessen_tajima_d_df = data.frame(tennessen_lynch_tajima_d, sample_size_index)
ggplot(data=tennessen_tajima_d_df, aes(x=sample_size, y=value, color=variable)) + geom_line(size=2) +
theme_bw() + guides(color=guide_legend(title="Type of SFS")) +
xlab('Sample size') +
ylab("Tajima's D") +
ggtitle("Tajima's D, Three-epoch Bottleneck + Growth") +
scale_colour_manual(
values = c("tennessen_lynch_tajima_d"='green'),
labels = c("Lynch Theory")
) +
geom_hline(yintercept = 0, size = 2, linetype = 'dashed')
tennessen_lynch_tajima_d = c()
# Loop through subdirectories and get relevant files
for (i in seq(from=10, to=800, by=10)) {
# Lynch
j = i + 1
subdirectory_lynch_tennessen <- paste0("../Analysis/optimal_sample_size_test/tennessen_", j)
tennessen_lynch_summary <- paste0(subdirectory_lynch_tennessen, "_summary.txt")
tennessen_lynch_tajima_d = c(tennessen_lynch_tajima_d, read_summary_statistics(tennessen_lynch_summary)[3])
}
tennessen_tajima_d_df = data.frame(tennessen_lynch_tajima_d)
tennessen_tajima_d_df$sample_size = sample_size_index
ggplot(data=tennessen_tajima_d_df, aes(x=sample_size, y=value, color=variable)) + geom_line(size=2) +
theme_bw() + guides(color=guide_legend(title="Type of SFS")) +
xlab('Sample size') +
ylab("Tajima's D") +
ggtitle("Tajima's D, Three-epoch Bottleneck + Growth") +
scale_colour_manual(
values = c("tennessen_lynch_tajima_d"='green'),
labels = c("Lynch Theory")
) +
geom_hline(yintercept = 0, size = 2, linetype = 'dashed')
tennessen_tajima_d_df = melt(data.frame(tennessen_lynch_tajima_d))
tennessen_lynch_tajima_d = c()
# Loop through subdirectories and get relevant files
for (i in seq(from=10, to=800, by=10)) {
# Lynch
j = i + 1
subdirectory_lynch_tennessen <- paste0("../Analysis/optimal_sample_size_test/tennessen_", j)
tennessen_lynch_summary <- paste0(subdirectory_lynch_tennessen, "_summary.txt")
tennessen_lynch_tajima_d = c(tennessen_lynch_tajima_d, read_summary_statistics(tennessen_lynch_summary)[3])
}
tennessen_tajima_d_df = melt(data.frame(tennessen_lynch_tajima_d))
tennessen_tajima_d_df$sample_size = sample_size_index
ggplot(data=tennessen_tajima_d_df, aes(x=sample_size, y=value, color=variable)) + geom_line(size=2) +
theme_bw() + guides(color=guide_legend(title="Type of SFS")) +
xlab('Sample size') +
ylab("Tajima's D") +
ggtitle("Tajima's D, Three-epoch Bottleneck + Growth") +
scale_colour_manual(
values = c("tennessen_lynch_tajima_d"='green'),
labels = c("Lynch Theory")
) +
geom_hline(yintercept = 0, size = 2, linetype = 'dashed')
ggplot(data=tennessen_tajima_d_df, aes(x=sample_size, y=value, color=variable)) + geom_line(size=2) +
theme_bw() + guides(color=guide_legend(title="Type of SFS")) +
xlab('Sample size') +
ylab("Tajima's D") +
ggtitle("Tajima's D, Tennessen model") +
scale_colour_manual(
values = c("tennessen_lynch_tajima_d"='green'),
labels = c("Lynch Theory")
) +
geom_hline(yintercept = 0, size = 2, linetype = 'dashed')
tennessen_lynch_tajima_d = c()
# Loop through subdirectories and get relevant files
for (i in seq(from=10, to=800, by=10)) {
# Lynch
j = i + 1
subdirectory_lynch_tennessen <- paste0("../Analysis/optimal_sample_size_test/tennessen_", j)
tennessen_lynch_summary <- paste0(subdirectory_lynch_tennessen, "_summary.txt")
tennessen_lynch_tajima_d = c(tennessen_lynch_tajima_d, read_summary_statistics(tennessen_lynch_summary)[3])
}
tennessen_tajima_d_df = melt(data.frame(tennessen_lynch_tajima_d))
tennessen_tajima_d_df$sample_size = sample_size_index
ggplot(data=tennessen_tajima_d_df, aes(x=sample_size, y=value, color=variable)) + geom_line(size=2) +
theme_bw() + guides(color=guide_legend(title="Type of SFS")) +
xlab('Sample size') +
ylab("Tajima's D") +
ggtitle("Tajima's D, Tennessen model") +
scale_colour_manual(
values = c("tennessen_lynch_tajima_d"='green'),
labels = c("Lynch Theory")
) +
geom_hline(yintercept = 0, size = 2, linetype = 'dashed')
tennessen_lynch_tajima_d = c()
# Loop through subdirectories and get relevant files
for (i in seq(from=10, to=800, by=10)) {
# Lynch
j = i + 1
subdirectory_lynch_tennessen <- paste0("../Analysis/optimal_sample_size_test/tennessen_", j)
tennessen_lynch_summary <- paste0(subdirectory_lynch_tennessen, "_summary.txt")
tennessen_lynch_tajima_d = c(tennessen_lynch_tajima_d, read_summary_statistics(tennessen_lynch_summary)[3])
}
tennessen_tajima_d_df = melt(data.frame(tennessen_lynch_tajima_d))
tennessen_tajima_d_df$sample_size = sample_size_index
ggplot(data=tennessen_tajima_d_df, aes(x=sample_size, y=value, color=variable)) + geom_line(size=2) +
theme_bw() + guides(color=guide_legend(title="Type of SFS")) +
xlab('Sample size') +
ylab("Tajima's D") +
ggtitle("Tajima's D, Tennessen model") +
scale_colour_manual(
values = c("tennessen_lynch_tajima_d"='green'),
labels = c("Lynch Theory")
) +
geom_hline(yintercept = 0, size = 2, linetype = 'dashed')
compare_msprime_dadi_lynch_proportional_sfs = function(null, msprime, dadi, lynch) {
if (length(msprime) > 10) {
x_axis = 1:10
null = proportional_sfs(null)[1:10]
msprime = proportional_sfs(msprime)[1:10]
dadi = proportional_sfs(dadi)[1:10]
lynch = proportional_sfs(lynch)[1:10]
} else {
x_axis = 1:length(msprime)
null = proportional_sfs(null)
msprime = proportional_sfs(msprime)
dadi = proportional_sfs(dadi)
lynch = proportional_sfs(lynch)
}
input_df = data.frame(null,
msprime,
dadi,
lynch,
x_axis)
names(input_df) = c('SNM',
'MSPrime',
'Dadi projection',
'Lynch Theoretical',
'x_axis')
p_input_comparison <- ggplot(data = melt(input_df, id='x_axis'),
aes(x=x_axis,
y=value,
fill=variable)) +
geom_bar(position='dodge2', stat='identity') +
labs(x = "", fill = "") +
scale_x_continuous(name='Minor allele frequency in sample', breaks=x_axis, limits=c(0.5, length(x_axis) + 0.5)) +
ylab('Proportion of segregating sites') +
theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
return(p_input_comparison)
}
compare_msprime_dadi_lynch_proportional_sfs_bottleneck = function(null, msprime, dadi, lynch, lynch_1000, lynch_2000) {
if (length(msprime) > 10) {
x_axis = 1:10
null = proportional_sfs(null)[1:10]
msprime = proportional_sfs(msprime)[1:10]
dadi = proportional_sfs(dadi)[1:10]
lynch = proportional_sfs(lynch)[1:10]
lynch_1000 = proportional_sfs(lynch_1000)[1:10]
lynch_2000 = proportional_sfs(lynch_2000)[1:10]
} else {
x_axis = 1:length(msprime)
null = proportional_sfs(null)
msprime = proportional_sfs(msprime)
dadi = proportional_sfs(dadi)
lynch = proportional_sfs(lynch)
lynch_1000 = proportional_sfs(lynch_1000)
lynch_2000 = proportional_sfs(lynch_2000)
}
input_df = data.frame(null,
msprime,
dadi,
lynch,
lynch_1000,
lynch_2000,
x_axis)
names(input_df) = c('SNM',
'MSPrime',
'Dadi projection',
'Lynch Theoretical',
'Lynch (1000, 1000)',
'Lynch (2000, 2000)',
'x_axis')
p_input_comparison <- ggplot(data = melt(input_df, id='x_axis'),
aes(x=x_axis,
y=value,
fill=variable)) +
geom_bar(position='dodge2', stat='identity') +
labs(x = "", fill = "") +
scale_x_continuous(name='Minor allele frequency in sample', breaks=x_axis, limits=c(0.5, length(x_axis) + 0.5)) +
ylab('Proportion of segregating sites') +
theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
return(p_input_comparison)
}
TwoEpochC_10_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpC_11_expected_sfs.txt')
TwoEpochE_10_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpE_11_expected_sfs.txt')
ThreeEpochC_10_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpC_11_expected_sfs.txt')
ThreeEpochE_10_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpE_11_expected_sfs.txt')
ThreeEpochB_10_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpB_11_expected_sfs.txt')
lynch_1000_1000_10_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/1000_1000_11_expected_sfs.txt')
TwoEpochC_10_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpC_11_expected_sfs.txt')
TwoEpochE_10_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpE_11_expected_sfs.txt')
ThreeEpochC_10_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpC_11_expected_sfs.txt')
ThreeEpochE_10_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpE_11_expected_sfs.txt')
ThreeEpochB_10_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpB_11_expected_sfs.txt')
lynch_1000_1000_10_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/1000_1000_bottleneck_11_expected_sfs.txt')
lynch_2000_2000_10_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2000_2000_bottleneck_11_expected_sfs.txt')
TwoEpochC_20_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpC_21_expected_sfs.txt')
TwoEpochE_20_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpE_21_expected_sfs.txt')
ThreeEpochC_20_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpC_21_expected_sfs.txt')
ThreeEpochE_20_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpE_21_expected_sfs.txt')
ThreeEpochB_20_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpB_21_expected_sfs.txt')
lynch_1000_1000_20_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/1000_1000_bottleneck_21_expected_sfs.txt')
lynch_2000_2000_20_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2000_2000_bottleneck_21_expected_sfs.txt')
TwoEpochC_30_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpC_31_expected_sfs.txt')
TwoEpochE_30_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpE_31_expected_sfs.txt')
ThreeEpochC_30_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpC_31_expected_sfs.txt')
ThreeEpochE_30_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpE_31_expected_sfs.txt')
ThreeEpochB_30_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpB_31_expected_sfs.txt')
lynch_1000_1000_30_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/1000_1000_bottleneck_31_expected_sfs.txt')
lynch_2000_2000_30_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2000_2000_bottleneck_31_expected_sfs.txt')
TwoEpochC_40_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpC_41_expected_sfs.txt')
TwoEpochE_40_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpE_41_expected_sfs.txt')
ThreeEpochC_40_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpC_41_expected_sfs.txt')
ThreeEpochE_40_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpE_41_expected_sfs.txt')
ThreeEpochB_40_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpB_41_expected_sfs.txt')
lynch_1000_1000_40_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/1000_1000_bottleneck_41_expected_sfs.txt')
lynch_2000_2000_40_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2000_2000_bottleneck_41_expected_sfs.txt')
TwoEpochC_50_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpC_51_expected_sfs.txt')
TwoEpochE_50_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpE_51_expected_sfs.txt')
ThreeEpochC_50_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpC_51_expected_sfs.txt')
ThreeEpochE_50_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpE_51_expected_sfs.txt')
ThreeEpochB_50_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpB_51_expected_sfs.txt')
lynch_1000_1000_50_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/1000_1000_bottleneck_51_expected_sfs.txt')
lynch_2000_2000_50_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2000_2000_bottleneck_51_expected_sfs.txt')
TwoEpochC_60_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpC_61_expected_sfs.txt')
TwoEpochE_60_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpE_61_expected_sfs.txt')
ThreeEpochC_60_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpC_61_expected_sfs.txt')
ThreeEpochE_60_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpE_61_expected_sfs.txt')
ThreeEpochB_60_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpB_61_expected_sfs.txt')
lynch_1000_1000_60_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/1000_1000_bottleneck_61_expected_sfs.txt')
lynch_2000_2000_60_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2000_2000_bottleneck_61_expected_sfs.txt')
TwoEpochC_70_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpC_71_expected_sfs.txt')
TwoEpochE_70_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpE_71_expected_sfs.txt')
ThreeEpochC_70_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpC_71_expected_sfs.txt')
ThreeEpochE_70_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpE_71_expected_sfs.txt')
ThreeEpochB_70_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpB_71_expected_sfs.txt')
lynch_1000_1000_70_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/1000_1000_bottleneck_71_expected_sfs.txt')
lynch_2000_2000_70_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2000_2000_bottleneck_71_expected_sfs.txt')
TwoEpochC_80_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpC_81_expected_sfs.txt')
TwoEpochE_80_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpE_81_expected_sfs.txt')
ThreeEpochC_80_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpC_81_expected_sfs.txt')
ThreeEpochE_80_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpE_81_expected_sfs.txt')
ThreeEpochB_80_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpB_81_expected_sfs.txt')
lynch_1000_1000_80_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/1000_1000_bottleneck_81_expected_sfs.txt')
lynch_2000_2000_80_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2000_2000_bottleneck_81_expected_sfs.txt')
TwoEpochC_90_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpC_91_expected_sfs.txt')
TwoEpochE_90_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpE_91_expected_sfs.txt')
ThreeEpochC_90_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpC_91_expected_sfs.txt')
ThreeEpochE_90_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpE_91_expected_sfs.txt')
ThreeEpochB_90_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpB_91_expected_sfs.txt')
lynch_1000_1000_90_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/1000_1000_bottleneck_91_expected_sfs.txt')
lynch_2000_2000_90_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2000_2000_bottleneck_91_expected_sfs.txt')
TwoEpochC_100_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpC_101_expected_sfs.txt')
TwoEpochE_100_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpE_101_expected_sfs.txt')
ThreeEpochC_100_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpC_101_expected_sfs.txt')
ThreeEpochE_100_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpE_101_expected_sfs.txt')
ThreeEpochB_100_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpB_101_expected_sfs.txt')
lynch_1000_1000_100_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/1000_1000_bottleneck_101_expected_sfs.txt')
lynch_2000_2000_100_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2000_2000_bottleneck_101_expected_sfs.txt')
compare_msprime_dadi_lynch_proportional_sfs_bottleneck(one_epoch_10_SFS,
ThreeEpochB_10_msprime_SFS, ThreeEpochB_10_dadi_projection_SFS,
ThreeEpochB_10_lynch_SFS, lynch_1000_1000_10_SFS, lynch_2000_2000_10_SFS) +
ggtitle('Three Epoch Bottleneck, k=10') +
compare_msprime_dadi_lynch_proportional_sfs_bottleneck(one_epoch_20_SFS,
ThreeEpochB_20_msprime_SFS, ThreeEpochB_20_dadi_projection_SFS,
ThreeEpochB_20_lynch_SFS, lynch_1000_1000_20_SFS, lynch_2000_2000_20_SFS) +
ggtitle('Three Epoch Bottleneck, k=20') +
compare_msprime_dadi_lynch_proportional_sfs_bottleneck(one_epoch_30_SFS,
ThreeEpochB_30_msprime_SFS, ThreeEpochB_30_dadi_projection_SFS,
ThreeEpochB_30_lynch_SFS, lynch_1000_1000_30_SFS, lynch_2000_2000_30_SFS) +
ggtitle('Three Epoch Bottleneck, k=30') +
compare_msprime_dadi_lynch_proportional_sfs_bottleneck(one_epoch_40_SFS,
ThreeEpochB_40_msprime_SFS, ThreeEpochB_40_dadi_projection_SFS,
ThreeEpochB_40_lynch_SFS, lynch_1000_1000_40_SFS, lynch_2000_2000_40_SFS) +
ggtitle('Three Epoch Bottleneck, k=40') +
compare_msprime_dadi_lynch_proportional_sfs_bottleneck(one_epoch_50_SFS,
ThreeEpochB_50_msprime_SFS, ThreeEpochB_50_dadi_projection_SFS,
ThreeEpochB_50_lynch_SFS, lynch_1000_1000_50_SFS, lynch_2000_2000_50_SFS) +
ggtitle('Three Epoch Bottleneck, k=50') +
compare_msprime_dadi_lynch_proportional_sfs_bottleneck(one_epoch_60_SFS,
ThreeEpochB_60_msprime_SFS, ThreeEpochB_60_dadi_projection_SFS,
ThreeEpochB_60_lynch_SFS, lynch_1000_1000_60_SFS, lynch_2000_2000_60_SFS) +
ggtitle('Three Epoch Bottleneck, k=60') +
compare_msprime_dadi_lynch_proportional_sfs_bottleneck(one_epoch_70_SFS,
ThreeEpochB_70_msprime_SFS, ThreeEpochB_70_dadi_projection_SFS,
ThreeEpochB_70_lynch_SFS, lynch_1000_1000_70_SFS, lynch_2000_2000_70_SFS) +
ggtitle('Three Epoch Bottleneck, k=70') +
compare_msprime_dadi_lynch_proportional_sfs_bottleneck(one_epoch_80_SFS,
ThreeEpochB_80_msprime_SFS, ThreeEpochB_80_dadi_projection_SFS,
ThreeEpochB_80_lynch_SFS, lynch_1000_1000_80_SFS, lynch_2000_2000_80_SFS) +
ggtitle('Three Epoch Bottleneck, k=80') +
compare_msprime_dadi_lynch_proportional_sfs_bottleneck(one_epoch_90_SFS,
ThreeEpochB_90_msprime_SFS, ThreeEpochB_90_dadi_projection_SFS,
ThreeEpochB_90_lynch_SFS, lynch_1000_1000_90_SFS, lynch_2000_2000_90_SFS) +
ggtitle('Three Epoch Bottleneck, k=90') +
compare_msprime_dadi_lynch_proportional_sfs_bottleneck(one_epoch_100_SFS,
ThreeEpochB_100_msprime_SFS, ThreeEpochB_100_dadi_projection_SFS,
ThreeEpochB_100_lynch_SFS, lynch_1000_1000_100_SFS, lynch_2000_2000_100_SFS) +
ggtitle('Three Epoch Bottleneck, k=100') +
plot_layout(nrow=5)
compare_msprime_dadi_lynch_proportional_sfs_bottleneck = function(null, msprime, dadi, lynch, lynch_1000, lynch_2000) {
if (length(msprime) > 5) {
x_axis = 1:5
null = proportional_sfs(null)[1:5]
msprime = proportional_sfs(msprime)[1:5]
dadi = proportional_sfs(dadi)[1:5]
lynch = proportional_sfs(lynch)[1:5]
lynch_1000 = proportional_sfs(lynch_1000)[1:5]
lynch_2000 = proportional_sfs(lynch_2000)[1:5]
} else {
x_axis = 1:length(msprime)
null = proportional_sfs(null)
msprime = proportional_sfs(msprime)
dadi = proportional_sfs(dadi)
lynch = proportional_sfs(lynch)
lynch_1000 = proportional_sfs(lynch_1000)
lynch_2000 = proportional_sfs(lynch_2000)
}
input_df = data.frame(null,
msprime,
dadi,
lynch,
lynch_1000,
lynch_2000,
x_axis)
names(input_df) = c('SNM',
'MSPrime',
'Dadi projection',
'Lynch Theoretical',
'Lynch (1000, 1000)',
'Lynch (2000, 2000)',
'x_axis')
p_input_comparison <- ggplot(data = melt(input_df, id='x_axis'),
aes(x=x_axis,
y=value,
fill=variable)) +
geom_bar(position='dodge2', stat='identity') +
labs(x = "", fill = "") +
scale_x_continuous(name='Minor allele frequency in sample', breaks=x_axis, limits=c(0.5, length(x_axis) + 0.5)) +
ylab('Proportion of segregating sites') +
theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
return(p_input_comparison)
}
compare_msprime_dadi_lynch_proportional_sfs_bottleneck(one_epoch_10_SFS,
ThreeEpochB_10_msprime_SFS, ThreeEpochB_10_dadi_projection_SFS,
ThreeEpochB_10_lynch_SFS, lynch_1000_1000_10_SFS, lynch_2000_2000_10_SFS) +
ggtitle('Three Epoch Bottleneck, k=10') +
compare_msprime_dadi_lynch_proportional_sfs_bottleneck(one_epoch_20_SFS,
ThreeEpochB_20_msprime_SFS, ThreeEpochB_20_dadi_projection_SFS,
ThreeEpochB_20_lynch_SFS, lynch_1000_1000_20_SFS, lynch_2000_2000_20_SFS) +
ggtitle('Three Epoch Bottleneck, k=20') +
compare_msprime_dadi_lynch_proportional_sfs_bottleneck(one_epoch_30_SFS,
ThreeEpochB_30_msprime_SFS, ThreeEpochB_30_dadi_projection_SFS,
ThreeEpochB_30_lynch_SFS, lynch_1000_1000_30_SFS, lynch_2000_2000_30_SFS) +
ggtitle('Three Epoch Bottleneck, k=30') +
compare_msprime_dadi_lynch_proportional_sfs_bottleneck(one_epoch_40_SFS,
ThreeEpochB_40_msprime_SFS, ThreeEpochB_40_dadi_projection_SFS,
ThreeEpochB_40_lynch_SFS, lynch_1000_1000_40_SFS, lynch_2000_2000_40_SFS) +
ggtitle('Three Epoch Bottleneck, k=40') +
compare_msprime_dadi_lynch_proportional_sfs_bottleneck(one_epoch_50_SFS,
ThreeEpochB_50_msprime_SFS, ThreeEpochB_50_dadi_projection_SFS,
ThreeEpochB_50_lynch_SFS, lynch_1000_1000_50_SFS, lynch_2000_2000_50_SFS) +
ggtitle('Three Epoch Bottleneck, k=50') +
compare_msprime_dadi_lynch_proportional_sfs_bottleneck(one_epoch_60_SFS,
ThreeEpochB_60_msprime_SFS, ThreeEpochB_60_dadi_projection_SFS,
ThreeEpochB_60_lynch_SFS, lynch_1000_1000_60_SFS, lynch_2000_2000_60_SFS) +
ggtitle('Three Epoch Bottleneck, k=60') +
compare_msprime_dadi_lynch_proportional_sfs_bottleneck(one_epoch_70_SFS,
ThreeEpochB_70_msprime_SFS, ThreeEpochB_70_dadi_projection_SFS,
ThreeEpochB_70_lynch_SFS, lynch_1000_1000_70_SFS, lynch_2000_2000_70_SFS) +
ggtitle('Three Epoch Bottleneck, k=70') +
compare_msprime_dadi_lynch_proportional_sfs_bottleneck(one_epoch_80_SFS,
ThreeEpochB_80_msprime_SFS, ThreeEpochB_80_dadi_projection_SFS,
ThreeEpochB_80_lynch_SFS, lynch_1000_1000_80_SFS, lynch_2000_2000_80_SFS) +
ggtitle('Three Epoch Bottleneck, k=80') +
compare_msprime_dadi_lynch_proportional_sfs_bottleneck(one_epoch_90_SFS,
ThreeEpochB_90_msprime_SFS, ThreeEpochB_90_dadi_projection_SFS,
ThreeEpochB_90_lynch_SFS, lynch_1000_1000_90_SFS, lynch_2000_2000_90_SFS) +
ggtitle('Three Epoch Bottleneck, k=90') +
compare_msprime_dadi_lynch_proportional_sfs_bottleneck(one_epoch_100_SFS,
ThreeEpochB_100_msprime_SFS, ThreeEpochB_100_dadi_projection_SFS,
ThreeEpochB_100_lynch_SFS, lynch_1000_1000_100_SFS, lynch_2000_2000_100_SFS) +
ggtitle('Three Epoch Bottleneck, k=100') +
plot_layout(nrow=5)
