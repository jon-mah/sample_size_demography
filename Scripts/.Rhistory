ThreeEpochE_80_msprime_SFS = read_input_sfs('../Simulations/simple_simulations/ThreeEpochExpansion_80_concat.sfs')
ThreeEpochB_80_msprime_SFS = read_input_sfs('../Simulations/simple_simulations/ThreeEpochBottleneck_80_concat.sfs')
TwoEpochC_90_msprime_SFS = read_input_sfs('../Simulations/simple_simulations/TwoEpochContraction_90_concat.sfs')
TwoEpochE_90_msprime_SFS = read_input_sfs('../Simulations/simple_simulations/TwoEpochExpansion_90_concat.sfs')
ThreeEpochC_90_msprime_SFS = read_input_sfs('../Simulations/simple_simulations/ThreeEpochContraction_90_concat.sfs')
ThreeEpochE_90_msprime_SFS = read_input_sfs('../Simulations/simple_simulations/ThreeEpochExpansion_90_concat.sfs')
ThreeEpochB_90_msprime_SFS = read_input_sfs('../Simulations/simple_simulations/ThreeEpochBottleneck_90_concat.sfs')
TwoEpochC_100_msprime_SFS = read_input_sfs('../Simulations/simple_simulations/TwoEpochContraction_100_concat.sfs')
TwoEpochE_100_msprime_SFS = read_input_sfs('../Simulations/simple_simulations/TwoEpochExpansion_100_concat.sfs')
ThreeEpochC_100_msprime_SFS = read_input_sfs('../Simulations/simple_simulations/ThreeEpochContraction_100_concat.sfs')
ThreeEpochE_100_msprime_SFS = read_input_sfs('../Simulations/simple_simulations/ThreeEpochExpansion_100_concat.sfs')
ThreeEpochB_100_msprime_SFS = read_input_sfs('../Simulations/simple_simulations/ThreeEpochBottleneck_100_concat.sfs')
TwoEpochC_10_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpC_11_expected_sfs.txt')
TwoEpochE_10_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpE_11_expected_sfs.txt')
ThreeEpochC_10_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpC_11_expected_sfs.txt')
ThreeEpochE_10_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpE_11_expected_sfs.txt')
ThreeEpochB_10_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpB_11_expected_sfs.txt')
TwoEpochC_20_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpC_21_expected_sfs.txt')
TwoEpochE_20_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpE_21_expected_sfs.txt')
ThreeEpochC_20_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpC_21_expected_sfs.txt')
ThreeEpochE_20_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpE_21_expected_sfs.txt')
ThreeEpochB_20_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpB_21_expected_sfs.txt')
TwoEpochC_30_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpC_31_expected_sfs.txt')
TwoEpochE_30_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpE_31_expected_sfs.txt')
ThreeEpochC_30_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpC_31_expected_sfs.txt')
ThreeEpochE_30_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpE_31_expected_sfs.txt')
ThreeEpochB_30_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpB_31_expected_sfs.txt')
TwoEpochC_40_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpC_11_expected_sfs.txt')
TwoEpochE_40_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpE_11_expected_sfs.txt')
ThreeEpochC_40_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpC_11_expected_sfs.txt')
ThreeEpochE_40_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpE_11_expected_sfs.txt')
ThreeEpochB_40_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpB_11_expected_sfs.txt')
TwoEpochC_50_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpC_11_expected_sfs.txt')
TwoEpochE_50_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpE_11_expected_sfs.txt')
ThreeEpochC_50_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpC_11_expected_sfs.txt')
ThreeEpochE_50_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpE_11_expected_sfs.txt')
ThreeEpochB_50_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpB_11_expected_sfs.txt')
TwoEpochC_60_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpC_11_expected_sfs.txt')
TwoEpochE_60_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpE_11_expected_sfs.txt')
ThreeEpochC_60_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpC_11_expected_sfs.txt')
ThreeEpochE_60_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpE_11_expected_sfs.txt')
ThreeEpochB_60_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpB_11_expected_sfs.txt')
TwoEpochC_70_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpC_11_expected_sfs.txt')
TwoEpochE_70_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpE_11_expected_sfs.txt')
ThreeEpochC_70_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpC_11_expected_sfs.txt')
ThreeEpochE_70_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpE_11_expected_sfs.txt')
ThreeEpochB_70_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpB_11_expected_sfs.txt')
TwoEpochC_80_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpC_11_expected_sfs.txt')
TwoEpochE_80_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpE_11_expected_sfs.txt')
ThreeEpochC_80_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpC_11_expected_sfs.txt')
ThreeEpochE_80_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpE_11_expected_sfs.txt')
ThreeEpochB_80_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpB_11_expected_sfs.txt')
TwoEpochC_90_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpC_11_expected_sfs.txt')
TwoEpochE_90_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpE_11_expected_sfs.txt')
ThreeEpochC_90_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpC_11_expected_sfs.txt')
ThreeEpochE_90_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpE_11_expected_sfs.txt')
ThreeEpochB_90_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpB_11_expected_sfs.txt')
TwoEpochC_100_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpC_11_expected_sfs.txt')
TwoEpochE_100_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpE_11_expected_sfs.txt')
ThreeEpochC_100_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpC_11_expected_sfs.txt')
ThreeEpochE_100_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpE_11_expected_sfs.txt')
ThreeEpochB_100_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpB_11_expected_sfs.txt')
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_10_SFS, TwoEpochC_10_msprime_SFS,
TwoEpochC_10_dadi_projection_SFS, TwoEpochC_10_lynch_SFS) +
ggtitle('Two Epoch Contraction, k=10') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_10_SFS, TwoEpochE_10_msprime_SFS,
TwoEpochE_10_dadi_projection_SFS, TwoEpochE_10_lynch_SFS) +
ggtitle('Two Epoch Expansion, k=10') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_10_SFS, ThreeEpochC_10_msprime_SFS,
ThreeEpochC_10_dadi_projection_SFS, ThreeEpochC_10_lynch_SFS) +
ggtitle('Three Epoch Contraction, k=10') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_10_SFS, ThreeEpochE_10_msprime_SFS,
ThreeEpochE_10_dadi_projection_SFS, ThreeEpochE_10_lynch_SFS) +
ggtitle('Three Epoch Expansion, k=10') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_10_SFS, ThreeEpochB_10_msprime_SFS,
ThreeEpochB_10_dadi_projection_SFS, ThreeEpochB_10_lynch_SFS) +
ggtitle('Three Epoch Bottleneck, k=10') +
plot_layout(nrow=3)
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_40_SFS, TwoEpochC_40_msprime_SFS,
TwoEpochC_40_dadi_projection_SFS, TwoEpochC_40_lynch_SFS) +
ggtitle('Two Epoch Contraction, k=40') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_40_SFS, TwoEpochE_40_msprime_SFS,
TwoEpochE_40_dadi_projection_SFS, TwoEpochE_40_lynch_SFS) +
ggtitle('Two Epoch Expansion, k=40') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_40_SFS, ThreeEpochC_40_msprime_SFS,
ThreeEpochC_40_dadi_projection_SFS, ThreeEpochC_40_lynch_SFS) +
ggtitle('Three Epoch Contraction, k=40') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_40_SFS, ThreeEpochE_40_msprime_SFS,
ThreeEpochE_40_dadi_projection_SFS, ThreeEpochE_40_lynch_SFS) +
ggtitle('Three Epoch Expansion, k=40') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_40_SFS, ThreeEpochB_40_msprime_SFS,
ThreeEpochB_40_dadi_projection_SFS, ThreeEpochB_40_lynch_SFS) +
ggtitle('Three Epoch Bottleneck, k=40') +
plot_layout(nrow=3)
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_50_SFS, TwoEpochC_50_msprime_SFS,
TwoEpochC_50_dadi_projection_SFS, TwoEpochC_50_lynch_SFS) +
ggtitle('Two Epoch Contraction, k=50') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_50_SFS, TwoEpochE_50_msprime_SFS,
TwoEpochE_50_dadi_projection_SFS, TwoEpochE_50_lynch_SFS) +
ggtitle('Two Epoch Expansion, k=50') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_50_SFS, ThreeEpochC_50_msprime_SFS,
ThreeEpochC_50_dadi_projection_SFS, ThreeEpochC_50_lynch_SFS) +
ggtitle('Three Epoch Contraction, k=50') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_50_SFS, ThreeEpochE_50_msprime_SFS,
ThreeEpochE_50_dadi_projection_SFS, ThreeEpochE_50_lynch_SFS) +
ggtitle('Three Epoch Expansion, k=50') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_50_SFS, ThreeEpochB_50_msprime_SFS,
ThreeEpochB_50_dadi_projection_SFS, ThreeEpochB_50_lynch_SFS) +
ggtitle('Three Epoch Bottleneck, k=50') +
plot_layout(nrow=3)
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_60_SFS, TwoEpochC_60_msprime_SFS,
TwoEpochC_60_dadi_projection_SFS, TwoEpochC_60_lynch_SFS) +
ggtitle('Two Epoch Contraction, k=60') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_60_SFS, TwoEpochE_60_msprime_SFS,
TwoEpochE_60_dadi_projection_SFS, TwoEpochE_60_lynch_SFS) +
ggtitle('Two Epoch Expansion, k=60') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_60_SFS, ThreeEpochC_60_msprime_SFS,
ThreeEpochC_60_dadi_projection_SFS, ThreeEpochC_60_lynch_SFS) +
ggtitle('Three Epoch Contraction, k=60') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_60_SFS, ThreeEpochE_60_msprime_SFS,
ThreeEpochE_60_dadi_projection_SFS, ThreeEpochE_60_lynch_SFS) +
ggtitle('Three Epoch Expansion, k=60') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_60_SFS, ThreeEpochB_60_msprime_SFS,
ThreeEpochB_60_dadi_projection_SFS, ThreeEpochB_60_lynch_SFS) +
ggtitle('Three Epoch Bottleneck, k=60') +
plot_layout(nrow=3)
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_70_SFS, TwoEpochC_70_msprime_SFS,
TwoEpochC_70_dadi_projection_SFS, TwoEpochC_70_lynch_SFS) +
ggtitle('Two Epoch Contraction, k=70') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_70_SFS, TwoEpochE_70_msprime_SFS,
TwoEpochE_70_dadi_projection_SFS, TwoEpochE_70_lynch_SFS) +
ggtitle('Two Epoch Expansion, k=70') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_70_SFS, ThreeEpochC_70_msprime_SFS,
ThreeEpochC_70_dadi_projection_SFS, ThreeEpochC_70_lynch_SFS) +
ggtitle('Three Epoch Contraction, k=70') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_70_SFS, ThreeEpochE_70_msprime_SFS,
ThreeEpochE_70_dadi_projection_SFS, ThreeEpochE_70_lynch_SFS) +
ggtitle('Three Epoch Expansion, k=70') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_70_SFS, ThreeEpochB_70_msprime_SFS,
ThreeEpochB_70_dadi_projection_SFS, ThreeEpochB_70_lynch_SFS) +
ggtitle('Three Epoch Bottleneck, k=70') +
plot_layout(nrow=3)
compare_msprime_dadi_lynch_proportional_sfs = function(null, msprime, dadi, lynch) {
if (length(msprime) > 30) {
x_axis = 1:30
null = proportional_sfs(null)[1:30]
msprime = proportional_sfs(msprime)[1:30]
dadi = proportional_sfs(dadi)[1:30]
lynch = proportional_sfs(lynch)[1:30]
} else {
x_axis = 1:length(msprime)
null = proportional_sfs(null)
msprime = proportional_sfs(msprime)
dadi = proportional_sfs(dadi)
lynch = proportional_sfs(lynch)
}
input_df = data.frame(null,
msprime,
dadi,
lynch,
x_axis)
names(input_df) = c('SNM',
'MSPrime',
'Dadi projection',
'Lynch Theoretical',
'x_axis')
p_input_comparison <- ggplot(data = melt(input_df, id='x_axis'),
aes(x=x_axis,
y=value,
fill=variable)) +
geom_bar(position='dodge2', stat='identity') +
labs(x = "", fill = "") +
scale_x_continuous(name='Minor allele frequency in sample', breaks=x_axis, limits=c(0.5, length(x_axis) + 0.5)) +
ylab('Proportion of segregating sites') +
theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
## scale_fill_manual(values=c("darkslateblue", "darkslategrey", "darkturquoise"))
return(p_input_comparison)
}
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_10_SFS, TwoEpochC_10_msprime_SFS,
TwoEpochC_10_dadi_projection_SFS, TwoEpochC_10_lynch_SFS) +
ggtitle('Two Epoch Contraction, k=10') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_10_SFS, TwoEpochE_10_msprime_SFS,
TwoEpochE_10_dadi_projection_SFS, TwoEpochE_10_lynch_SFS) +
ggtitle('Two Epoch Expansion, k=10') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_10_SFS, ThreeEpochC_10_msprime_SFS,
ThreeEpochC_10_dadi_projection_SFS, ThreeEpochC_10_lynch_SFS) +
ggtitle('Three Epoch Contraction, k=10') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_10_SFS, ThreeEpochE_10_msprime_SFS,
ThreeEpochE_10_dadi_projection_SFS, ThreeEpochE_10_lynch_SFS) +
ggtitle('Three Epoch Expansion, k=10') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_10_SFS, ThreeEpochB_10_msprime_SFS,
ThreeEpochB_10_dadi_projection_SFS, ThreeEpochB_10_lynch_SFS) +
ggtitle('Three Epoch Bottleneck, k=10') +
plot_layout(nrow=3)
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_20_SFS, TwoEpochC_20_msprime_SFS,
TwoEpochC_20_dadi_projection_SFS, TwoEpochC_20_lynch_SFS) +
ggtitle('Two Epoch Contraction, k=20') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_20_SFS, TwoEpochE_20_msprime_SFS,
TwoEpochE_20_dadi_projection_SFS, TwoEpochE_20_lynch_SFS) +
ggtitle('Two Epoch Expansion, k=20') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_20_SFS, ThreeEpochC_20_msprime_SFS,
ThreeEpochC_20_dadi_projection_SFS, ThreeEpochC_20_lynch_SFS) +
ggtitle('Three Epoch Contraction, k=20') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_20_SFS, ThreeEpochE_20_msprime_SFS,
ThreeEpochE_20_dadi_projection_SFS, ThreeEpochE_20_lynch_SFS) +
ggtitle('Three Epoch Expansion, k=20') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_20_SFS, ThreeEpochB_20_msprime_SFS,
ThreeEpochB_20_dadi_projection_SFS, ThreeEpochB_20_lynch_SFS) +
ggtitle('Three Epoch Bottleneck, k=20') +
plot_layout(nrow=3)
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_30_SFS, TwoEpochC_30_msprime_SFS,
TwoEpochC_30_dadi_projection_SFS, TwoEpochC_30_lynch_SFS) +
ggtitle('Two Epoch Contraction, k=30') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_30_SFS, TwoEpochE_30_msprime_SFS,
TwoEpochE_30_dadi_projection_SFS, TwoEpochE_30_lynch_SFS) +
ggtitle('Two Epoch Expansion, k=30') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_30_SFS, ThreeEpochC_30_msprime_SFS,
ThreeEpochC_30_dadi_projection_SFS, ThreeEpochC_30_lynch_SFS) +
ggtitle('Three Epoch Contraction, k=30') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_30_SFS, ThreeEpochE_30_msprime_SFS,
ThreeEpochE_30_dadi_projection_SFS, ThreeEpochE_30_lynch_SFS) +
ggtitle('Three Epoch Expansion, k=30') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_30_SFS, ThreeEpochB_30_msprime_SFS,
ThreeEpochB_30_dadi_projection_SFS, ThreeEpochB_30_lynch_SFS) +
ggtitle('Three Epoch Bottleneck, k=30') +
plot_layout(nrow=3)
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_40_SFS, TwoEpochC_40_msprime_SFS,
TwoEpochC_40_dadi_projection_SFS, TwoEpochC_40_lynch_SFS) +
ggtitle('Two Epoch Contraction, k=40') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_40_SFS, TwoEpochE_40_msprime_SFS,
TwoEpochE_40_dadi_projection_SFS, TwoEpochE_40_lynch_SFS) +
ggtitle('Two Epoch Expansion, k=40') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_40_SFS, ThreeEpochC_40_msprime_SFS,
ThreeEpochC_40_dadi_projection_SFS, ThreeEpochC_40_lynch_SFS) +
ggtitle('Three Epoch Contraction, k=40') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_40_SFS, ThreeEpochE_40_msprime_SFS,
ThreeEpochE_40_dadi_projection_SFS, ThreeEpochE_40_lynch_SFS) +
ggtitle('Three Epoch Expansion, k=40') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_40_SFS, ThreeEpochB_40_msprime_SFS,
ThreeEpochB_40_dadi_projection_SFS, ThreeEpochB_40_lynch_SFS) +
ggtitle('Three Epoch Bottleneck, k=40') +
plot_layout(nrow=3)
TwoEpochC_40_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpC_41_expected_sfs.txt')
TwoEpochE_40_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpE_41_expected_sfs.txt')
ThreeEpochC_40_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpC_41_expected_sfs.txt')
ThreeEpochE_40_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpE_41_expected_sfs.txt')
ThreeEpochB_40_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpB_41_expected_sfs.txt')
TwoEpochC_50_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpC_51_expected_sfs.txt')
TwoEpochE_50_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpE_51_expected_sfs.txt')
ThreeEpochC_50_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpC_51_expected_sfs.txt')
ThreeEpochE_50_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpE_51_expected_sfs.txt')
ThreeEpochB_50_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpB_51_expected_sfs.txt')
TwoEpochC_60_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpC_61_expected_sfs.txt')
TwoEpochE_60_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpE_61_expected_sfs.txt')
ThreeEpochC_60_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpC_61_expected_sfs.txt')
ThreeEpochE_60_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpE_61_expected_sfs.txt')
ThreeEpochB_60_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpB_61_expected_sfs.txt')
TwoEpochC_70_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpC_71_expected_sfs.txt')
TwoEpochE_70_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpE_71_expected_sfs.txt')
ThreeEpochC_70_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpC_71_expected_sfs.txt')
ThreeEpochE_70_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpE_71_expected_sfs.txt')
ThreeEpochB_70_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpB_71_expected_sfs.txt')
TwoEpochC_80_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpC_81_expected_sfs.txt')
TwoEpochE_80_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpE_81_expected_sfs.txt')
ThreeEpochC_80_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpC_81_expected_sfs.txt')
ThreeEpochE_80_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpE_81_expected_sfs.txt')
ThreeEpochB_80_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpB_81_expected_sfs.txt')
TwoEpochC_90_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpC_91_expected_sfs.txt')
TwoEpochE_90_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpE_91_expected_sfs.txt')
ThreeEpochC_90_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpC_91_expected_sfs.txt')
ThreeEpochE_90_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpE_91_expected_sfs.txt')
ThreeEpochB_90_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpB_91_expected_sfs.txt')
TwoEpochC_100_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpC_101_expected_sfs.txt')
TwoEpochE_100_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/2EpE_101_expected_sfs.txt')
ThreeEpochC_100_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpC_101_expected_sfs.txt')
ThreeEpochE_100_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpE_101_expected_sfs.txt')
ThreeEpochB_100_lynch_SFS = read_input_sfs('../Analysis/optimal_sample_size_test/3EpB_101_expected_sfs.txt')
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_40_SFS, TwoEpochC_40_msprime_SFS,
TwoEpochC_40_dadi_projection_SFS, TwoEpochC_40_lynch_SFS) +
ggtitle('Two Epoch Contraction, k=40') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_40_SFS, TwoEpochE_40_msprime_SFS,
TwoEpochE_40_dadi_projection_SFS, TwoEpochE_40_lynch_SFS) +
ggtitle('Two Epoch Expansion, k=40') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_40_SFS, ThreeEpochC_40_msprime_SFS,
ThreeEpochC_40_dadi_projection_SFS, ThreeEpochC_40_lynch_SFS) +
ggtitle('Three Epoch Contraction, k=40') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_40_SFS, ThreeEpochE_40_msprime_SFS,
ThreeEpochE_40_dadi_projection_SFS, ThreeEpochE_40_lynch_SFS) +
ggtitle('Three Epoch Expansion, k=40') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_40_SFS, ThreeEpochB_40_msprime_SFS,
ThreeEpochB_40_dadi_projection_SFS, ThreeEpochB_40_lynch_SFS) +
ggtitle('Three Epoch Bottleneck, k=40') +
plot_layout(nrow=3)
compare_msprime_dadi_lynch_proportional_sfs = function(null, msprime, dadi, lynch) {
if (length(msprime) > 20) {
x_axis = 1:20
null = proportional_sfs(null)[1:20]
msprime = proportional_sfs(msprime)[1:20]
dadi = proportional_sfs(dadi)[1:20]
lynch = proportional_sfs(lynch)[1:20]
} else {
x_axis = 1:length(msprime)
null = proportional_sfs(null)
msprime = proportional_sfs(msprime)
dadi = proportional_sfs(dadi)
lynch = proportional_sfs(lynch)
}
input_df = data.frame(null,
msprime,
dadi,
lynch,
x_axis)
names(input_df) = c('SNM',
'MSPrime',
'Dadi projection',
'Lynch Theoretical',
'x_axis')
p_input_comparison <- ggplot(data = melt(input_df, id='x_axis'),
aes(x=x_axis,
y=value,
fill=variable)) +
geom_bar(position='dodge2', stat='identity') +
labs(x = "", fill = "") +
scale_x_continuous(name='Minor allele frequency in sample', breaks=x_axis, limits=c(0.5, length(x_axis) + 0.5)) +
ylab('Proportion of segregating sites') +
theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
## scale_fill_manual(values=c("darkslateblue", "darkslategrey", "darkturquoise"))
return(p_input_comparison)
}
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_40_SFS, TwoEpochC_40_msprime_SFS,
TwoEpochC_40_dadi_projection_SFS, TwoEpochC_40_lynch_SFS) +
ggtitle('Two Epoch Contraction, k=40') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_40_SFS, TwoEpochE_40_msprime_SFS,
TwoEpochE_40_dadi_projection_SFS, TwoEpochE_40_lynch_SFS) +
ggtitle('Two Epoch Expansion, k=40') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_40_SFS, ThreeEpochC_40_msprime_SFS,
ThreeEpochC_40_dadi_projection_SFS, ThreeEpochC_40_lynch_SFS) +
ggtitle('Three Epoch Contraction, k=40') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_40_SFS, ThreeEpochE_40_msprime_SFS,
ThreeEpochE_40_dadi_projection_SFS, ThreeEpochE_40_lynch_SFS) +
ggtitle('Three Epoch Expansion, k=40') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_40_SFS, ThreeEpochB_40_msprime_SFS,
ThreeEpochB_40_dadi_projection_SFS, ThreeEpochB_40_lynch_SFS) +
ggtitle('Three Epoch Bottleneck, k=40') +
plot_layout(nrow=3)
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_50_SFS, TwoEpochC_50_msprime_SFS,
TwoEpochC_50_dadi_projection_SFS, TwoEpochC_50_lynch_SFS) +
ggtitle('Two Epoch Contraction, k=50') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_50_SFS, TwoEpochE_50_msprime_SFS,
TwoEpochE_50_dadi_projection_SFS, TwoEpochE_50_lynch_SFS) +
ggtitle('Two Epoch Expansion, k=50') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_50_SFS, ThreeEpochC_50_msprime_SFS,
ThreeEpochC_50_dadi_projection_SFS, ThreeEpochC_50_lynch_SFS) +
ggtitle('Three Epoch Contraction, k=50') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_50_SFS, ThreeEpochE_50_msprime_SFS,
ThreeEpochE_50_dadi_projection_SFS, ThreeEpochE_50_lynch_SFS) +
ggtitle('Three Epoch Expansion, k=50') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_50_SFS, ThreeEpochB_50_msprime_SFS,
ThreeEpochB_50_dadi_projection_SFS, ThreeEpochB_50_lynch_SFS) +
ggtitle('Three Epoch Bottleneck, k=50') +
plot_layout(nrow=3)
compare_msprime_dadi_lynch_proportional_sfs = function(null, msprime, dadi, lynch) {
if (length(msprime) > 10) {
x_axis = 1:10
null = proportional_sfs(null)[1:10]
msprime = proportional_sfs(msprime)[1:10]
dadi = proportional_sfs(dadi)[1:10]
lynch = proportional_sfs(lynch)[1:10]
} else {
x_axis = 1:length(msprime)
null = proportional_sfs(null)
msprime = proportional_sfs(msprime)
dadi = proportional_sfs(dadi)
lynch = proportional_sfs(lynch)
}
input_df = data.frame(null,
msprime,
dadi,
lynch,
x_axis)
names(input_df) = c('SNM',
'MSPrime',
'Dadi projection',
'Lynch Theoretical',
'x_axis')
p_input_comparison <- ggplot(data = melt(input_df, id='x_axis'),
aes(x=x_axis,
y=value,
fill=variable)) +
geom_bar(position='dodge2', stat='identity') +
labs(x = "", fill = "") +
scale_x_continuous(name='Minor allele frequency in sample', breaks=x_axis, limits=c(0.5, length(x_axis) + 0.5)) +
ylab('Proportion of segregating sites') +
theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
## scale_fill_manual(values=c("darkslateblue", "darkslategrey", "darkturquoise"))
return(p_input_comparison)
}
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_40_SFS, TwoEpochC_40_msprime_SFS,
TwoEpochC_40_dadi_projection_SFS, TwoEpochC_40_lynch_SFS) +
ggtitle('Two Epoch Contraction, k=40') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_40_SFS, TwoEpochE_40_msprime_SFS,
TwoEpochE_40_dadi_projection_SFS, TwoEpochE_40_lynch_SFS) +
ggtitle('Two Epoch Expansion, k=40') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_40_SFS, ThreeEpochC_40_msprime_SFS,
ThreeEpochC_40_dadi_projection_SFS, ThreeEpochC_40_lynch_SFS) +
ggtitle('Three Epoch Contraction, k=40') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_40_SFS, ThreeEpochE_40_msprime_SFS,
ThreeEpochE_40_dadi_projection_SFS, ThreeEpochE_40_lynch_SFS) +
ggtitle('Three Epoch Expansion, k=40') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_40_SFS, ThreeEpochB_40_msprime_SFS,
ThreeEpochB_40_dadi_projection_SFS, ThreeEpochB_40_lynch_SFS) +
ggtitle('Three Epoch Bottleneck, k=40') +
plot_layout(nrow=3)
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_50_SFS, TwoEpochC_50_msprime_SFS,
TwoEpochC_50_dadi_projection_SFS, TwoEpochC_50_lynch_SFS) +
ggtitle('Two Epoch Contraction, k=50') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_50_SFS, TwoEpochE_50_msprime_SFS,
TwoEpochE_50_dadi_projection_SFS, TwoEpochE_50_lynch_SFS) +
ggtitle('Two Epoch Expansion, k=50') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_50_SFS, ThreeEpochC_50_msprime_SFS,
ThreeEpochC_50_dadi_projection_SFS, ThreeEpochC_50_lynch_SFS) +
ggtitle('Three Epoch Contraction, k=50') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_50_SFS, ThreeEpochE_50_msprime_SFS,
ThreeEpochE_50_dadi_projection_SFS, ThreeEpochE_50_lynch_SFS) +
ggtitle('Three Epoch Expansion, k=50') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_50_SFS, ThreeEpochB_50_msprime_SFS,
ThreeEpochB_50_dadi_projection_SFS, ThreeEpochB_50_lynch_SFS) +
ggtitle('Three Epoch Bottleneck, k=50') +
plot_layout(nrow=3)
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_60_SFS, TwoEpochC_60_msprime_SFS,
TwoEpochC_60_dadi_projection_SFS, TwoEpochC_60_lynch_SFS) +
ggtitle('Two Epoch Contraction, k=60') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_60_SFS, TwoEpochE_60_msprime_SFS,
TwoEpochE_60_dadi_projection_SFS, TwoEpochE_60_lynch_SFS) +
ggtitle('Two Epoch Expansion, k=60') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_60_SFS, ThreeEpochC_60_msprime_SFS,
ThreeEpochC_60_dadi_projection_SFS, ThreeEpochC_60_lynch_SFS) +
ggtitle('Three Epoch Contraction, k=60') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_60_SFS, ThreeEpochE_60_msprime_SFS,
ThreeEpochE_60_dadi_projection_SFS, ThreeEpochE_60_lynch_SFS) +
ggtitle('Three Epoch Expansion, k=60') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_60_SFS, ThreeEpochB_60_msprime_SFS,
ThreeEpochB_60_dadi_projection_SFS, ThreeEpochB_60_lynch_SFS) +
ggtitle('Three Epoch Bottleneck, k=60') +
plot_layout(nrow=3)
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_70_SFS, TwoEpochC_70_msprime_SFS,
TwoEpochC_70_dadi_projection_SFS, TwoEpochC_70_lynch_SFS) +
ggtitle('Two Epoch Contraction, k=70') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_70_SFS, TwoEpochE_70_msprime_SFS,
TwoEpochE_70_dadi_projection_SFS, TwoEpochE_70_lynch_SFS) +
ggtitle('Two Epoch Expansion, k=70') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_70_SFS, ThreeEpochC_70_msprime_SFS,
ThreeEpochC_70_dadi_projection_SFS, ThreeEpochC_70_lynch_SFS) +
ggtitle('Three Epoch Contraction, k=70') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_70_SFS, ThreeEpochE_70_msprime_SFS,
ThreeEpochE_70_dadi_projection_SFS, ThreeEpochE_70_lynch_SFS) +
ggtitle('Three Epoch Expansion, k=70') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_70_SFS, ThreeEpochB_70_msprime_SFS,
ThreeEpochB_70_dadi_projection_SFS, ThreeEpochB_70_lynch_SFS) +
ggtitle('Three Epoch Bottleneck, k=70') +
plot_layout(nrow=3)
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_80_SFS, TwoEpochC_80_msprime_SFS,
TwoEpochC_80_dadi_projection_SFS, TwoEpochC_80_lynch_SFS) +
ggtitle('Two Epoch Contraction, k=80') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_80_SFS, TwoEpochE_80_msprime_SFS,
TwoEpochE_80_dadi_projection_SFS, TwoEpochE_80_lynch_SFS) +
ggtitle('Two Epoch Expansion, k=80') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_80_SFS, ThreeEpochC_80_msprime_SFS,
ThreeEpochC_80_dadi_projection_SFS, ThreeEpochC_80_lynch_SFS) +
ggtitle('Three Epoch Contraction, k=80') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_80_SFS, ThreeEpochE_80_msprime_SFS,
ThreeEpochE_80_dadi_projection_SFS, ThreeEpochE_80_lynch_SFS) +
ggtitle('Three Epoch Expansion, k=80') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_80_SFS, ThreeEpochB_80_msprime_SFS,
ThreeEpochB_80_dadi_projection_SFS, ThreeEpochB_80_lynch_SFS) +
ggtitle('Three Epoch Bottleneck, k=80') +
plot_layout(nrow=3)
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_90_SFS, TwoEpochC_90_msprime_SFS,
TwoEpochC_90_dadi_projection_SFS, TwoEpochC_90_lynch_SFS) +
ggtitle('Two Epoch Contraction, k=90') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_90_SFS, TwoEpochE_90_msprime_SFS,
TwoEpochE_90_dadi_projection_SFS, TwoEpochE_90_lynch_SFS) +
ggtitle('Two Epoch Expansion, k=90') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_90_SFS, ThreeEpochC_90_msprime_SFS,
ThreeEpochC_90_dadi_projection_SFS, ThreeEpochC_90_lynch_SFS) +
ggtitle('Three Epoch Contraction, k=90') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_90_SFS, ThreeEpochE_90_msprime_SFS,
ThreeEpochE_90_dadi_projection_SFS, ThreeEpochE_90_lynch_SFS) +
ggtitle('Three Epoch Expansion, k=90') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_90_SFS, ThreeEpochB_90_msprime_SFS,
ThreeEpochB_90_dadi_projection_SFS, ThreeEpochB_90_lynch_SFS) +
ggtitle('Three Epoch Bottleneck, k=90') +
plot_layout(nrow=3)
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_100_SFS, TwoEpochC_100_msprime_SFS,
TwoEpochC_100_dadi_projection_SFS, TwoEpochC_100_lynch_SFS) +
ggtitle('Two Epoch Contraction, k=100') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_100_SFS, TwoEpochE_100_msprime_SFS,
TwoEpochE_100_dadi_projection_SFS, TwoEpochE_100_lynch_SFS) +
ggtitle('Two Epoch Expansion, k=100') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_100_SFS, ThreeEpochC_100_msprime_SFS,
ThreeEpochC_100_dadi_projection_SFS, ThreeEpochC_100_lynch_SFS) +
ggtitle('Three Epoch Contraction, k=100') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_100_SFS, ThreeEpochE_100_msprime_SFS,
ThreeEpochE_100_dadi_projection_SFS, ThreeEpochE_100_lynch_SFS) +
ggtitle('Three Epoch Expansion, k=100') +
compare_msprime_dadi_lynch_proportional_sfs(one_epoch_100_SFS, ThreeEpochB_100_msprime_SFS,
ThreeEpochB_100_dadi_projection_SFS, ThreeEpochB_100_lynch_SFS) +
ggtitle('Three Epoch Bottleneck, k=100') +
plot_layout(nrow=3)
